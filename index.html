<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Open Case Studies: Mental Health of American Youth</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Open Case Studies: Mental Health of American Youth</h1>

</div>


<style>
#TOC {
  background: url("https://opencasestudies.github.io/img/logo.jpg");
  background-size: contain;
  padding-top: 240px !important;
  background-repeat: no-repeat;
}
</style>
<div id="section" class="section level4 outline">
<h4></h4>
<p><img src="img/mainplot.png" width="800 px" style="display: block; margin: auto;" /></p>
</div>
<div id="section-1" class="section level4">
<h4></h4>
</div>
<div id="section-2" class="section level2 disclaimer_block">
<h2></h2>
<p><strong>Disclaimer</strong>: The purpose of the <a href="https://opencasestudies.github.io" target="_blank">Open Case Studies</a> project is <strong>to demonstrate the use of various data science methods, tools, and software in the context of messy, real-world data</strong>. A given case study does not cover all aspects of the research process, is not claiming to be the most appropriate way to analyze a given data set, and should not be used in the context of making policy decisions without external consultation from scientific experts.</p>
</div>
<div id="section-3" class="section level2 license_block">
<h2></h2>
<p>This work is licensed under the Creative Commons Attribution-NonCommercial 3.0 <a href="https://creativecommons.org/licenses/by-nc/3.0/us/" target="_blank">(CC BY-NC 3.0)</a> United States License.</p>
</div>
<div id="section-4" class="section level2 reference_block">
<h2></h2>
<p>To cite this case study please use:</p>
<p>Wright, Carrie, and Ontiveros, Michael and Jager, Leah and Taub, Margaret and Hicks, Stephanie. (2020). <a href="https://github.com/opencasestudies/ocs-youth-mental-health-case-study" class="uri">https://github.com/opencasestudies/ocs-youth-mental-health-case-study</a>. Mental Health of American Youth (Version v1.0.0).</p>
</div>
<div id="motivation" class="section level2">
<h2><strong>Motivation</strong></h2>
<hr />
<p>Rates of depression appear to have been increasing among American youths since around 2010 according to a recent <a href="https://content.apa.org/record/2019-12578-001" target="_blank">report</a>. A <a href="https://pubmed.ncbi.nlm.nih.gov/24285382/" target="_blank">recent study</a> also shows that youths appear to be seeking more care from mental health services.</p>
<p>This case study will explore how rates of major depressive episodes have changed since the early 2000s and across different youth subgroups (age, gender, ethnicity). We also will explore how rates of treatment for depression of youths have changed over time.</p>
<p><img src="img/k-mitch-hodge-IqSaG9zv2e0-unsplash.jpg" width="40%" style="display: block; margin: auto;" /> <span>Photo by <a href="https://unsplash.com/@kmitchhodge?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">K. Mitch Hodge</a> on <a href="https://unsplash.com/s/photos/depression?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></span></p>
<p>The major symptoms of a major depressive episode include:</p>
<p><strong>S</strong>leep disorder (increased or decreased)<br />
<strong>I</strong>nterest deficit (anhedonia)<br />
<strong>G</strong>uilt (worthlessness, hopelessness, regret)<br />
<strong>E</strong>nergy deficit<br />
<strong>C</strong>oncentration deficit<br />
<strong>A</strong>ppetite disorder (increased or decreased)<br />
<strong>P</strong>sychomotor retardation or agitation<br />
<strong>S</strong>uicidality</p>
<div id="source" class="section level5">
<h5><a href="https://www.icsi.org/guideline/depression/diagnose-and-characterize-major-depression-persistent-depressive-disorder-with-clinical-interview/" target="_blank">[source]</a></h5>
<p><img src="img/depression-symptoms-and-treatment-768x768.jpg" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="source-1" class="section level5">
<h5><a href="https://newmilfordcounselingcenter.com/depression-2/" target="_blank">[source]</a></h5>
<hr />
<details>
<p><summary> Click here to see the diagnostic requirements for a major depressive episode (MSE) according to the <a href="https://en.wikipedia.org/wiki/DSM-5" target="_blank">DSM 5</a>.</summary></p>
<p>A. Five or more of the following symptoms have been present and documented during the same two-week period and represent a change from previous functioning; at least one of the symptoms is either (1) depressed mood or (2) loss of interest or pleasure.</p>
<p><strong>Note</strong>: Do not include symptoms that are clearly attributable to another medical condition.</p>
<ol style="list-style-type: decimal">
<li><p>Depressed mood most of the day, nearly every day, as indicated by either subjective report (e.g., feels sad, empty, hopeless) or observation made by others (e.g., appears tearful)</p></li>
<li><p>Markedly diminished interest or pleasure in all, or almost all, activities most of the day, nearly every day (as indicated by either subjective account or observation)</p></li>
<li><p>Significant weight loss when not dieting or weight gain (e.g., a change of more than 5% of body weight in a month), or decrease or increase in appetite nearly every day</p></li>
<li><p>Insomnia or hypersomnia nearly every day</p></li>
<li><p>Psychomotor agitation or retardation nearly every day (observable by others, not merely subjective feelings of restlessness or being slowed down)</p></li>
<li><p>Fatigue or loss of energy nearly every day</p></li>
<li><p>Feelings of worthlessness or excessive or inappropriate guilt (which may be delusional) nearly every day (not merely self-reproach or guilt about being sick)</p></li>
<li><p>Diminished ability to think or concentrate, or indecisiveness, nearly every day (either by subjective account or as observed by others)</p></li>
<li><p>Recurrent thoughts of death (not just fear of dying), recurrent suicidal ideation without a specific plan, or a suicide attempt or a specific plan for committing suicide</p></li>
</ol>
<p>B. The symptoms do not meet criteria for a mixed episode.</p>
<p>C. The episode is not attributable to the physiological effects of a substance or to another medical condition.</p>
<p><strong>Note</strong>: Criteria A-C represent a major depressive episode.</p>
<p><strong>Note</strong>: Responses to a significant loss (e.g., bereavement, financial ruin, losses from a natural disaster, a serious medical illness or disability) may include feelings of intense sadness, rumination about the loss, insomnia, poor appetite and weight loss noted in Criterion A, which may resemble a depressive episode. Although such symptoms may be understandable or considered appropriate to the loss, the presence of a major depressive episode in addition to the normal response to a significant loss should also be carefully considered. This decision inevitably requires the exercise of clinical judgment based on the individual’s history of and the cultural norms for the expression of distress in the context of loss.</p>
<p>D. The occurrence of the major depressive episode is not better explained by schizoaffective disorder, schizophrenia, schizophreniform disorder, delusional disorder, or other specified and unspecified schizophrenia spectrum and other psychotic disorders.</p>
<p>E. There has never been a manic episode or a hypomanic episode.</p>
<p>Note: This exclusion does not apply if all of the manic-like or hypomanic-like episodes are substance-induced or are attributable to the physiological effects of another medical condition.</p>
</div>
<div id="source-2" class="section level4">
<h4><a href="https://www.icsi.org/guideline/depression/diagnose-and-characterize-major-depression-persistent-depressive-disorder-with-clinical-interview/" target="_blank">[source]</a></h4>
</details>
<hr />
<p>This case study is motivated by the following two articles:</p>
</div>
<div id="section-5" class="section level4 reference_block">
<h4></h4>
<p>Twenge JM, Cooper AB, Joiner TE, Duffy ME, Binau SG. Age, period, and cohort trends in mood disorder indicators and suicide-related outcomes in a nationally representative dataset, 2005-2017. <em>J Abnorm Psychol</em>.128,3 (2019):185-199. <a href="doi:10.1037/abn0000410" class="uri">doi:10.1037/abn0000410</a></p>
<p>Olfson, M., Blanco, C., Wang, S., Laje, G. &amp; Correll, C. U. National Trends in the Mental Health Care of Children, Adolescents, and Adults by Office-Based Physicians. <em>JAMA Psychiatry</em>. 71, 81 (2014):81-90. doi: 10.1001/jamapsychiatry.2013.3074.</p>
</div>
<div id="section-6" class="section level4">
<h4></h4>
<p>The main findings of the first <a href="https://content.apa.org/record/2019-12578-001" target="_blank">article</a> are:</p>
<blockquote>
<p>Rates of major depressive episode in the last year increased 52% 2005–2017 (from 8.7% to 13.2%) among adolescents aged 12 to 17 and 63% 2009–2017 (from 8.1% to 13.2%) among young adults 18–25.</p>
</blockquote>
<blockquote>
<p>Serious psychological distress in the last month and suicide-related outcomes (suicidal ideation, plans, attempts, and deaths by suicide) in the last year also increased among young adults 18–25 from 2008–2017 (with a 71% increase in serious psychological distress), with less consistent and weaker increases among adults ages 26 and over.</p>
</blockquote>
<blockquote>
<p>Cultural trends contributing to an increase in mood disorders and suicidal thoughts and behaviors since the mid-2000s, including the rise of electronic communication and digital media and declines in sleep duration, may have had a larger impact on younger people, creating a cohort effect.</p>
</blockquote>
<p>While the main findings of the second <a href="https://pubmed.ncbi.nlm.nih.gov/24285382/" target="_blank">article</a> are:</p>
<blockquote>
<p>Compared with adult mental health care, the mental health care of young people has increased more rapidly.</p>
</blockquote>
<blockquote>
<p>Between 1995-1998 and 2007-2010, visits resulting in mental disorder diagnoses per 100 population increased significantly faster for youths (from 7.78 to 15.30 visits) than for adults (from 23.23 to 28.48 visits) (interaction: P &lt; .001).</p>
</blockquote>
<blockquote>
<p>Psychiatrist visits also increased significantly faster for youths (from 2.86 to 5.71 visits).</p>
</blockquote>
<p><strong>Summary</strong>: While depression appear to be on the rise for youths, youths also appear to be seeking more mental health care.</p>
<p>In this case study, we will be using data from the <a href="https://nsduhweb.rti.org/respweb/homepage.cfm" target="_blank">National Survey on Drug Use and Health (NSDUH)</a> related to treatment and major depressive episode (MDE) rate to explore how this have changed over time and how different groups compare. This data was also used in the first referenced article.</p>
</div>
</div>
<div id="main-questions" class="section level2">
<h2><strong>Main Questions</strong></h2>
<hr />
<div id="section-7" class="section level4 main_question_block">
<h4></h4>
<p><b><u> Our main questions: </u></b></p>
<ol style="list-style-type: decimal">
<li>How have depression rates in American youth changed since 2004, according to the NSDUH data? How have rates differed between different youth subgroups (age, gender, ethnicity)?</li>
<li>Do mental health services appear to be reaching more youths? Again, how have rates differed between different youth subgroups (age, gender, ethnicity)?</li>
</ol>
</div>
<div id="section-8" class="section level4">
<h4></h4>
</div>
</div>
<div id="learning-objectives" class="section level2">
<h2><strong>Learning Objectives</strong></h2>
<hr />
<p>The skills, methods, and concepts that students will be familiar with by the end of this case study are:</p>
<p><u><strong>Statistical Learning Objectives:</strong></u></p>
<ol style="list-style-type: decimal">
<li>Discuss the impact and of self-reporting bias on survey responses.</li>
<li>Define and create a contingency table.</li>
<li>Implementation of a chi-squared test for independence.</li>
<li>Interpretation of a chi-squared test for independence.</li>
</ol>
<p><u><strong>Data science Learning Objectives:</strong></u></p>
<ol style="list-style-type: decimal">
<li>Scrape data directly from a website (<code>rvest</code>).</li>
<li>Subset and filter data (<code>dplyr</code>).</li>
<li>Write functions to wrangle data repetitively.</li>
<li>Work with character strings (<code>stringr</code>).</li>
<li>Reshape data into different formats (<code>tidyr</code>).</li>
<li>Data visualizations (<code>ggplot2</code>) with labels (<code>directlabels</code>) and facets for different groups.</li>
<li>Combine multiple plots (<code>cowplot</code>).</li>
<li>Optional: Create an animated gif (<code>magick</code>).</li>
</ol>
<p>In this case study, we will especially focus on using packages and functions from the <a href="https://www.tidyverse.org/" target="_blank"><code>Tidyverse</code></a>, such as <a href="https://github.com/tidyverse/rvest" target="_blank"><code>rvest</code></a>. The tidyverse is a library of packages created by RStudio. While some students may be familiar with previous R programming packages, these packages make data science in R more legible and intuitive.</p>
<p><img src="https://tidyverse.tidyverse.org/logo.png" width="20%" style="display: block; margin: auto;" /></p>
<hr />
<p>We will begin by loading the packages that we will need:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(here)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(rvest)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">library</span>(tibble)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="kw">library</span>(directlabels)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="kw">library</span>(forcats)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="kw">library</span>(cowplot)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th>Package</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://github.com/jennybc/here_here" target="_blank">here</a></td>
<td>to easily load and save data</td>
</tr>
<tr class="even">
<td><a href="https://github.com/tidyverse/rvest" target="_blank">rvest</a></td>
<td>to scrape web pages</td>
</tr>
<tr class="odd">
<td><a href="https://dplyr.tidyverse.org/" target="_blank">dplyr</a></td>
<td>to scrape web pages</td>
</tr>
<tr class="even">
<td><a href="https://magrittr.tidyverse.org/" target="_blank">magrittr</a></td>
<td>to scrape web pages</td>
</tr>
<tr class="odd">
<td><a href="https://stringr.tidyverse.org/" target="_blank">stringr</a></td>
<td>to manipulate strings</td>
</tr>
<tr class="even">
<td><a href="https://tidyr.tidyverse.org/" target="_blank">tidyr</a></td>
<td>to change the shape or format of tibbles to wide and long</td>
</tr>
<tr class="odd">
<td><a href="https://tibble.tidyverse.org/" target="_blank">tibble</a></td>
<td>to create tibbles and convert values of a column to row names</td>
</tr>
<tr class="even">
<td><a href="https://ggplot2.tidyverse.org/" target="_blank">ggplot2</a></td>
<td>to create plots</td>
</tr>
<tr class="odd">
<td><a href="http://directlabels.r-forge.r-project.org/docs/index.html" target="_blank">directlabels</a></td>
<td>to add labels directly to lines in plots</td>
</tr>
<tr class="even">
<td><a href="https://forcats.tidyverse.org/" target="_blank">forcats</a></td>
<td>to reorder factor for plot</td>
</tr>
<tr class="odd">
<td><a href="https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html" target="_blank">cowplot</a></td>
<td>to combine plots together</td>
</tr>
</tbody>
</table>
<p>The first time we use a function, we will use the <code>::</code> to indicate which package we are using. Unless we have overlapping function names, this is not necessary, but we will include it here to be informative about where the functions we will use come from.</p>
</div>
<div id="context" class="section level2">
<h2><strong>Context</strong></h2>
<hr />
<p>To motivate the examination of the mental health of American youths, we begin by exploring the rate of suicide in the United States (US). According to the CDC the rate of suicide has increased for both genders.</p>
<p><img src="https://www.cdc.gov/nchs/images/databriefs/301-350/db309_fig1.png" width="80%" style="display: block; margin: auto;" /></p>
<div id="source-3" class="section level5">
<h5><a href="https://www.cdc.gov/nchs/products/databriefs/db309.htm" target="_blank">[source]</a></h5>
<p>While suicide does appear to be increasing among youths it also appears to be increasing among most age groups in the US over the past decade and a half for both females:</p>
<p><img src="https://www.cdc.gov/nchs/images/databriefs/301-350/db309_fig2.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="source-4" class="section level5">
<h5><a href="https://www.cdc.gov/nchs/products/databriefs/db309.htm" target="_blank">[source]</a></h5>
<p>and males:</p>
<p><img src="https://www.cdc.gov/nchs/images/databriefs/301-350/db309_fig3.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="source-5" class="section level5">
<h5><a href="https://www.cdc.gov/nchs/products/databriefs/db309.htm" target="_blank">[source]</a></h5>
<p>According to the <a href="https://www.cdc.gov/nchs/products/databriefs/db309.htm" target="_blank">CDC</a>:</p>
<blockquote>
<p>Since 2008, suicide has ranked as the 10th leading cause of death for <strong>all ages</strong> in the United States.</p>
</blockquote>
<p><img src="img/mortality.png" width="800px" style="display: block; margin: auto;" /></p>
</div>
<div id="source-6" class="section level5">
<h5><a href="https://www.cdc.gov/nchs/data/databriefs/db293.pdf" target="_blank">[source]</a></h5>
<p>Furthermore, according to the <a href="https://www.cdc.gov/nchs/products/databriefs/db309.htm" target="_blank">CDC</a>:</p>
<blockquote>
<p>In 2016, suicide became the <strong>second leading cause of death</strong> among [youths].</p>
</blockquote>
<p><strong>So although suicide is on the rise for most age groups, suicide is one of the top <em>two</em> contributors to death for youths.</strong></p>
<p>Thus, this warrants further examination of the mental health of American youths.</p>
<p><img src="img/mortality_age.png" width="800px" style="display: block; margin: auto;" /></p>
</div>
<div id="source-7" class="section level5">
<h5><a href="https://www.cdc.gov/nchs/data/nvsr/nvsr68/nvsr68_06-508.pdf" target="_blank">[source]</a></h5>
<p>Historically, suicide rates were much higher before 1950, however, we are seeing an increase in the last 20 years.</p>
<p><img src="img/suicide.png" width="800px" style="display: block; margin: auto;" /></p>
</div>
<div id="source-8" class="section level5">
<h5><a href="https://time.com/5609124/us-suicide-rate-increase/" target="_blank">[source]</a></h5>
<p>Besides the US, <a href="https://academic.oup.com/ije/article/48/5/1650/5366210" target="_blank">other countries</a> are also experiencing increased rates of depression in youths.</p>
<p>See <a href="https://apps.who.int/iris/bitstream/handle/10665/254610/WHO-MSD-MER-2017.2-eng.pdf;jsessionid=E44360055DD83EAC472AA40C2853DBFA?sequence=1" target="_blank">this report</a> from the World Health Organization (WHO) about rates of depression in other countries.</p>
<p>See <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3330161/" target="_blank">here</a> for an interesting discussion about what may be causing increased depression rates.</p>
<p>According to the <a href="https://www.nimh.nih.gov/health/publications/teen-depression/index.shtml" target="_blank">National Institute of Mental Health (NIMH)</a>:</p>
</div>
<div id="section-9" class="section level4 emphasis_block">
<h4></h4>
<p>If you are in crisis and need help, call this toll-free number for the <strong>National Suicide Prevention Lifeline (NSPL)</strong>, available 24 hours a day, every day: <strong>1-800-273-TALK (8255)</strong>. The service is available to everyone. The deaf and hard of hearing can contact the Lifeline via TTY at 1-800-799-4889. All calls are confidential. You can also visit the Lifeline’s website at <a href="www.suicidepreventionlifeline.org" target="_blank">www.suicidepreventionlifeline.org</a>.</p>
<p>The <strong>Crisis Text Line</strong> is another free, confidential resource available 24 hours a day, seven days a week. Text “HOME” to <strong>741741</strong> and a trained crisis counselor will respond to you with support and information over text message. Visit <a href="www.crisistextline.org" target="_blank">www.crisistextline.org</a>.</p>
</div>
<div id="section-10" class="section level4">
<h4></h4>
<p>Also see <a href="https://www.mhanational.org/depression-teens-0" target="_blank">here</a> for more information about how to recognize and help youths experiencing symptoms of depression.</p>
</div>
</div>
<div id="limitations" class="section level2">
<h2><strong>Limitations</strong></h2>
<hr />
<p>There are some important considerations regarding this data analysis to keep in mind:</p>
<ol style="list-style-type: decimal">
<li><p>The data that we will use come from a survey and are therefore values from a sample that estimate that of the true population. In our statistical analysis we use these sample values as if they are population estimates (because this is all we have access to). Thus, our results are not necessarily indicative of population differences.</p></li>
<li><p>Furthermore, the sampling mechanism utilized for the survey can introduce <a href="https://en.wikipedia.org/wiki/Selection_bias?oldformat=true" target="_blank">selection bias</a> in cases where the the <a href="https://en.wikipedia.org/wiki/Sampling_(statistics)?oldformat=true" target="_blank">sampling methods do not produce a representative sample</a>.</p></li>
<li><p>Data are collected from human participants; this presents the <em>potential</em> for information bias, as there is the <em>potential</em> that participants in the <a href="https://en.wikipedia.org/wiki/Sampling_frame?oldformat=true" target="_blank">sampling frame</a> may for a variety of reasons report inaccurate information.</p></li>
<li><p>Data about certain group <a href="https://www.vox.com/the-highlight/2019/5/20/18542843/intersectionality-conservatism-law-race-gender-discrimination" target="_blank">intersections</a> (meaning for example individuals of a particular gender and ethnicity) or particular groups in general such as specific ethnicities or gender or sexual identity groups such as LGBT (lesbian/gay/bisexual/transgender/queer and questioning) or non-binary gender populations is unfortunately not available in the data used in this analysis and in most research about this topic.</p></li>
</ol>
<p>Note: While <a href="https://www.who.int/genomics/gender/en/index1.html">gender and sex</a> are not actually binary, the data used in this analysis unfortunately only contains information for groups of individuals who self-reported as male or female. We also acknowledge that unfortunately not all ethnicities or group intersections are represented in the data either. More research should be devoted to collecting data about the mental health of these groups.</p>
</div>
<div id="what-are-the-data" class="section level2">
<h2><strong>What are the data?</strong></h2>
<hr />
<p>We will be using data from the <a href="https://nsduhweb.rti.org/respweb/homepage.cfm" target="_blank">National Survey on Drug Use and Health (NSDUH)</a> which is directed by the <a href="https://www.samhsa.gov/" target="_blank">Substance Abuse and Mental Health Services Administration (SAMHSA)</a>, an agency in the <a href="https://www.hhs.gov/" target="_blank">U.S. Department of Health and Human Services (DHHS)</a>.</p>
<p>This survey started in 1971 and is conducted annually in all 50 states and the District of Columbia. Approximately 70,000 people (ages 12 and up) are interviewed each year about health related issues. Only civilian, non-institutionalized individuals are included. Households are randomly selected and than a professional interviewer visits the addresses and asks one or two of the residents to interview. The interviewer brings a laptop with them that the participants use to fill out the survey which typically takes an hour to complete. If a participant chooses to participate they receive $30 in cash. All collected information is confidential and is used for disease surveillance and to guide public policy particularly focused on drug and alcohol use as well as mental health. See <a href="https://nsduhweb.rti.org/respweb/about_nsduh.html" target="_blank">here</a> for more details about the survey.</p>
<p>The data are made available publicly online on the <a href="https://datafiles.samhsa.gov/" target="_blank">Substance Abuse &amp; Mental Health Data Archive</a>.</p>
<p><img src="img/nsudh_screenshot_webpage.png" width="100%" style="display: block; margin: auto;" /></p>
<p>On the <a href="https://www.samhsa.gov/data/sites/default/files/cbhsq-reports/NSDUHDetailedTabs2018R2/NSDUHDetTabsSect11pe2018.htm" target="_blank">website</a> with the survey data, you can see that the results are displayed in many tables. Importantly, there is no obvious way to download the data directly from this particular website.</p>
<p><img src="img/website_overview.png" width="100%" style="display: block; margin: auto;" /></p>
<p>If one clicks on the TOC button on the far right upper corner they will be directed to another <a href="https://www.samhsa.gov/data/sites/default/files/cbhsq-reports/NSDUHDetailedTabs2018R2/NSDUHDetailedTabsTOC2018.htm#toc" target="_blank">website</a>, where a large <a href="https://www.samhsa.gov/data/sites/default/files/cbhsq-reports/NSDUHDetailedTabs2018R2/NSDUHDetailedTabs2018.pdf" target="_blank">pdf document</a> containing of all of the results can be downloaded.</p>
<p>We are interested in investigating how depression rates have changed and how youths are interacting with mental health services. Thus, the following tables are of interest to us are:</p>
<table>
<colgroup>
<col width="18%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th>Table</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Table 11.1A</td>
<td>Settings Where Mental Health Services Were Received in Past Year among Persons Aged 12 to 17: Numbers in Thousands, 2002-2018</td>
</tr>
<tr class="even">
<td>Table 11.1B</td>
<td>Settings Where Mental Health Services Were Received in Past Year among Persons Aged 12 to 17: Percentages, 2002-2018</td>
</tr>
<tr class="odd">
<td>Table 11.2A</td>
<td>Major Depressive Episode in Past Year among Persons Aged 12 to 17, by Demographic Characteristics: Numbers in Thousands, 2004-2018</td>
</tr>
<tr class="even">
<td>Table 11.2B</td>
<td>Major Depressive Episode in Past Year among Persons Aged 12 to 17, by Demographic Characteristics: Percentages, 2004-2018</td>
</tr>
<tr class="odd">
<td>Table 11.3A</td>
<td>Major Depressive Episode with Severe Impairment in Past Year among Persons Aged 12 to 17, by Demographic Characteristics: Numbers in Thousands, 2006-2018</td>
</tr>
<tr class="even">
<td>Table 11.3B</td>
<td>Major Depressive Episode with Severe Impairment in Past Year among Persons Aged 12 to 17, by Demographic Characteristics: Percentages, 2006-2018</td>
</tr>
<tr class="odd">
<td>Table 11.4A</td>
<td>Receipt of Treatment for Depression in Past Year among Persons Aged 12 to 17 with Major Depressive Episode in Past Year, by Demographic Characteristics: Numbers in Thousands, 2004-2018</td>
</tr>
<tr class="even">
<td>Table 11.4B</td>
<td>Receipt of Treatment for Depression in Past Year among Persons Aged 12 to 17 with Major Depressive Episode in Past Year, by Demographic Characteristics: Percentages, 2004-2018</td>
</tr>
</tbody>
</table>
<p>Our goal is to bring these data into R so we can explore them.</p>
<hr />
<details>
<p><summary>Click here for the NSDUH defines a major depressive episode (MDE) </summary></p>
<p>According to the <a href="https://www.samhsa.gov/data/sites/default/files/cbhsq-reports/NSDUHNationalFindingsReport2018/NSDUHNationalFindingsReport2018.pdf" target="_blank">NSDUH 2018 report</a></p>
<blockquote>
<p>Respondents were defined as having had an MDE in the past 12 months if they had at least one period of 2 weeks or longer in the past year when they experienced a depressed mood or loss of interest or pleasure in daily activities, accompanied by problems with sleeping, eating, energy, concentration, or self-worth. The MDE questions are based on diagnostic criteria from DSM-5. Some of the wordings of the depression questions for adolescents aged 12 to 17 and adults aged 18 or older differed slightly to make the questions more developmentally appropriate for adolescents.</p>
</blockquote>
<blockquote>
<p>Adolescents were defined as having an MDE with severe impairment if their depression caused severe problems with their ability to do chores at home, do well at work or school, get along with their family, or have a social life.</p>
</blockquote>
</details>
<hr />
</div>
<div id="data-import" class="section level2">
<h2><strong>Data Import</strong></h2>
<hr />
<p>Data are often made available online. Sometimes, the data we are interested in is made available for download on a web page as a delimited text file or an excel file. However, sometimes data are not made available in this manner, such as the <a href="https://www.samhsa.gov/data/sites/default/files/cbhsq-reports/NSDUHDetailedTabs2018R2/NSDUHDetTabsSect11pe2018.htm" target="_blank">NSDUH survey data</a>.</p>
<p>How do we proceed in this scenario?</p>
<p>We can manually copy each cell of data, however, this process is often inefficient, subject to error, and not reproducible. Say we wanted to run an analysis next year on the next years data and it happens to be formatted in the same way.</p>
<p>Alternatively, we could use <code>R</code> for to scrape the data from the web!</p>
<p>Formally, <a href="https://en.wikipedia.org/wiki/Web_scraping?oldformat=true" target="_blank">web scraping</a> is the process of extracting data from a webpage. Let’s learn how to do this for our case study.</p>
<div id="basic-steps-of-web-scraping" class="section level3">
<h3>Basic steps of web scraping</h3>
<p>There are two main steps to web scraping:</p>
<ol style="list-style-type: decimal">
<li><p>Identify <strong>location</strong> of data on the webpage that will be scraped.</p></li>
<li><p>Save the webpage <strong>element</strong> to an R <strong>object</strong>.</p></li>
</ol>
<p>We accomplish STEP 1 with our web browser.</p>
<p>We accomplish STEP 2 in the <code>R</code> programming environment.</p>
<div id="section-11" class="section level4 resource_block">
<h4></h4>
<p><u>Additional resources for web scraping</u>:</p>
<ul>
<li><a href="https://rstudio-pubs-static.s3.amazonaws.com/266430_f3fd4660b2744751ab144aa130768a06.html" target="_blank">Vignette</a></li>
<li><a href="http://blog.corynissen.com/2015/01/using-rvest-to-scrape-html-table.html" target="_blank">Blog</a></li>
<li><a href="http://research.libd.org/rstatsclub/post/introduction-to-scraping-and-wranging-tables-from-research-articles/#.Xw878ZNKhQJ" target="_blank">Blog</a></li>
<li><a href="https://cran.r-project.org/web/packages/rvest/vignettes/selectorgadget.html" target="_blank">Selectorgadget Tool</a></li>
</ul>
</div>
<div id="section-12" class="section level4">
<h4></h4>
<p>In this case study, we will scrape data from the tables on the <a href="https://www.samhsa.gov/data/sites/default/files/cbhsq-reports/NSDUHDetailedTabs2018R2/NSDUHDetTabsSect11pe2018.htm" target="_blank">NSDUH survey</a> website. These data are available in a large PDF with all the results by year. However, it is not easy to find this PDF and it would be difficult and time consuming to find our tables of interest and to extract the data from the pdf with <code>pdftools</code>. Again, if we instead decided to copy paste the data from the website to another file that we would also need to import, this would not be as efficient or reproducible and might result in errors.</p>
<p>Alternatively, we will use the <code>rvest</code> package to <a href="https://en.wikipedia.org/wiki/Web_scraping?oldformat=true" target="_blank">scrape</a> the data directly from the tables on the website. Assuming the data next year would be displayed in a similar manner, this could allow us simply modify our code based on the url for the data next year to run the same analysis on the data easily.</p>
<p>The <code>rvest</code> package can be thought of as the <code>pdftools</code> package for web scraping. Upon pulling the data, additional wrangling will likely be required; but like the <code>pdftools</code> package, <code>rvest</code> streamlines the extraction process.</p>
</div>
</div>
<div id="scraping-tables-into-r" class="section level3">
<h3>Scraping tables into R</h3>
<p>The two web scraping steps for these tables can be broken down even further:</p>
<ol style="list-style-type: decimal">
<li>Identify location of data that will be scraped</li>
</ol>
<ul>
<li>right-click to inspect element (webpage)</li>
<li>hover pointer over components of element (webpage) until the data has been found</li>
<li>copy XPath of data sought</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Save webpage element to an object in R</li>
</ol>
<ul>
<li>import html code for the webpage</li>
<li>extract pieces of HTML documents (webpage) using XPath</li>
<li>parse the extracted data into a data frame</li>
</ul>
<p>Below is a animated overview of the process.</p>
<details>
<p><summary> Click here if you want to see how this animation was made!</summary></p>
<p>First the images need to be imported into R using the <code>image_read</code> function of the <code>magick</code> package.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">step1 &lt;-<span class="st"> </span>magick<span class="op">::</span><span class="kw">image_read</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;webpage_screenshot.png&quot;</span>))</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">step2 &lt;-<span class="st"> </span><span class="kw">image_read</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;table_screenshot_inspect.png&quot;</span>))</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">step3 &lt;-<span class="st"> </span><span class="kw">image_read</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;table_screenshot_inspect_table.png&quot;</span>))</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">step4 &lt;-<span class="st"> </span><span class="kw">image_read</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;table_screenshot_inspect_table_xpath.png&quot;</span>))</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">step5 &lt;-<span class="st"> </span><span class="kw">image_read</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;table_screenshot_xpath_copy_r.png&quot;</span>))</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">step5_zoom &lt;-<span class="st"> </span><span class="kw">image_read</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;table_screenshot_xpath_copy_r_zoom.png&quot;</span>))</a></code></pre></div>
<p>The last image is smaller than the others, to get a sense of the size we can use the <code>image_info()</code> function of the <code>magick</code> package.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">step5</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">step5_zoom</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-15-2.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">image_info</span>(step5)</a></code></pre></div>
<pre><code># A tibble: 1 x 7
  format width height colorspace matte filesize density
  &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  
1 PNG     1440    900 sRGB       TRUE    306274 72x72  </code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">image_info</span>(step5_zoom)</a></code></pre></div>
<pre><code># A tibble: 1 x 7
  format width height colorspace matte filesize density
  &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  
1 PNG      869    231 sRGB       TRUE     57559 72x72  </code></pre>
<p>First let’s re-size the second image to make it a bit larger using the <code>image_resize()</code> function of the <code>magick</code> package. We will re-size the width to be the same as the previous image width and keep the aspect ratio for the height by using “1440x”. If we wanted to just do the same for height we would use “x900”.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">step5_zoom &lt;-<span class="st"> </span><span class="kw">image_resize</span>(step5_zoom,  <span class="st">&quot;1440x&quot;</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">step5_zoom</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can add a white boarder around the last image to make the size more similar height-wise using the <code>image_border()</code> function of the <code>magick</code> package. There are many image modification functions in the <code>magick</code> package! See <a href="https://cran.r-project.org/web/packages/magick/vignettes/intro.html" target="_blank">here</a> to learn more.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">step5_zoom &lt;-<span class="st"> </span><span class="kw">image_border</span>(step5_zoom, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;2x334&quot;</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">step5_zoom</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Looks good!</p>
<p>Now we will make the sequence of images for our animation. We also want to indicate how long we want to spend on each relative to the others. We want to linger on the last image so we include it two times.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">img &lt;-<span class="st"> </span><span class="kw">c</span>(step1,</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">         step2,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">         step3,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">         step4,</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">         step5,</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">         step5_zoom,</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">         step5_zoom)</a></code></pre></div>
<p>Now, we are ready to create our gif! But first we want to modify our images a bit more.</p>
<p>First we want to make all images within <code>img</code> the exact same size using the <code>image_resize()</code> function. To do this for all images we can use the <code>!</code> at the end, which ignoring aspect ratios.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">image_info</span>(img)</a></code></pre></div>
<pre><code># A tibble: 7 x 7
  format width height colorspace matte filesize density
  &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  
1 PNG     1439    855 sRGB       TRUE    189980 72x72  
2 PNG     1436    857 sRGB       TRUE    232355 72x72  
3 PNG     1439    857 sRGB       TRUE    315277 72x72  
4 PNG     1439    856 sRGB       TRUE    346714 72x72  
5 PNG     1440    900 sRGB       TRUE    306274 72x72  
6 PNG     1444   1051 sRGB       TRUE         0 72x72  
7 PNG     1444   1051 sRGB       TRUE         0 72x72  </code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">img &lt;-<span class="kw">image_resize</span>(img, <span class="st">&#39;1440x900!&#39;</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw">image_info</span>(img)</a></code></pre></div>
<pre><code># A tibble: 7 x 7
  format width height colorspace matte filesize density
  &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  
1 PNG     1440    900 sRGB       TRUE         0 72x72  
2 PNG     1440    900 sRGB       TRUE         0 72x72  
3 PNG     1440    900 sRGB       TRUE         0 72x72  
4 PNG     1440    900 sRGB       TRUE         0 72x72  
5 PNG     1440    900 sRGB       TRUE         0 72x72  
6 PNG     1440    900 sRGB       TRUE         0 72x72  
7 PNG     1440    900 sRGB       TRUE         0 72x72  </code></pre>
<p>We also want to morph or blend each image into the next so that there appears to be a smooth transition. We can also specify how many frames to include in the morph, to speed up or slow down the blend from one image to another. We will specify that 4 frames should be used in the morph by using the <code>image_morph()</code> function.</p>
<p>To make the final animation we use the <code>image_animate()</code> function Importantly, we want to delay changing from one image to another about 70* 1/100 seconds to give people a chance to see what is happening. So we can use the <code>delay</code> argument. The optimize argument of this function requires that all images are the same size (luckily we did this!) and it causes R to only store the differences between frames.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">educational_gif &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="st">  </span><span class="kw">image_morph</span>(img, <span class="dt">frames =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="st">  </span><span class="kw">image_animate</span>(<span class="dt">delay =</span> <span class="dv">70</span>,</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">                <span class="dt">optimize =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Now to save our gif we can use the <code>image_write()</code> function of the <code>magick</code> package and the <code>here()</code> function of the <code>here</code> package to easily save it in a directory called <code>img</code> within the directory that contains our .Rproj file. We will name the file educational.gif.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">image_write</span>(educational_gif,</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">      here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;educational.gif&quot;</span>))</a></code></pre></div>
</details>
<p><img src="img/educational.gif" width="90%" style="display: block; margin: auto;" /></p>
<hr />
<p>Now let’s go through each step together:</p>
<div id="identify-location-of-data-that-will-be-scraped" class="section level4">
<h4>1) Identify location of data that will be scraped</h4>
<p>First, let’s go to the <a href="https://www.samhsa.gov/data/sites/default/files/cbhsq-reports/NSDUHDetailedTabs2018R2/NSDUHDetTabsSect11pe2018.htm" target="_blank">web page</a> with all the tables we are interested in scraping</p>
<p><img src="index_files/figure-html/step1-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Once on the webpage, there are not any visible options to download the data.</p>
<p>Right-click and select “Inspect”.</p>
<p><img src="index_files/figure-html/step2-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>A window opens.</p>
<p>This window allows us to glance at the internal mechanics of the webpage. To scrape the data from the webpage, we need to first learn a little bit about the components that make it the web page it is.</p>
<p>Hovering our mouse over the elements of the webpage highlights the respective section of the webpage it represents. By hovering over several elements—and clicking on the elements on the right side of the screen—we can identify the element that contains the data we are looking for. Another option for identifying XPaths is to use the <a href="https://cran.r-project.org/web/packages/rvest/vignettes/selectorgadget.html" target="_blank">selectorgadget tool</a>.</p>
<p><img src="index_files/figure-html/step3-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Right click on the element and copy the XPath. We will need this XPath for the next step.</p>
<p><img src="index_files/figure-html/step4-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Now we can return to the <code>R</code> programming environment.</p>
<p><img src="index_files/figure-html/step5-1.png" width="90%" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="save-webpage-element-to-an-object-in-r" class="section level4">
<h4>2) Save webpage element to an object in R</h4>
<p>For the first table we want to scrape, the XPath is <code>/html/body/div[4]/div[1]/table</code>. We use this XPath with functions from the <code>rvest</code> package to scrape the data from this table.</p>
<p><img src="index_files/figure-html/step5_zoom-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Let’s explore this step in greater detail:</p>
<p>We need to:</p>
<ul>
<li>import html code for the webpage</li>
<li>extract pieces (table) out of HTML documents (webpage) using XPath</li>
<li>parse the html table into a data frame</li>
</ul>
<p>To do this:</p>
<ul>
<li>We import the html code using the <code>read_html()</code> function of the <code>rvest</code> package</li>
<li>We extract specific components of the webpage using the <code>html_nodes()</code> function of the <code>rvest</code> package</li>
<li>We convert this html table into a dataframe using the <code>html_table()</code>function of the <code>rvest</code> package</li>
</ul>
<p><strong>The <code>rvest</code> package provides wrappers for the <code>xml2</code> and <code>httr</code> packages, thus we can just install and load the <code>rvest</code> package and it will install and load dependency packages like <code>xml2</code> and <code>httr</code> and allow us to use functions from both of these packages.</strong></p>
<p>In fact, when we load <code>rvest</code> the first time we see:</p>
<p><img src="img/rvest.png" width="60%" style="display: block; margin: auto;" /></p>
<p>In this case, we are scraping Table 11.1A from the website. First, we assign the URL to a character string to use within the <code>read_html()</code> function in the <code>xml2</code> package.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">NSDUH_url &lt;-<span class="st"> &quot;https://www.samhsa.gov/data/sites/default/files/cbhsq-reports/NSDUHDetailedTabs2018R2/NSDUHDetTabsSect11pe2018.htm&quot;</span></a></code></pre></div>
<p>One could also directly use the URL but this is less convenient for piping.</p>
<hr />
<details>
<p><summary>Click here if you are unfamiliar with piping in R, which uses this <code>%&gt;%</code> operator</summary></p>
<p>By <a href="https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html" target="_blank">piping</a> we mean using the <code>%&gt;%</code> pipe operator which is accessible after loading the <code>tidyverse</code> or several of the packages within the tidyverse like <code>dplyr</code> because they load the <a href="https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html" target="_blank"><code>magrittr</code> package</a>. This allows us to perform multiple sequential steps on one data input.</p>
</details>
<hr />
<p>Then, the <code>read_html()</code> function allows us to save the html document for the webpage inside R.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">webpage &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="st">  </span>NSDUH_url <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="st">  </span>xml2<span class="op">::</span><span class="kw">read_html</span>() </a>
<a class="sourceLine" id="cb19-4" data-line-number="4">webpage</a></code></pre></div>
<pre><code>{html_document}
&lt;html lang=&quot;en&quot;&gt;
[1] &lt;head&gt;\n&lt;!-- Google Tag Manager --&gt;&lt;script&gt;(function(w,d,s,l,i){w[l]=w[l] ...
[2] &lt;body&gt;\r\n&lt;!-- Google Tag Manager (noscript) --&gt;\r\n&lt;noscript&gt;&lt;iframe src ...</code></pre>
<p>Then, we use the <code>html_nodes()</code> function of the <code>rvest</code> package to select just the Table 11.1A element of the webpage.</p>
<p>See this <a href="http://flukeout.github.io/#" target="_blank">tutorial</a> (and the <a href="https://gist.github.com/chrisman/fcb0a88459cd98239dbe6d2d200b02d1" target="_blank">answers</a> in case you get stuck) on CSS selectors to understand more about how this function works to use the <code>xpath</code> to select the elements of interest from the webpage.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">webpage_element &lt;-</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="st">  </span>webpage <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="st">  </span>rvest<span class="op">::</span><span class="kw">html_nodes</span>(<span class="dt">xpath=</span><span class="st">&#39;/html/body/div[4]/div[1]/table&#39;</span>)</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">webpage_element </a></code></pre></div>
<pre><code>{xml_nodeset (1)}
[1] &lt;table class=&quot;rti&quot;&gt;\n&lt;caption&gt;Table 11.1A – Settings Where Mental Health  ...</code></pre>
<p>Finally, the <code>html_table()</code> function of the <code>rvest</code> package parses the html object into a data frame.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">table11<span class="fl">.1</span>a &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="st">  </span>webpage_element <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="st">  </span>rvest<span class="op">::</span><span class="kw">html_table</span>()</a>
<a class="sourceLine" id="cb23-4" data-line-number="4"></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="kw">print</span>(table11<span class="fl">.1</span>a, <span class="dt">max =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>[[1]]
     Setting Where Mental Health ServiceWas Received 2002 2003 2004 2005 2006
     2007 2008 2009 2010 2011 2012 2013 2014 2015 2016 2017 2018
 [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 21 rows ]</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw">glimpse</span>(table11<span class="fl">.1</span>a)</a></code></pre></div>
<pre><code>List of 1
 $ :&#39;data.frame&#39;:   21 obs. of  18 variables:
  ..$ Setting Where Mental Health ServiceWas Received: chr [1:21] &quot;SPECIALTY MENTAL HEALTH SERVICE1&quot; &quot;Outpatient&quot; &quot;Private Therapist, Psychologist,\r\n   Psychiatrist, Social Worker, or\r\n   Counselor&quot; &quot;Mental Health Clinic or Center&quot; ...
  ..$ 2002                                           : chr [1:21] &quot;2,898a&quot; &quot;2,662a&quot; &quot;2,254a&quot; &quot;611a&quot; ...
  ..$ 2003                                           : chr [1:21] &quot;3,065a&quot; &quot;2,795a&quot; &quot;2,347a&quot; &quot;635a&quot; ...
  ..$ 2004                                           : chr [1:21] &quot;3,348a&quot; &quot;3,015a&quot; &quot;2,523a&quot; &quot;716a&quot; ...
  ..$ 2005                                           : chr [1:21] &quot;3,362a&quot; &quot;3,048a&quot; &quot;2,573a&quot; &quot;657a&quot; ...
  ..$ 2006                                           : chr [1:21] &quot;3,255a&quot; &quot;2,931a&quot; &quot;2,416a&quot; &quot;587a&quot; ...
  ..$ 2007                                           : chr [1:21] &quot;3,104a&quot; &quot;2,787a&quot; &quot;2,365a&quot; &quot;583a&quot; ...
  ..$ 2008                                           : chr [1:21] &quot;3,129a&quot; &quot;2,837a&quot; &quot;2,408a&quot; &quot;567a&quot; ...
  ..$ 2009                                           : chr [1:21] &quot;2,925a&quot; &quot;2,650a&quot; &quot;2,296a&quot; &quot;537a&quot; ...
  ..$ 2010                                           : chr [1:21] &quot;2,920a&quot; &quot;2,635a&quot; &quot;2,265a&quot; &quot;547a&quot; ...
  ..$ 2011                                           : chr [1:21] &quot;3,101a&quot; &quot;2,842a&quot; &quot;2,409a&quot; &quot;547a&quot; ...
  ..$ 2012                                           : chr [1:21] &quot;3,118a&quot; &quot;2,846a&quot; &quot;2,427a&quot; &quot;610a&quot; ...
  ..$ 2013                                           : chr [1:21] &quot;3,341a&quot; &quot;3,064a&quot; &quot;2,572a&quot; &quot;731a&quot; ...
  ..$ 2014                                           : chr [1:21] &quot;3,369a&quot; &quot;3,110a&quot; &quot;2,698a&quot; &quot;760a&quot; ...
  ..$ 2015                                           : chr [1:21] &quot;3,253a&quot; &quot;2,958a&quot; &quot;2,532a&quot; &quot;792a&quot; ...
  ..$ 2016                                           : chr [1:21] &quot;3,598a&quot; &quot;3,239a&quot; &quot;2,819a&quot; &quot;929&quot; ...
  ..$ 2017                                           : chr [1:21] &quot;3,646a&quot; &quot;3,328&quot; &quot;2,908&quot; &quot;995&quot; ...
  ..$ 2018                                           : chr [1:21] &quot;3,901&quot; &quot;3,547&quot; &quot;3,080&quot; &quot;977&quot; ...</code></pre>
<p>We can see that the output is a list with one element, to extract the data from the list we will use brackets <code>[[]]</code> to select the first element of the list.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">table11<span class="fl">.1</span>a &lt;-<span class="st"> </span>table11<span class="fl">.1</span>a[[<span class="dv">1</span>]]</a></code></pre></div>
<p>Putting this all of this together we can do the entire process like this with our pipe operator <code>%&gt;%</code>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">table11<span class="fl">.1</span>a &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="st">  </span>NSDUH_url <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="st">  </span>xml2<span class="op">::</span><span class="kw">read_html</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="st">  </span>rvest<span class="op">::</span><span class="kw">html_nodes</span>(<span class="dt">xpath=</span><span class="st">&#39;/html/body/div[4]/div[1]/table&#39;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-5" data-line-number="5"><span class="st">  </span>rvest<span class="op">::</span><span class="kw">html_table</span>()</a>
<a class="sourceLine" id="cb28-6" data-line-number="6">table11<span class="fl">.1</span>a &lt;-<span class="st"> </span>table11<span class="fl">.1</span>a[[<span class="dv">1</span>]]</a></code></pre></div>
<p>Now, we need to repeat the above process for the other tables we are interested in.</p>
</div>
</div>
<div id="writing-a-function-to-scrape-multiple-tables" class="section level3">
<h3>Writing a function to scrape multiple tables</h3>
<p>One option is to copy and paste code we wrote above. However, this is not very efficient and is error prone. Alternatively, we can create a R function to accomplish this succinctly. Functions allow us to perform the same process on multiple data inputs. See <a href="https://opencasestudies.github.io/ocs-bloomberg-vaping-case-study/" target="_blank">this other case study</a> for more details about how to write a function.</p>
<p>In general, the process of writing functions involves first specifying an input that is used within the function to create an output. In this case, the data input is <code>XPATH</code>, which will be replaced by an actual XPath and then used in the subsequent steps to scrape the data from each table that an XPath is supplied for.</p>
<p>We will call this function <code>scraper</code>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">scraper &lt;-<span class="st"> </span><span class="cf">function</span>(XPATH){</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">  NSDUH_url &lt;-<span class="st"> &quot;https://www.samhsa.gov/data/sites/default/files/cbhsq-reports/NSDUHDetailedTabs2018R2/NSDUHDetTabsSect11pe2018.htm&quot;</span></a>
<a class="sourceLine" id="cb29-3" data-line-number="3">  table &lt;-<span class="st"> </span>NSDUH_url <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="st">  </span><span class="kw">read_html</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5"><span class="st">  </span><span class="kw">html_nodes</span>(<span class="dt">xpath=</span>XPATH) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-6" data-line-number="6"><span class="st">  </span><span class="kw">html_table</span>()</a>
<a class="sourceLine" id="cb29-7" data-line-number="7">  output &lt;-<span class="st"> </span>table[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb29-8" data-line-number="8">  output</a>
<a class="sourceLine" id="cb29-9" data-line-number="9">}</a></code></pre></div>
<p>Now we can apply the function we created to each of the XPaths for each of the tables on the website that we would like to use in our data analysis.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">table11<span class="fl">.1</span>b &lt;-<span class="st"> </span><span class="kw">scraper</span>(<span class="dt">XPATH =</span> <span class="st">&quot;/html/body/div[4]/div[2]/table&quot;</span>)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">table11<span class="fl">.2</span>a &lt;-<span class="st"> </span><span class="kw">scraper</span>(<span class="dt">XPATH =</span> <span class="st">&#39;/html/body/div[4]/div[3]/table&#39;</span>)</a>
<a class="sourceLine" id="cb30-3" data-line-number="3">table11<span class="fl">.2</span>b &lt;-<span class="st"> </span><span class="kw">scraper</span>(<span class="dt">XPATH =</span> <span class="st">&#39;/html/body/div[4]/div[4]/table&#39;</span>)</a>
<a class="sourceLine" id="cb30-4" data-line-number="4">table11<span class="fl">.3</span>a &lt;-<span class="st"> </span><span class="kw">scraper</span>(<span class="dt">XPATH =</span> <span class="st">&#39;/html/body/div[4]/div[5]/table&#39;</span>)</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">table11<span class="fl">.3</span>b &lt;-<span class="st"> </span><span class="kw">scraper</span>(<span class="dt">XPATH =</span> <span class="st">&#39;/html/body/div[4]/div[6]/table&#39;</span>)</a>
<a class="sourceLine" id="cb30-6" data-line-number="6">table11<span class="fl">.4</span>a &lt;-<span class="st"> </span><span class="kw">scraper</span>(<span class="dt">XPATH =</span> <span class="st">&#39;/html/body/div[4]/div[7]/table&#39;</span>)</a>
<a class="sourceLine" id="cb30-7" data-line-number="7">table11<span class="fl">.4</span>b &lt;-<span class="st"> </span><span class="kw">scraper</span>(<span class="dt">XPATH =</span> <span class="st">&#39;/html/body/div[4]/div[8]/table&#39;</span>)</a></code></pre></div>
<p>Great! We have successfully scraped the data from the web into R!</p>
<p>Next, we need to wrangle the data.</p>
</div>
</div>
<div id="data-wrangling" class="section level2">
<h2><strong>Data Wrangling</strong></h2>
<hr />
<p>Now that we have imported the data, let’s see if we can wrangle a table. Since the data appear to be formatted in a similar way in each of the tables, it is likely that whatever steps we take to wrangle this first table will also be necessary in the wrangling of subsequent tables. This is because well-maintained data sources often format different datasets similarly. We can take advantage of this similarity to speed up the wrangling process.</p>
<div id="table11.1a" class="section level3">
<h3><strong>Table11.1a</strong></h3>
<p>First, we want to remove the last row of our data frame, which happens to be the legend of our table. Recall from looking at the website that there is a legend for this table.</p>
<p><img src="img/table11.1a.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can take a look at the last row using the <code>tail</code> function of the <code>dplyr</code> package. We can specify that we only want to see the last row by using the <code>n = 1</code> argument.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">table11<span class="fl">.1</span>a <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb31-3" data-line-number="3"><span class="st">  </span><span class="kw">tail</span>(<span class="dt">n =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code># A tibble: 1 x 18
  `Setting Where … `2002` `2003` `2004` `2005` `2006` `2007` `2008` `2009`
  &lt;chr&gt;            &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; 
1 &quot;* = low precis… &quot;* = … &quot;* = … &quot;* = … &quot;* = … &quot;* = … &quot;* = … &quot;* = … &quot;* = …
# … with 9 more variables: `2010` &lt;chr&gt;, `2011` &lt;chr&gt;, `2012` &lt;chr&gt;,
#   `2013` &lt;chr&gt;, `2014` &lt;chr&gt;, `2015` &lt;chr&gt;, `2016` &lt;chr&gt;, `2017` &lt;chr&gt;,
#   `2018` &lt;chr&gt;</code></pre>
<p>We can see that the legend is repeated for every column. Let’s take a look at the year 2004 column.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">table11<span class="fl">.1</span>a <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">2004</span><span class="st">`</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-4" data-line-number="4"><span class="st">  </span><span class="kw">tail</span>(<span class="dt">n =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code># A tibble: 1 x 1
  `2004`                                                                        
  &lt;chr&gt;                                                                         
1 &quot;* = low precision; -- = not available; da = does not apply; nc = not compara…</code></pre>
<p>Let’s save this so that we can refer back to it later:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">legend &lt;-<span class="st"> </span>table11<span class="fl">.1</span>a <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb35-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">2004</span><span class="st">`</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="st">  </span><span class="kw">tail</span>(<span class="dt">n =</span> <span class="dv">1</span>)</a></code></pre></div>
<p>Another way to look at the last row is to use the <code>n()</code> function of the <code>dplyr</code> package. This function can be used inside other <code>dplyr</code> functions and it counts the total number of observations of a group. Within the <a href="https://dplyr.tidyverse.org/reference/slice.html" target="_blank"><code>slice()</code> function</a> of the <code>dplyr</code> package, it allows you to refer the full length of the object.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">table11<span class="fl">.1</span>a <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="st">  </span><span class="kw">slice</span>(<span class="kw">n</span>()) </a></code></pre></div>
<pre><code># A tibble: 1 x 18
  `Setting Where … `2002` `2003` `2004` `2005` `2006` `2007` `2008` `2009`
  &lt;chr&gt;            &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; 
1 &quot;* = low precis… &quot;* = … &quot;* = … &quot;* = … &quot;* = … &quot;* = … &quot;* = … &quot;* = … &quot;* = …
# … with 9 more variables: `2010` &lt;chr&gt;, `2011` &lt;chr&gt;, `2012` &lt;chr&gt;,
#   `2013` &lt;chr&gt;, `2014` &lt;chr&gt;, `2015` &lt;chr&gt;, `2016` &lt;chr&gt;, `2017` &lt;chr&gt;,
#   `2018` &lt;chr&gt;</code></pre>
<p>We can use the <code>slice()</code> function of the <code>dplyr</code> package to remove this row, by using the <code>slice</code>function to select from the first row using <code>1:</code> to the second to last row using <code>n()-1</code>.</p>
<p>We are also going to use a special pipe operator from the <a href="https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html" target="_blank"><code>magrittr</code> package</a> called the compound assignment pipe-operator or sometimes the double pipe operator. This allows us to use the <code>table11.1a</code> as our input and reassign it at the end after all the steps have been performed.</p>
<p>We will also first change the data to be a <a href="https://tibble.tidyverse.org/#:~:text=A%20tibble%2C%20or%20tbl_df%20%2C%20is,modern%20reimagining%20of%20the%20data.&amp;text=Tibbles%20are%20data.,a%20variable%20does%20not%20exist">tibble</a>.), which is the <code>tidyverse</code> version of a data frame using the <code>as_tibble()</code> function of the <code>dplyr</code> package and the <code>tibble</code> package.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">table11<span class="fl">.1</span>a <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-3" data-line-number="3"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span>(<span class="kw">n</span>()<span class="op">-</span><span class="dv">1</span>))</a></code></pre></div>
<p>Now let’s take a look at data:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">head</span>(table11<span class="fl">.1</span>a)</a></code></pre></div>
<pre><code># A tibble: 6 x 18
  `Setting Where … `2002` `2003` `2004` `2005` `2006` `2007` `2008` `2009`
  &lt;chr&gt;            &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; 
1 &quot;SPECIALTY MENT… 2,898a 3,065a 3,348a 3,362a 3,255a 3,104a 3,129a 2,925a
2 &quot;Outpatient&quot;     2,662a 2,795a 3,015a 3,048a 2,931a 2,787a 2,837a 2,650a
3 &quot;Private Therap… 2,254a 2,347a 2,523a 2,573a 2,416a 2,365a 2,408a 2,296a
4 &quot;Mental Health … 611a   635a   716a   657a   587a   583a   567a   537a  
5 &quot;Partial Day Ho… 440    425    439    449    471    416    374a   340a  
6 &quot;In-Home Therap… 693a   656a   762a   731a   719a   707a   716a   657a  
# … with 9 more variables: `2010` &lt;chr&gt;, `2011` &lt;chr&gt;, `2012` &lt;chr&gt;,
#   `2013` &lt;chr&gt;, `2014` &lt;chr&gt;, `2015` &lt;chr&gt;, `2016` &lt;chr&gt;, `2017` &lt;chr&gt;,
#   `2018` &lt;chr&gt;</code></pre>
<p>Great! We can see the the legend is no longer part of the data.</p>
<p>Now let’s use the legend to recode the data. There are many different values for missing data, that we would like to replace with <code>NA</code> instead. We can use the <code>pull()</code> function of the <code>dplyr</code> package to take a look at the legend data:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw">pull</span>(legend, <span class="st">`</span><span class="dt">2004</span><span class="st">`</span>)</a></code></pre></div>
<pre><code>[1] &quot;* = low precision; -- = not available; da = does not apply; nc = not comparable due to methodological changes; nr = not reported due to measurement issues.\r\nNOTE: Some 2006 to 2010 estimates may differ from previously published estimates due to updates (see Section 3.3.5 in Chapter 3 of the 2018 National Survey on Drug Use and Health: Methodological Summary and Definitions).\r\nNOTE: Mental health services for persons aged 12 to 17 includes treatment/counseling for emotional or behavioral problems not caused by drug or alcohol use. Respondents with unknown mental health service information were excluded.\r\nNOTE: Respondents could indicate multiple service settings; thus, the response categories are not mutually exclusive.a The difference between this estimate and the 2018 estimate is statistically significant at the .05 level. Rounding may make the estimates appear identical.1 Because of revisions in 2013 to Specialty Mental Health Service estimates, these 2002 to 2012 estimates may differ from estimates published prior to the 2013 NSDUH.2 Because of revisions in 2009 to the questions on the Source of Youth Mental Health Education Services, these estimates are not comparable with the education services estimates published prior to the 2009 NSDUH.3 Respondents who did not report their school enrollment status, who reported not being enrolled in school in the past 12 months, or who reported being home-schooled were not asked about receipt of mental health services from this setting; however, respondents who reported not being enrolled in school in the past 12 months were classified as not having received treatment/counseling from this setting.\r\nDefinitions: Measures and terms are defined in Appendix A.\r\nSource: SAMHSA, Center for Behavioral Health Statistics and Quality, National Survey on Drug Use and Health, 2002-2018.&quot;</code></pre>
<p>Looks like we want to replace values that are: <code>*</code>, <code>--</code>, <code>da</code>, <code>nc</code>, and <code>nr</code>. We can use the <code>na_if()</code> function to recode these values to <code>NA</code>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">table11<span class="fl">.1</span>a <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">na_if</span>(<span class="st">&quot;nc&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">na_if</span>(<span class="st">&quot;--&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-4" data-line-number="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">na_if</span>(<span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-5" data-line-number="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">na_if</span>(<span class="st">&quot;*&quot;</span>)</a>
<a class="sourceLine" id="cb43-6" data-line-number="6"></a>
<a class="sourceLine" id="cb43-7" data-line-number="7"><span class="kw">head</span>(table11<span class="fl">.1</span>a)</a></code></pre></div>
<pre><code># A tibble: 6 x 18
  `Setting Where … `2002` `2003` `2004` `2005` `2006` `2007` `2008` `2009`
  &lt;chr&gt;            &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; 
1 &quot;SPECIALTY MENT… 2,898a 3,065a 3,348a 3,362a 3,255a 3,104a 3,129a 2,925a
2 &quot;Outpatient&quot;     2,662a 2,795a 3,015a 3,048a 2,931a 2,787a 2,837a 2,650a
3 &quot;Private Therap… 2,254a 2,347a 2,523a 2,573a 2,416a 2,365a 2,408a 2,296a
4 &quot;Mental Health … 611a   635a   716a   657a   587a   583a   567a   537a  
5 &quot;Partial Day Ho… 440    425    439    449    471    416    374a   340a  
6 &quot;In-Home Therap… 693a   656a   762a   731a   719a   707a   716a   657a  
# … with 9 more variables: `2010` &lt;chr&gt;, `2011` &lt;chr&gt;, `2012` &lt;chr&gt;,
#   `2013` &lt;chr&gt;, `2014` &lt;chr&gt;, `2015` &lt;chr&gt;, `2016` &lt;chr&gt;, `2017` &lt;chr&gt;,
#   `2018` &lt;chr&gt;</code></pre>
<p>Let’s look at the column names in our table:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="kw">colnames</span>(table11<span class="fl">.1</span>a)</a></code></pre></div>
<pre><code> [1] &quot;Setting Where Mental Health ServiceWas Received&quot;
 [2] &quot;2002&quot;                                           
 [3] &quot;2003&quot;                                           
 [4] &quot;2004&quot;                                           
 [5] &quot;2005&quot;                                           
 [6] &quot;2006&quot;                                           
 [7] &quot;2007&quot;                                           
 [8] &quot;2008&quot;                                           
 [9] &quot;2009&quot;                                           
[10] &quot;2010&quot;                                           
[11] &quot;2011&quot;                                           
[12] &quot;2012&quot;                                           
[13] &quot;2013&quot;                                           
[14] &quot;2014&quot;                                           
[15] &quot;2015&quot;                                           
[16] &quot;2016&quot;                                           
[17] &quot;2017&quot;                                           
[18] &quot;2018&quot;                                           </code></pre>
<p>Let’s rename the first column using the <code>rename()</code> function of the <code>dplyr</code> package. This requires listing the new name first like so: <code>new_name = old_name</code>.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1">table11<span class="fl">.1</span>a <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb47-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">MHS_setting =</span> <span class="st">`</span><span class="dt">Setting Where Mental Health ServiceWas Received</span><span class="st">`</span>)</a>
<a class="sourceLine" id="cb47-3" data-line-number="3"></a>
<a class="sourceLine" id="cb47-4" data-line-number="4"><span class="kw">head</span>(table11<span class="fl">.1</span>a)</a></code></pre></div>
<pre><code># A tibble: 6 x 18
  MHS_setting `2002` `2003` `2004` `2005` `2006` `2007` `2008` `2009` `2010`
  &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; 
1 &quot;SPECIALTY… 2,898a 3,065a 3,348a 3,362a 3,255a 3,104a 3,129a 2,925a 2,920a
2 &quot;Outpatien… 2,662a 2,795a 3,015a 3,048a 2,931a 2,787a 2,837a 2,650a 2,635a
3 &quot;Private T… 2,254a 2,347a 2,523a 2,573a 2,416a 2,365a 2,408a 2,296a 2,265a
4 &quot;Mental He… 611a   635a   716a   657a   587a   583a   567a   537a   547a  
5 &quot;Partial D… 440    425    439    449    471    416    374a   340a   362a  
6 &quot;In-Home T… 693a   656a   762a   731a   719a   707a   716a   657a   674a  
# … with 8 more variables: `2011` &lt;chr&gt;, `2012` &lt;chr&gt;, `2013` &lt;chr&gt;,
#   `2014` &lt;chr&gt;, `2015` &lt;chr&gt;, `2016` &lt;chr&gt;, `2017` &lt;chr&gt;, `2018` &lt;chr&gt;</code></pre>
<p>Nice!</p>
<p>Now you may notice that the individual values have an <code>&quot;a&quot;</code> after the numeric value.</p>
<p>According to the legend this indicates if “the difference between this estimate and the 2018 estimate is significant at the <span class="math inline">\(\alpha\)</span>=.05 level.”</p>
<p>While this is useful information, it makes it difficult to work with our numeric values, so we want to remove them.</p>
<p>Since lower case “a” values occur in the first column values, we want to makes sure we don’t remove these.</p>
<p>So how can we do this? We can use the <code>stringr</code> package to modify character strings. Also, we can use the <code>dplyr</code> functions <code>mutate()</code>, <code>select()</code> and <code>across()</code> to specify want columns we want to change.</p>
<p>Currently all of our data are character strings as indicated by the <code>&lt;chr&gt;</code> under the column names.</p>
<hr />
<details>
<p><summary> Click here for an explanation of what a character string is </summary></p>
<p>There are several classes of data in R programming. Character is one of these classes. A character string is an individual data value made up of characters. This can be a paragraph, like the legend for the table, or it can be a single letter or number like the letter <code>&quot;a&quot;</code> or the number <code>&quot;3&quot;</code>. If data are of class character, than the numeric values will not be processed like a numeric value in a mathematical sense. If you want your numeric values to be interpreted that way, they need to be converted to a numeric class. The options typically used are integer (which has no decimal place) and double precision (which has a decimal place).</p>
</details>
<hr />
<p>The <code>stringr</code> package has functions that allow us to replace (using the <code>str_replace()</code> function) or remove (using the <code>str_remove()</code> function) characters.</p>
<p>To use these, we need to be able to specify what we want to remove and replace.</p>
<p>Here is a part of a <a href="https://rstudio.com/resources/cheatsheets/" target="_blank">cheatsheet</a> about string manipulation from RStudio.</p>
<p><img src="img/regex.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can see that we can refer to any digit (such as 1, 2, 3 etc.) as <code>[:digit:]</code>. We can also see that we can refer to any punctuation mark as <code>[:punct:]</code>. Finally, we see that spaces and tabs can be referred to as <code>[:blank:]</code>.</p>
<p>If we take a closer look at the first column of our table (using the <code>pull()</code> function of the <code>dplyr</code> package), we can see that besides the <code>&quot;a&quot;</code> values that we see adjacent to our numeric values in the body of the table, we also have some large white spaces, some numeric values, instances of <code>\r\n</code>, as well as some commas and other punctuation marks.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">table11<span class="fl">.1</span>a <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-2" data-line-number="2"><span class="st">  </span><span class="kw">pull</span>(MHS_setting)</a></code></pre></div>
<pre><code> [1] &quot;SPECIALTY MENTAL HEALTH SERVICE1&quot;                                                                                
 [2] &quot;Outpatient&quot;                                                                                                      
 [3] &quot;Private Therapist, Psychologist,\r\n   Psychiatrist, Social Worker, or\r\n   Counselor&quot;                          
 [4] &quot;Mental Health Clinic or Center&quot;                                                                                  
 [5] &quot;Partial Day Hospital or Day Treatment\r\n   Program&quot;                                                             
 [6] &quot;In-Home Therapist, Counselor, or Family\r\n   Preservation Worker&quot;                                               
 [7] &quot;Inpatient or Residential1&quot;                                                                                       
 [8] &quot;Hospital&quot;                                                                                                        
 [9] &quot;Residential Treatment Center&quot;                                                                                    
[10] &quot;NONSPECIALTY MENTAL HEALTH\r\nSERVICE2&quot;                                                                          
[11] &quot;Education2,3&quot;                                                                                                    
[12] &quot;School Social Worker, School Psychologist,\r\n   or School Counselor&quot;                                            
[13] &quot;Special School or Program within a Regular\r\n   School for Students with Emotional or\r\n   Behavioral Problems&quot;
[14] &quot;General Medicine&quot;                                                                                                
[15] &quot;Pediatrician or Other Family Doctor&quot;                                                                             
[16] &quot;Juvenile Justice&quot;                                                                                                
[17] &quot;Juvenile Detention Center, Prison, or Jail&quot;                                                                      
[18] &quot;Child Welfare&quot;                                                                                                   
[19] &quot;Foster Care or Therapeutic Foster Care&quot;                                                                          
[20] &quot;SPECIALTY MENTAL HEALTH SERVICES\r\nAND EDUCATION, GENERAL MEDICINE\r\nOR CHILD WELFARE SERVICES1,2,3&quot;           </code></pre>
<p>We can use the <code>str_remove_all()</code> function, which is a variant of the <code>str_remove()</code> function of the <code>stringr</code> package. This allows us to remove all occurrences of specified characters in each row rather than just the first occurrence (which is what <code>str_remove()</code> does) to remove the digit values, the <code>\r\n</code> characters and the punctuation marks from the column called <code>MHS_setting</code>.</p>
<p>Using the <code>mutate()</code> function, we specify that we want to change this particular column and replace it with a version of this column that has removed characters that match digits, <code>r\n</code> or punctuation marks.</p>
<p>We need to specify that the character strings that should be used can be found in the <code>MHS_setting</code> column by using the <code>string =</code> argument and the patterns to find and remove are specified using the <code>pattern =</code> argument.</p>
<p>To allow us to look for all three of these patterns at the same time, we can use the <code>|</code> symbol between each pattern.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1">table11<span class="fl">.1</span>a <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="kw">mutate</span>(<span class="dt">MHS_setting =</span> </a>
<a class="sourceLine" id="cb51-3" data-line-number="3">         <span class="kw">str_remove_all</span>(<span class="dt">string =</span> MHS_setting, </a>
<a class="sourceLine" id="cb51-4" data-line-number="4">                        <span class="dt">pattern =</span> <span class="st">&quot;[:digit:]|</span><span class="ch">\r\n</span><span class="st">|[:punct:]|&quot;</span>))</a>
<a class="sourceLine" id="cb51-5" data-line-number="5"></a>
<a class="sourceLine" id="cb51-6" data-line-number="6"><span class="kw">head</span>(table11<span class="fl">.1</span>a)</a></code></pre></div>
<pre><code># A tibble: 6 x 18
  MHS_setting `2002` `2003` `2004` `2005` `2006` `2007` `2008` `2009` `2010`
  &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; 
1 SPECIALTY … 2,898a 3,065a 3,348a 3,362a 3,255a 3,104a 3,129a 2,925a 2,920a
2 Outpatient  2,662a 2,795a 3,015a 3,048a 2,931a 2,787a 2,837a 2,650a 2,635a
3 Private Th… 2,254a 2,347a 2,523a 2,573a 2,416a 2,365a 2,408a 2,296a 2,265a
4 Mental Hea… 611a   635a   716a   657a   587a   583a   567a   537a   547a  
5 Partial Da… 440    425    439    449    471    416    374a   340a   362a  
6 InHome The… 693a   656a   762a   731a   719a   707a   716a   657a   674a  
# … with 8 more variables: `2011` &lt;chr&gt;, `2012` &lt;chr&gt;, `2013` &lt;chr&gt;,
#   `2014` &lt;chr&gt;, `2015` &lt;chr&gt;, `2016` &lt;chr&gt;, `2017` &lt;chr&gt;, `2018` &lt;chr&gt;</code></pre>
<p>We also want to replace the spaces with a single space. We can see that sometimes there appears to be more than one space. We can specify that we want any occurrence of 1 or more to be replaced by using the <code>{1,}</code> notation.</p>
<p>See here for an explanation of this on the cheat sheet:</p>
<p><img src="img/quantifiers.png" width="90%" style="display: block; margin: auto;" /></p>
<p>So, we will use the <code>str_replace_all()</code> function of the <code>stringr</code> package. In this case, we also need to specify a replacement with the <code>replacement =</code> argument.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">table11<span class="fl">.1</span>a <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb53-2" data-line-number="2"><span class="kw">mutate</span>(<span class="dt">MHS_setting =</span> </a>
<a class="sourceLine" id="cb53-3" data-line-number="3">         <span class="kw">str_replace_all</span>(<span class="dt">string =</span> MHS_setting,</a>
<a class="sourceLine" id="cb53-4" data-line-number="4">                         <span class="dt">pattern =</span> <span class="st">&quot;[:blank:]{1,}&quot;</span>, </a>
<a class="sourceLine" id="cb53-5" data-line-number="5">                         <span class="dt">replacement =</span> <span class="st">&quot; &quot;</span>))</a>
<a class="sourceLine" id="cb53-6" data-line-number="6"></a>
<a class="sourceLine" id="cb53-7" data-line-number="7"><span class="kw">head</span>(table11<span class="fl">.1</span>a)</a></code></pre></div>
<pre><code># A tibble: 6 x 18
  MHS_setting `2002` `2003` `2004` `2005` `2006` `2007` `2008` `2009` `2010`
  &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; 
1 SPECIALTY … 2,898a 3,065a 3,348a 3,362a 3,255a 3,104a 3,129a 2,925a 2,920a
2 Outpatient  2,662a 2,795a 3,015a 3,048a 2,931a 2,787a 2,837a 2,650a 2,635a
3 Private Th… 2,254a 2,347a 2,523a 2,573a 2,416a 2,365a 2,408a 2,296a 2,265a
4 Mental Hea… 611a   635a   716a   657a   587a   583a   567a   537a   547a  
5 Partial Da… 440    425    439    449    471    416    374a   340a   362a  
6 InHome The… 693a   656a   762a   731a   719a   707a   716a   657a   674a  
# … with 8 more variables: `2011` &lt;chr&gt;, `2012` &lt;chr&gt;, `2013` &lt;chr&gt;,
#   `2014` &lt;chr&gt;, `2015` &lt;chr&gt;, `2016` &lt;chr&gt;, `2017` &lt;chr&gt;, `2018` &lt;chr&gt;</code></pre>
<p>Next, we will remove the “a” values and the commas from the body of the table using the <code>str_remove_all()</code> function yet again. However, this time to specify that we want all columns except the first column called <code>MHS_setting</code>, we can use the <code>across()</code> function of the <code>dplyr</code> package. This allows us to specify what columns we want to mutate by using the <code>.cols =</code> argument. We can select all columns except the first column called <code>MHS_setting</code> by using a minus sign <code>-</code> in front of the column name.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">table11<span class="fl">.1</span>a <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb55-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(dplyr<span class="op">::</span><span class="kw">across</span>(<span class="dt">.cols =</span> <span class="op">-</span>MHS_setting,</a>
<a class="sourceLine" id="cb55-3" data-line-number="3">                       stringr<span class="op">::</span>str_remove_all, <span class="st">&quot;a|,&quot;</span>))</a>
<a class="sourceLine" id="cb55-4" data-line-number="4"></a>
<a class="sourceLine" id="cb55-5" data-line-number="5"><span class="kw">head</span>(table11<span class="fl">.1</span>a)</a></code></pre></div>
<pre><code># A tibble: 6 x 18
  MHS_setting `2002` `2003` `2004` `2005` `2006` `2007` `2008` `2009` `2010`
  &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; 
1 SPECIALTY … 2898   3065   3348   3362   3255   3104   3129   2925   2920  
2 Outpatient  2662   2795   3015   3048   2931   2787   2837   2650   2635  
3 Private Th… 2254   2347   2523   2573   2416   2365   2408   2296   2265  
4 Mental Hea… 611    635    716    657    587    583    567    537    547   
5 Partial Da… 440    425    439    449    471    416    374    340    362   
6 InHome The… 693    656    762    731    719    707    716    657    674   
# … with 8 more variables: `2011` &lt;chr&gt;, `2012` &lt;chr&gt;, `2013` &lt;chr&gt;,
#   `2014` &lt;chr&gt;, `2015` &lt;chr&gt;, `2016` &lt;chr&gt;, `2017` &lt;chr&gt;, `2018` &lt;chr&gt;</code></pre>
<p>Our table is looking much better!</p>
<p>We also want to change our values to be numeric as opposed to character so that we can use them in mathematical functions. We can use the base <code>as.numeric()</code> function. Again we will use the <code>across()</code> function to indicate what variables we wish to mutate.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1">table11<span class="fl">.1</span>a <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb57-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="dt">.cols =</span><span class="op">-</span>MHS_setting, as.numeric))</a>
<a class="sourceLine" id="cb57-3" data-line-number="3"></a>
<a class="sourceLine" id="cb57-4" data-line-number="4"><span class="kw">head</span>(table11<span class="fl">.1</span>a)</a></code></pre></div>
<pre><code># A tibble: 6 x 18
  MHS_setting `2002` `2003` `2004` `2005` `2006` `2007` `2008` `2009` `2010`
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 SPECIALTY …   2898   3065   3348   3362   3255   3104   3129   2925   2920
2 Outpatient    2662   2795   3015   3048   2931   2787   2837   2650   2635
3 Private Th…   2254   2347   2523   2573   2416   2365   2408   2296   2265
4 Mental Hea…    611    635    716    657    587    583    567    537    547
5 Partial Da…    440    425    439    449    471    416    374    340    362
6 InHome The…    693    656    762    731    719    707    716    657    674
# … with 8 more variables: `2011` &lt;dbl&gt;, `2012` &lt;dbl&gt;, `2013` &lt;dbl&gt;,
#   `2014` &lt;dbl&gt;, `2015` &lt;dbl&gt;, `2016` &lt;dbl&gt;, `2017` &lt;dbl&gt;, `2018` &lt;dbl&gt;</code></pre>
<p>We would also like to add a <code>type</code> and <code>subtype</code> variable, that specifies the general categories of settings where services were received, as well as remove a couple of rows that are completely empty. These are the rows where the first column values are <code>General Medicine</code> and <code>Juvenile Justice</code>, and <code>Child Welfare</code>. If we look at the website, we can see that these were leading lines with no data.</p>
<p><img src="img/table11.1a.png" width="90%" style="display: block; margin: auto;" /></p>
<p>First, we will add the <code>type</code> and <code>subtype</code> variables using the <code>mutate</code> function.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1">table11<span class="fl">.1</span>a <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb59-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">type =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Specialty&quot;</span>, <span class="dv">9</span>), </a>
<a class="sourceLine" id="cb59-3" data-line-number="3">                  <span class="kw">rep</span>(<span class="st">&quot;Nonspecialty&quot;</span>, <span class="dv">11</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb59-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">subtype =</span> <span class="kw">c</span>(<span class="st">&quot;Specialty_total&quot;</span>, </a>
<a class="sourceLine" id="cb59-5" data-line-number="5">                     <span class="kw">rep</span>(<span class="st">&quot;Outpatient&quot;</span>, <span class="dv">5</span>), </a>
<a class="sourceLine" id="cb59-6" data-line-number="6">                     <span class="kw">rep</span>(<span class="st">&quot;Inpatient&quot;</span>, <span class="dv">3</span>), </a>
<a class="sourceLine" id="cb59-7" data-line-number="7">                     <span class="st">&quot;Nonspecialty_total&quot;</span>, </a>
<a class="sourceLine" id="cb59-8" data-line-number="8">                     <span class="kw">rep</span>(<span class="st">&quot;Education&quot;</span>, <span class="dv">3</span>), </a>
<a class="sourceLine" id="cb59-9" data-line-number="9">                     <span class="kw">rep</span>(<span class="st">&quot;General_medicine&quot;</span>, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb59-10" data-line-number="10">                     <span class="kw">rep</span>(<span class="st">&quot;Juvenile_Justice&quot;</span>, <span class="dv">2</span>), </a>
<a class="sourceLine" id="cb59-11" data-line-number="11">                     <span class="kw">rep</span>(<span class="st">&quot;Child_Welfare&quot;</span>, <span class="dv">2</span>), </a>
<a class="sourceLine" id="cb59-12" data-line-number="12">                     <span class="st">&quot;combination&quot;</span>))</a></code></pre></div>
<p>We also want to add a variable with shorter names for labels in plots and statistical output.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1">table11<span class="fl">.1</span>a <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb60-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">short_label =</span> <span class="kw">c</span>(<span class="st">&quot;Specialty total&quot;</span>, </a>
<a class="sourceLine" id="cb60-3" data-line-number="3">                         <span class="st">&quot;Outpatient total&quot;</span>, </a>
<a class="sourceLine" id="cb60-4" data-line-number="4">                         <span class="st">&quot;Therapist&quot;</span>, </a>
<a class="sourceLine" id="cb60-5" data-line-number="5">                         <span class="st">&quot;Clinic&quot;</span>, </a>
<a class="sourceLine" id="cb60-6" data-line-number="6">                         <span class="st">&quot;Day program&quot;</span>,</a>
<a class="sourceLine" id="cb60-7" data-line-number="7">                         <span class="st">&quot;In-home Therapist&quot;</span>, </a>
<a class="sourceLine" id="cb60-8" data-line-number="8">                         <span class="st">&quot;Inpatient total&quot;</span>, </a>
<a class="sourceLine" id="cb60-9" data-line-number="9">                         <span class="st">&quot;Hospital&quot;</span>, </a>
<a class="sourceLine" id="cb60-10" data-line-number="10">                         <span class="st">&quot;Residential Center&quot;</span>,</a>
<a class="sourceLine" id="cb60-11" data-line-number="11">                         <span class="st">&quot;Nonspecialty total&quot;</span>, </a>
<a class="sourceLine" id="cb60-12" data-line-number="12">                         <span class="st">&quot;School total&quot;</span>, </a>
<a class="sourceLine" id="cb60-13" data-line-number="13">                         <span class="st">&quot;School Therapist&quot;</span>, </a>
<a class="sourceLine" id="cb60-14" data-line-number="14">                         <span class="st">&quot;School Program&quot;</span>, </a>
<a class="sourceLine" id="cb60-15" data-line-number="15">                         <span class="st">&quot;General Medicine&quot;</span>,</a>
<a class="sourceLine" id="cb60-16" data-line-number="16">                         <span class="st">&quot;Family Dr&quot;</span>,</a>
<a class="sourceLine" id="cb60-17" data-line-number="17">                         <span class="st">&quot;Justice System&quot;</span>,</a>
<a class="sourceLine" id="cb60-18" data-line-number="18">                         <span class="st">&quot;Justice System&quot;</span>,</a>
<a class="sourceLine" id="cb60-19" data-line-number="19">                         <span class="st">&quot;Welfare&quot;</span>, </a>
<a class="sourceLine" id="cb60-20" data-line-number="20">                         <span class="st">&quot;Fostercare&quot;</span>, </a>
<a class="sourceLine" id="cb60-21" data-line-number="21">                         <span class="st">&quot;Specialty Combination&quot;</span>))</a></code></pre></div>
<p>We can remove the empty rows using the <code>filter()</code> function of the <code>dplyr</code> package. We can specify that we don’t want to keep these rows by using the <code>!=</code> not equal to operator.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1">table11<span class="fl">.1</span>a <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb61-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(MHS_setting <span class="op">!=</span><span class="st"> &quot;General_Medicine&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(MHS_setting <span class="op">!=</span><span class="st"> &quot;Juvenile_Justice&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-4" data-line-number="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(MHS_setting <span class="op">!=</span><span class="st"> &quot;Child_Welfare&quot;</span>)</a>
<a class="sourceLine" id="cb61-5" data-line-number="5"></a>
<a class="sourceLine" id="cb61-6" data-line-number="6"><span class="kw">head</span>(table11<span class="fl">.1</span>a)</a></code></pre></div>
<pre><code># A tibble: 6 x 21
  MHS_setting `2002` `2003` `2004` `2005` `2006` `2007` `2008` `2009` `2010`
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 SPECIALTY …   2898   3065   3348   3362   3255   3104   3129   2925   2920
2 Outpatient    2662   2795   3015   3048   2931   2787   2837   2650   2635
3 Private Th…   2254   2347   2523   2573   2416   2365   2408   2296   2265
4 Mental Hea…    611    635    716    657    587    583    567    537    547
5 Partial Da…    440    425    439    449    471    416    374    340    362
6 InHome The…    693    656    762    731    719    707    716    657    674
# … with 11 more variables: `2011` &lt;dbl&gt;, `2012` &lt;dbl&gt;, `2013` &lt;dbl&gt;,
#   `2014` &lt;dbl&gt;, `2015` &lt;dbl&gt;, `2016` &lt;dbl&gt;, `2017` &lt;dbl&gt;, `2018` &lt;dbl&gt;,
#   type &lt;chr&gt;, subtype &lt;chr&gt;, short_label &lt;chr&gt;</code></pre>
<p>Finally, we would like to change the shape of our table so that we have a new column that represents the year and a new column that represents the value for that year. To do so we will be making our table “longer”, meaning that it will have fewer columns and more rows. See <a href="https://en.wikipedia.org/wiki/Wide_and_narrow_data" target="_blank">here</a> for more information about different table formats, typically referred to as wide and long or sometimes narrow.</p>
<p>We will use the <code>pivot_longer()</code> function of the <code>tidyr</code> package to change the shape of our table.</p>
<p>There are 3 main arguments in this function:</p>
<ol style="list-style-type: decimal">
<li><code>cols</code> - which specifies what columns to collapse<br />
</li>
<li><code>names_to</code> - which specifies the name of the new column that will be created that will contain the column names of the columns you are collapsing<br />
</li>
<li><code>values_to</code> - which specifies the name of the new column that will be created that will contain the values from the columns you are collapsing</li>
</ol>
<p>To specify that we want to collapse all the columns that have year values, we can chose those that contain the string <code>&quot;20&quot;</code> using the <code>contains()</code> function of <code>dplyr</code>.</p>
<p>Finally, we will make the <code>Year</code> variable numeric as well.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1">table11<span class="fl">.1</span>a <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb63-2" data-line-number="2"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">contains</span>(<span class="st">&quot;20&quot;</span>), </a>
<a class="sourceLine" id="cb63-3" data-line-number="3">                      <span class="dt">names_to =</span> <span class="st">&quot;Year&quot;</span>,</a>
<a class="sourceLine" id="cb63-4" data-line-number="4">                      <span class="dt">values_to =</span> <span class="st">&quot;Number&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb63-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Year =</span> <span class="kw">as.numeric</span>(Year))</a>
<a class="sourceLine" id="cb63-6" data-line-number="6"></a>
<a class="sourceLine" id="cb63-7" data-line-number="7"><span class="kw">head</span>(table11<span class="fl">.1</span>a)</a></code></pre></div>
<pre><code># A tibble: 6 x 6
  MHS_setting                 type     subtype       short_label     Year Number
  &lt;chr&gt;                       &lt;chr&gt;    &lt;chr&gt;         &lt;chr&gt;          &lt;dbl&gt;  &lt;dbl&gt;
1 SPECIALTY MENTAL HEALTH SE… Special… Specialty_to… Specialty tot…  2002   2898
2 SPECIALTY MENTAL HEALTH SE… Special… Specialty_to… Specialty tot…  2003   3065
3 SPECIALTY MENTAL HEALTH SE… Special… Specialty_to… Specialty tot…  2004   3348
4 SPECIALTY MENTAL HEALTH SE… Special… Specialty_to… Specialty tot…  2005   3362
5 SPECIALTY MENTAL HEALTH SE… Special… Specialty_to… Specialty tot…  2006   3255
6 SPECIALTY MENTAL HEALTH SE… Special… Specialty_to… Specialty tot…  2007   3104</code></pre>
<p>We can see that our table is now much longer - as we have 340 rows!</p>
<div id="section-13" class="section level4 question_block">
<h4></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Why do we have 340 rows now?</p>
</div>
<div id="section-14" class="section level4">
<h4></h4>
<p>Now, we see that the <code>Year</code> and <code>Number</code> variables are of class double because of the <code>&lt;dbl&gt;</code> under the column name.</p>
<p>Let’s remind ourselves what the rest of the tables contain:</p>
<table>
<colgroup>
<col width="18%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th>Table</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Table 11.1A</td>
<td>Settings Where Mental Health Services Were Received in Past Year among Persons Aged 12 to 17: Numbers in Thousands, 2002-2018</td>
</tr>
<tr class="even">
<td>Table 11.1B</td>
<td>Settings Where Mental Health Services Were Received in Past Year among Persons Aged 12 to 17: Percentages, 2002-2018</td>
</tr>
<tr class="odd">
<td>Table 11.2A</td>
<td>Major Depressive Episode in Past Year among Persons Aged 12 to 17, by Demographic Characteristics: Numbers in Thousands, 2004-2018</td>
</tr>
<tr class="even">
<td>Table 11.2B</td>
<td>Major Depressive Episode in Past Year among Persons Aged 12 to 17, by Demographic Characteristics: Percentages, 2004-2018</td>
</tr>
<tr class="odd">
<td>Table 11.3A</td>
<td>Major Depressive Episode with Severe Impairment in Past Year among Persons Aged 12 to 17, by Demographic Characteristics: Numbers in Thousands, 2006-2018</td>
</tr>
<tr class="even">
<td>Table 11.3B</td>
<td>Major Depressive Episode with Severe Impairment in Past Year among Persons Aged 12 to 17, by Demographic Characteristics: Percentages, 2006-2018</td>
</tr>
<tr class="odd">
<td>Table 11.4A</td>
<td>Receipt of Treatment for Depression in Past Year among Persons Aged 12 to 17 with Major Depressive Episode in Past Year, by Demographic Characteristics: Numbers in Thousands, 2004-2018</td>
</tr>
<tr class="even">
<td>Table 11.4B</td>
<td>Receipt of Treatment for Depression in Past Year among Persons Aged 12 to 17 with Major Depressive Episode in Past Year, by Demographic Characteristics: Percentages, 2004-2018</td>
</tr>
</tbody>
</table>
<p>OK, so the next table (Table11.1B) is very similar to Table11.1A, while the remaining tables have information about demographics.</p>
<p>As a reminder here are all of the steps that we performed to wrangle <code>table11.1a</code>:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1">table11<span class="fl">.1</span>a <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb65-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-3" data-line-number="3"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span>(<span class="kw">n</span>()<span class="op">-</span><span class="dv">1</span>))<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-4" data-line-number="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">na_if</span>(<span class="st">&quot;nc&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-5" data-line-number="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">na_if</span>(<span class="st">&quot;--&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-6" data-line-number="6"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">na_if</span>(<span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-7" data-line-number="7"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">na_if</span>(<span class="st">&quot;*&quot;</span>)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-8" data-line-number="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">MHS_setting =</span> </a>
<a class="sourceLine" id="cb65-9" data-line-number="9">                  <span class="st">`</span><span class="dt">Setting Where Mental Health ServiceWas Received</span><span class="st">`</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">MHS_setting =</span> </a>
<a class="sourceLine" id="cb65-11" data-line-number="11">         <span class="kw">str_remove_all</span>(<span class="dt">string =</span> MHS_setting, </a>
<a class="sourceLine" id="cb65-12" data-line-number="12">                       <span class="dt">pattern =</span> <span class="st">&quot;[:digit:]|</span><span class="ch">\r\n</span><span class="st">|[:punct:]|&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">MHS_setting =</span> </a>
<a class="sourceLine" id="cb65-14" data-line-number="14">         <span class="kw">str_replace_all</span>(<span class="dt">string =</span> MHS_setting,</a>
<a class="sourceLine" id="cb65-15" data-line-number="15">                        <span class="dt">pattern =</span> <span class="st">&quot;[:blank:]{1,}&quot;</span>, </a>
<a class="sourceLine" id="cb65-16" data-line-number="16">                    <span class="dt">replacement =</span> <span class="st">&quot; &quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-17" data-line-number="17"><span class="st">  </span><span class="kw">mutate</span>(dplyr<span class="op">::</span><span class="kw">across</span>(<span class="dt">.cols =</span> <span class="op">-</span>MHS_setting,</a>
<a class="sourceLine" id="cb65-18" data-line-number="18">                stringr<span class="op">::</span>str_remove_all, <span class="st">&quot;a|,&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-19" data-line-number="19"><span class="st">  </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="op">-</span>MHS_setting, as.numeric)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-20" data-line-number="20"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">type =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Specialty&quot;</span>, <span class="dv">9</span>), <span class="kw">rep</span>(<span class="st">&quot;Nonspecialty&quot;</span>, <span class="dv">11</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-21" data-line-number="21"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">subtype =</span><span class="kw">c</span>(<span class="st">&quot;Specialty_total&quot;</span>, </a>
<a class="sourceLine" id="cb65-22" data-line-number="22">                    <span class="kw">rep</span>(<span class="st">&quot;Outpatient&quot;</span>, <span class="dv">5</span>), </a>
<a class="sourceLine" id="cb65-23" data-line-number="23">                    <span class="kw">rep</span>(<span class="st">&quot;Inpatient&quot;</span>, <span class="dv">3</span>), </a>
<a class="sourceLine" id="cb65-24" data-line-number="24">                    <span class="st">&quot;Nonspecialty_total&quot;</span>, </a>
<a class="sourceLine" id="cb65-25" data-line-number="25">                    <span class="kw">rep</span>(<span class="st">&quot;Education&quot;</span>, <span class="dv">3</span>), </a>
<a class="sourceLine" id="cb65-26" data-line-number="26">                    <span class="kw">rep</span>(<span class="st">&quot;General_medicine&quot;</span>, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb65-27" data-line-number="27">                    <span class="kw">rep</span>(<span class="st">&quot;Juvenile_Justice&quot;</span>, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb65-28" data-line-number="28">                    <span class="kw">rep</span>(<span class="st">&quot;Child_Welfare&quot;</span>, <span class="dv">2</span>), </a>
<a class="sourceLine" id="cb65-29" data-line-number="29">                    <span class="st">&quot;combination&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-30" data-line-number="30"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">short_label =</span> <span class="kw">c</span>(<span class="st">&quot;Specialty total&quot;</span>, <span class="st">&quot;Outpatient total&quot;</span>,</a>
<a class="sourceLine" id="cb65-31" data-line-number="31">                         <span class="st">&quot;Therapist&quot;</span>, <span class="st">&quot;Clinic&quot;</span>, <span class="st">&quot;Day program&quot;</span>, </a>
<a class="sourceLine" id="cb65-32" data-line-number="32">                         <span class="st">&quot;In-home Therapist&quot;</span>, <span class="st">&quot;Inpatient total&quot;</span>,</a>
<a class="sourceLine" id="cb65-33" data-line-number="33">                         <span class="st">&quot;Hospital&quot;</span>, <span class="st">&quot;Residential Center&quot;</span>,</a>
<a class="sourceLine" id="cb65-34" data-line-number="34">                         <span class="st">&quot;Nonspecialty total&quot;</span>, <span class="st">&quot;School total&quot;</span>, </a>
<a class="sourceLine" id="cb65-35" data-line-number="35">                         <span class="st">&quot;School Therapist&quot;</span>, <span class="st">&quot;School Program&quot;</span>, </a>
<a class="sourceLine" id="cb65-36" data-line-number="36">                         <span class="st">&quot;General Medicine&quot;</span>, <span class="st">&quot;Family Dr&quot;</span>, </a>
<a class="sourceLine" id="cb65-37" data-line-number="37">                         <span class="st">&quot;Justice System&quot;</span>, <span class="st">&quot;Justice System&quot;</span>,</a>
<a class="sourceLine" id="cb65-38" data-line-number="38">                         <span class="st">&quot;Welfare&quot;</span>, <span class="st">&quot;Fostercare&quot;</span>, </a>
<a class="sourceLine" id="cb65-39" data-line-number="39">                         <span class="st">&quot;Specialty Combination&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-40" data-line-number="40"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(MHS_setting <span class="op">!=</span><span class="st"> &quot;General_Medicine&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-41" data-line-number="41"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(MHS_setting <span class="op">!=</span><span class="st"> &quot;Juvenile_Justice&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-42" data-line-number="42"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(MHS_setting <span class="op">!=</span><span class="st"> &quot;Child_Welfare&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-43" data-line-number="43"><span class="st">    </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">contains</span>(<span class="st">&quot;20&quot;</span>), </a>
<a class="sourceLine" id="cb65-44" data-line-number="44">                    <span class="dt">names_to =</span> <span class="st">&quot;Year&quot;</span>,</a>
<a class="sourceLine" id="cb65-45" data-line-number="45">                   <span class="dt">values_to =</span> <span class="st">&quot;Number&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-46" data-line-number="46"><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">Year =</span> <span class="kw">as.numeric</span>(Year))</a></code></pre></div>
<p>Now we want to wrangle table11.1B which is formatted the most similarly. To do so we can simply run these steps on the using the <code>table11.1B</code> as the input. For the sake of education however, we will show you how you could make a function if we had several more similar tables to wrangle. This will also make it easier to write a function to wrangle the other demographic tables.</p>
<p>Last time we wrote a function in this case study, we only had one input in our function. This time we will have several inputs. We will have the table that we want to wrangle as <code>TABLE</code>, a new name for the first column called <code>new_col</code>, and an input called <code>pivot_col</code>, which will be the name of the column that will be created after pivoting that will take the values from each of the years.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1"><span class="cf">function</span>(TABLE, new_col, pivot_col){</a>
<a class="sourceLine" id="cb66-2" data-line-number="2">    <span class="op">&lt;</span>add code here<span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-3" data-line-number="3"><span class="st">  </span>}</a></code></pre></div>
<p>We want to make our function flexible so that it can take any value for the name of the first column. To select the first column we will use this following code, where the base <code>names()</code> function gets the column names of the <code>TABLE</code> input , which is indicated by the <code>.</code> and then to get just the first name the <code>[1]</code> is used.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1"><span class="cf">function</span>(TABLE, new_col, pivot_col){</a>
<a class="sourceLine" id="cb67-2" data-line-number="2">  dplyr<span class="op">::</span><span class="kw">as_tibble</span>(TABLE) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb67-3" data-line-number="3"><span class="st">  </span><span class="co">#additional steps</span></a>
<a class="sourceLine" id="cb67-4" data-line-number="4"><span class="st">  </span><span class="kw">names</span>(.)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb67-5" data-line-number="5">  <span class="co">#additional steps</span></a>
<a class="sourceLine" id="cb67-6" data-line-number="6">}</a></code></pre></div>
<p>And to rename the with the <code>new_col</code> input to the function we can do this:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1"><span class="cf">function</span>(TABLE, new_col, pivot_col){</a>
<a class="sourceLine" id="cb68-2" data-line-number="2">  dplyr<span class="op">::</span><span class="kw">as_tibble</span>(TABLE) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb68-3" data-line-number="3"><span class="st">  </span><span class="co">#additional steps</span></a>
<a class="sourceLine" id="cb68-4" data-line-number="4"><span class="st">  </span><span class="kw">rename</span>({{new_col}} <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">names</span>(.)[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb68-5" data-line-number="5">  <span class="co">#additional steps</span></a>
<a class="sourceLine" id="cb68-6" data-line-number="6">}</a></code></pre></div>
<p>The double curly brackets <code>{{}}</code> allow us to use the input to the function called <code>new_col</code> within the function.</p>
<p>See <a href="https://adv-r.hadley.nz/quasiquotation.html#tidy-dots" target="_blank">here</a> for information about the <code>:=</code> colon-equals operator. This operator is more flexible than the normal <code>=</code>. It allows expressions on both sides, thus it allows us to use an expression (the values for <code>new_col</code>) as the input value to the expressions that follow the <code>:=</code> operator.</p>
<p>We will also add code to remove all rows that have only <code>NA</code> values in a more flexible way, so that we don’t need to know what rows ahead of time.</p>
<p>To do this we will use the <code>filter()</code> and <code>select()</code> functions of the <code>dplyr</code> package.</p>
<p>We will calculate a sum of the count of <code>NA</code> values across the rows for the columns for each year using the base <code>rowSums()</code> function like so:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="kw">rowSums</span>(<span class="kw">is.na</span>(.))</a></code></pre></div>
<p>However to do this we first need to select only the columns that are numeric using: <code>select(., is.numeric)</code>, where the <code>.</code> refers to the table after all the previous wrangling steps in our function. Importantly of course, this all needs to happen after we convert the values for each year to numeric.</p>
<p>Anyway, altogether this looks like this:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1"><span class="kw">rowSums</span>(<span class="kw">is.na</span>(<span class="kw">select</span>(., is.numeric)))<span class="st">`</span><span class="dt">.</span></a></code></pre></div>
<p>Finally, we compare this to the number of columns that are numeric by using: <code>length(select(., is.numeric)))</code>, with the idea that if the number of <code>NA</code> values is less than the number of columns that could have <code>NA</code> values, then we know it is not an empty row.</p>
<p>Overall, this would look something like this after we perform a step to convert the columns to be numeric like we did before:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="cf">function</span>(TABLE, new_col, pivot_col){</a>
<a class="sourceLine" id="cb71-2" data-line-number="2">  <span class="co"># previous similar steps to modify and make table values numeric</span></a>
<a class="sourceLine" id="cb71-3" data-line-number="3">    <span class="kw">filter</span>(<span class="kw">rowSums</span>(<span class="kw">is.na</span>(<span class="kw">select</span>(., is.numeric))) <span class="op">&lt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb71-4" data-line-number="4"><span class="st">             </span><span class="kw">length</span>(<span class="kw">select</span>(., is.numeric))) </a>
<a class="sourceLine" id="cb71-5" data-line-number="5">  }</a></code></pre></div>
<p>Note that if we were using the <code>summarise()</code> or <code>mutate()</code> function or the <code>dplyr</code> package, then we could use the <code>across()</code> function of the <code>dplyr</code> package to select what columns we wanted to use in our calculation.</p>
<p>OK, so putting everything together from what we did previously for <code>table11.1a</code> and these new flexible steps we can create this function:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1">data_prep_settings &lt;-<span class="st"> </span><span class="cf">function</span>(TABLE, new_col, pivot_col){</a>
<a class="sourceLine" id="cb72-2" data-line-number="2">  dplyr<span class="op">::</span><span class="kw">as_tibble</span>(TABLE) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-3" data-line-number="3"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span>(<span class="kw">n</span>()<span class="op">-</span><span class="dv">1</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-4" data-line-number="4"><span class="st">  </span><span class="kw">na_if</span>(<span class="st">&quot;nc&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-5" data-line-number="5"><span class="st">  </span><span class="kw">na_if</span>(<span class="st">&quot;--&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-6" data-line-number="6"><span class="st">  </span><span class="kw">na_if</span>(<span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-7" data-line-number="7"><span class="st">  </span><span class="kw">na_if</span>(<span class="st">&quot;*&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-8" data-line-number="8"><span class="st">  </span><span class="kw">rename</span>({{new_col}} <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">names</span>(.)[<span class="dv">1</span>]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>({{new_col}} <span class="op">:</span><span class="er">=</span><span class="st"> </span></a>
<a class="sourceLine" id="cb72-10" data-line-number="10"><span class="st">         </span><span class="kw">str_remove_all</span>(<span class="dt">string =</span> <span class="kw">pull</span>(., {{new_col}}), </a>
<a class="sourceLine" id="cb72-11" data-line-number="11">                        <span class="dt">pattern =</span> <span class="st">&quot;[:digit:]|</span><span class="ch">\r\n</span><span class="st">|[:punct:]|&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>({{new_col}} <span class="op">:</span><span class="er">=</span><span class="st"> </span></a>
<a class="sourceLine" id="cb72-13" data-line-number="13"><span class="st">         </span><span class="kw">str_replace_all</span>(<span class="dt">string =</span><span class="kw">pull</span>(., {{new_col}}),</a>
<a class="sourceLine" id="cb72-14" data-line-number="14">                         <span class="dt">pattern =</span> <span class="st">&quot;[:blank:]{1,}&quot;</span>, </a>
<a class="sourceLine" id="cb72-15" data-line-number="15">                         <span class="dt">replacement =</span> <span class="st">&quot; &quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate</span>(dplyr<span class="op">::</span><span class="kw">across</span>(<span class="dt">.cols =</span> <span class="op">-</span>{{new_col}},</a>
<a class="sourceLine" id="cb72-17" data-line-number="17">                       stringr<span class="op">::</span>str_remove_all, <span class="st">&quot;a|,&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-18" data-line-number="18"><span class="st">  </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="op">-</span>{{new_col}}, as.numeric)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-19" data-line-number="19"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">type =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Specialty&quot;</span>, <span class="dv">9</span>), <span class="kw">rep</span>(<span class="st">&quot;Nonspecialty&quot;</span>, <span class="dv">11</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-20" data-line-number="20"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">subtype =</span> <span class="kw">c</span>(<span class="st">&quot;Specialty_total&quot;</span>,</a>
<a class="sourceLine" id="cb72-21" data-line-number="21">                    <span class="kw">rep</span>(<span class="st">&quot;Outpatient&quot;</span>, <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb72-22" data-line-number="22">                    <span class="kw">rep</span>(<span class="st">&quot;Inpatient&quot;</span>, <span class="dv">3</span>), </a>
<a class="sourceLine" id="cb72-23" data-line-number="23">                    <span class="st">&quot;Nonspecialty_total&quot;</span>, </a>
<a class="sourceLine" id="cb72-24" data-line-number="24">                    <span class="kw">rep</span>(<span class="st">&quot;Education&quot;</span>, <span class="dv">3</span>), </a>
<a class="sourceLine" id="cb72-25" data-line-number="25">                    <span class="kw">rep</span>(<span class="st">&quot;General_medicine&quot;</span>, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb72-26" data-line-number="26">                    <span class="kw">rep</span>(<span class="st">&quot;Juvenile_Justice&quot;</span>, <span class="dv">2</span>), </a>
<a class="sourceLine" id="cb72-27" data-line-number="27">                    <span class="kw">rep</span>(<span class="st">&quot;Child_Welfare&quot;</span>,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb72-28" data-line-number="28">                    <span class="st">&quot;combination&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-29" data-line-number="29"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">short_label =</span> <span class="kw">c</span>(<span class="st">&quot;Specialty total&quot;</span>, <span class="st">&quot;Outpatient total&quot;</span>,  </a>
<a class="sourceLine" id="cb72-30" data-line-number="30">                         <span class="st">&quot;Therapist&quot;</span>, <span class="st">&quot;Clinic&quot;</span>, <span class="st">&quot;Day program&quot;</span>, </a>
<a class="sourceLine" id="cb72-31" data-line-number="31">                         <span class="st">&quot;In-home Therapist&quot;</span>, <span class="st">&quot;Inpatient total&quot;</span>,</a>
<a class="sourceLine" id="cb72-32" data-line-number="32">                         <span class="st">&quot;Hospital&quot;</span>, <span class="st">&quot;Residential Center&quot;</span>,</a>
<a class="sourceLine" id="cb72-33" data-line-number="33">                         <span class="st">&quot;Nonspecialty total&quot;</span>, <span class="st">&quot;School total&quot;</span>, </a>
<a class="sourceLine" id="cb72-34" data-line-number="34">                         <span class="st">&quot;School Therapist&quot;</span>, <span class="st">&quot;School Program&quot;</span>, </a>
<a class="sourceLine" id="cb72-35" data-line-number="35">                         <span class="st">&quot;General Medicine&quot;</span>, <span class="st">&quot;Family Dr&quot;</span>, </a>
<a class="sourceLine" id="cb72-36" data-line-number="36">                         <span class="st">&quot;Justice System&quot;</span>, <span class="st">&quot;Justice System&quot;</span>, </a>
<a class="sourceLine" id="cb72-37" data-line-number="37">                         <span class="st">&quot;Welfare&quot;</span>, <span class="st">&quot;Fostercare&quot;</span>, </a>
<a class="sourceLine" id="cb72-38" data-line-number="38">                         <span class="st">&quot;Specialty Combination&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-39" data-line-number="39"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">rowSums</span>(<span class="kw">is.na</span>(<span class="kw">select</span>(., is.numeric))) <span class="op">&lt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb72-40" data-line-number="40"><span class="st">           </span><span class="kw">length</span>(<span class="kw">select</span>(., is.numeric))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-41" data-line-number="41"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">contains</span>(<span class="st">&quot;20&quot;</span>), </a>
<a class="sourceLine" id="cb72-42" data-line-number="42">           <span class="dt">names_to =</span> <span class="st">&quot;Year&quot;</span>, </a>
<a class="sourceLine" id="cb72-43" data-line-number="43">          <span class="dt">values_to =</span> pivot_col)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-44" data-line-number="44"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Year =</span> <span class="kw">as.numeric</span>(Year))</a>
<a class="sourceLine" id="cb72-45" data-line-number="45">}</a></code></pre></div>
<p>Now we can apply the function to <code>table11.1b</code>.</p>
</div>
</div>
<div id="table11.1b" class="section level3">
<h3><strong>Table11.1b</strong></h3>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1">table11<span class="fl">.1</span>b &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb73-2" data-line-number="2"><span class="st">  </span><span class="kw">data_prep_settings</span>(<span class="dt">TABLE =</span> table11<span class="fl">.1</span>b, </a>
<a class="sourceLine" id="cb73-3" data-line-number="3">                     <span class="dt">new_col =</span> <span class="st">&quot;MHS_setting&quot;</span>,</a>
<a class="sourceLine" id="cb73-4" data-line-number="4">                     <span class="dt">pivot_col =</span> <span class="st">&quot;Percent&quot;</span>)</a>
<a class="sourceLine" id="cb73-5" data-line-number="5"></a>
<a class="sourceLine" id="cb73-6" data-line-number="6"><span class="kw">head</span>(table11<span class="fl">.1</span>b)</a></code></pre></div>
<pre><code># A tibble: 6 x 6
  MHS_setting                type     subtype       short_label     Year Percent
  &lt;chr&gt;                      &lt;chr&gt;    &lt;chr&gt;         &lt;chr&gt;          &lt;dbl&gt;   &lt;dbl&gt;
1 SPECIALTY MENTAL HEALTH S… Special… Specialty_to… Specialty tot…  2002    11.8
2 SPECIALTY MENTAL HEALTH S… Special… Specialty_to… Specialty tot…  2003    12.4
3 SPECIALTY MENTAL HEALTH S… Special… Specialty_to… Specialty tot…  2004    13.4
4 SPECIALTY MENTAL HEALTH S… Special… Specialty_to… Specialty tot…  2005    13.4
5 SPECIALTY MENTAL HEALTH S… Special… Specialty_to… Specialty tot…  2006    13  
6 SPECIALTY MENTAL HEALTH S… Special… Specialty_to… Specialty tot…  2007    12.4</code></pre>
<p>Great!</p>
<p>What about the subsequent tables?</p>
</div>
<div id="demographic-tables" class="section level3">
<h3><strong>Demographic Tables</strong></h3>
<p>All of the rest of the tables have demographic information and have this general structure:</p>
<p><img src="img/dem_table.png" width="90%" style="display: block; margin: auto;" /></p>
<p>In these tables, we have age groups in our first column so we don’t want to remove digits or punctuation marks anymore so we need to modify our function a bit to remove that step.</p>
<p>We also want to add the word <code>Age</code> and an underscore in front of the age group listed in the tables. We can use the <code>str_replace()</code> function of the <code>stringr</code> package, because now we want to only replace the first instance of <code>1</code> with <code>Age_1</code>.</p>
<p>We will replace the first column name with <code>Demographic</code> for all of the tables.</p>
<p>We will create a new variable that list the subgroups.</p>
<p>We will also want to only wrangle the data up to the point that we change the shape of the data, so that we can check how the data looks first.</p>
<p>OK let’s put this all together into a <code>data_dem_settings()</code> function:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1">data_dem_settings &lt;-<span class="st"> </span><span class="cf">function</span>(TABLE){</a>
<a class="sourceLine" id="cb75-2" data-line-number="2">  dplyr<span class="op">::</span><span class="kw">as_tibble</span>(TABLE) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-3" data-line-number="3"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span>(<span class="kw">n</span>()<span class="op">-</span><span class="dv">1</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-4" data-line-number="4"><span class="st">  </span><span class="kw">na_if</span>(<span class="st">&quot;nc&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-5" data-line-number="5"><span class="st">  </span><span class="kw">na_if</span>(<span class="st">&quot;--&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-6" data-line-number="6"><span class="st">  </span><span class="kw">na_if</span>(<span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-7" data-line-number="7"><span class="st">  </span><span class="kw">na_if</span>(<span class="st">&quot;*&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-8" data-line-number="8"><span class="st">  </span><span class="kw">rename</span>(Demographic <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">names</span>(.)[<span class="dv">1</span>]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(Demographic <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">str_replace_all</span>(<span class="dt">string =</span> <span class="kw">pull</span>(., Demographic),</a>
<a class="sourceLine" id="cb75-10" data-line-number="10">                                        <span class="dt">pattern =</span> <span class="st">&quot;[:blank:]{1,}&quot;</span>, </a>
<a class="sourceLine" id="cb75-11" data-line-number="11">                                        <span class="dt">replacement =</span> <span class="st">&quot; &quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Demographic =</span> <span class="kw">str_replace</span>(<span class="dt">string =</span> Demographic, </a>
<a class="sourceLine" id="cb75-13" data-line-number="13">                                   <span class="dt">pattern =</span> <span class="st">&quot;1&quot;</span>, </a>
<a class="sourceLine" id="cb75-14" data-line-number="14">                                   <span class="dt">replacement =</span> <span class="st">&quot;Age_1&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-15" data-line-number="15"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">subgroup =</span> <span class="kw">c</span>(<span class="st">&quot;Total&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;Age&quot;</span>, <span class="dv">4</span>), </a>
<a class="sourceLine" id="cb75-16" data-line-number="16">                    <span class="kw">rep</span>(<span class="st">&quot;Sex&quot;</span>, <span class="dv">3</span>), <span class="kw">rep</span>(<span class="st">&quot;Race/Ethnicity&quot;</span>, <span class="dv">9</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-17" data-line-number="17"><span class="st">  </span><span class="kw">mutate</span>(dplyr<span class="op">::</span><span class="kw">across</span>(<span class="dt">.cols =</span> <span class="kw">contains</span>(<span class="st">&quot;20&quot;</span>),</a>
<a class="sourceLine" id="cb75-18" data-line-number="18">                       stringr<span class="op">::</span>str_remove_all, <span class="st">&quot;a|,&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-19" data-line-number="19"><span class="st">  </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">contains</span>(<span class="st">&quot;20&quot;</span>), as.numeric)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-20" data-line-number="20"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">rowSums</span>(<span class="kw">is.na</span>(<span class="kw">select</span>(., is.numeric))) <span class="op">&lt;</span><span class="st"> </span><span class="kw">length</span>(<span class="kw">select</span>(., is.numeric)))</a>
<a class="sourceLine" id="cb75-21" data-line-number="21">  }</a></code></pre></div>
<p>Now, we use the <code>data_dem_settings()</code> function to wrangle the next set of tables. We will also add a column to describe what the data are about which will be helpful for merging the data later.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1">table11<span class="fl">.2</span>a &lt;-<span class="st"> </span><span class="kw">data_dem_settings</span>(<span class="dt">TABLE =</span> table11<span class="fl">.2</span>a)</a>
<a class="sourceLine" id="cb76-2" data-line-number="2">table11<span class="fl">.2</span>a <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">data_type =</span> <span class="st">&quot;Major_Depressive_Episode&quot;</span>)</a>
<a class="sourceLine" id="cb76-3" data-line-number="3"><span class="kw">head</span>(table11<span class="fl">.2</span>a)</a></code></pre></div>
<pre><code># A tibble: 6 x 18
  Demographic `2004` `2005` `2006` `2007` `2008` `2009` `2010` `2011` `2012`
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 TOTAL         2225   2191   1970   2016   2027   1954   1911   2011   2213
2 Age_12-13      445    417    383    337    366    330    330    312    420
3 Age_14-15      783    811    684    705    706    741    706    710    844
4 Age_16-17      997    964    902    974    955    883    876    989    950
5 Male           637    571    539    586    540    577    536    566    581
6 Female        1588   1620   1431   1430   1487   1377   1375   1446   1632
# … with 8 more variables: `2013` &lt;dbl&gt;, `2014` &lt;dbl&gt;, `2015` &lt;dbl&gt;,
#   `2016` &lt;dbl&gt;, `2017` &lt;dbl&gt;, `2018` &lt;dbl&gt;, subgroup &lt;chr&gt;, data_type &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1">table11<span class="fl">.2</span>b &lt;-<span class="st"> </span><span class="kw">data_dem_settings</span>(<span class="dt">TABLE =</span> table11<span class="fl">.2</span>b)</a>
<a class="sourceLine" id="cb78-2" data-line-number="2">table11<span class="fl">.2</span>b <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">data_type =</span> <span class="st">&quot;Major_Depressive_Episode&quot;</span>)</a>
<a class="sourceLine" id="cb78-3" data-line-number="3"><span class="kw">head</span>(table11<span class="fl">.2</span>b)</a></code></pre></div>
<pre><code># A tibble: 6 x 18
  Demographic `2004` `2005` `2006` `2007` `2008` `2009` `2010` `2011` `2012`
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 TOTAL          9      8.8    7.9    8.2    8.3    8.1    8      8.2    9.1
2 Age_12-13      5.4    5.2    4.9    4.3    4.9    4.6    4.3    4.1    5.4
3 Age_14-15      9.2    9.5    7.9    8.4    8.5    8.8    9      8.6   10.2
4 Age_16-17     12.3   11.5   10.7   11.5   11.2   10.4   10.6   11.7   11.4
5 Male           5      4.5    4.2    4.6    4.3    4.7    4.4    4.5    4.7
6 Female        13.1   13.3   11.8   11.9   12.5   11.7   11.9   12.1   13.7
# … with 8 more variables: `2013` &lt;dbl&gt;, `2014` &lt;dbl&gt;, `2015` &lt;dbl&gt;,
#   `2016` &lt;dbl&gt;, `2017` &lt;dbl&gt;, `2018` &lt;dbl&gt;, subgroup &lt;chr&gt;, data_type &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1">table11<span class="fl">.3</span>a &lt;-<span class="st"> </span><span class="kw">data_dem_settings</span>(<span class="dt">TABLE =</span> table11<span class="fl">.3</span>a)</a>
<a class="sourceLine" id="cb80-2" data-line-number="2">table11<span class="fl">.3</span>a <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">data_type =</span> <span class="st">&quot;Severe_Major_Depressive_Episode&quot;</span>)</a>
<a class="sourceLine" id="cb80-3" data-line-number="3"><span class="kw">head</span>(table11<span class="fl">.3</span>a)</a></code></pre></div>
<pre><code># A tibble: 6 x 16
  Demographic `2006` `2007` `2008` `2009` `2010` `2011` `2012` `2013` `2014`
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 TOTAL         1358   1371   1460   1404   1350   1388   1544   1868   1990
2 Age_12-13      211    200    239    235    232    218    285    314    375
3 Age_14-15      518    500    505    521    479    487    590    752    707
4 Age_16-17      629    671    716    648    639    683    669    801    909
5 Male           335    386    359    391    395    397    373    435    461
6 Female        1023    986   1101   1013    954    991   1172   1432   1529
# … with 6 more variables: `2015` &lt;dbl&gt;, `2016` &lt;dbl&gt;, `2017` &lt;dbl&gt;,
#   `2018` &lt;dbl&gt;, subgroup &lt;chr&gt;, data_type &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1">table11<span class="fl">.3</span>b &lt;-<span class="st"> </span><span class="kw">data_dem_settings</span>(<span class="dt">TABLE =</span> table11<span class="fl">.3</span>b)</a>
<a class="sourceLine" id="cb82-2" data-line-number="2">table11<span class="fl">.3</span>b <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">data_type =</span> <span class="st">&quot;Severe_Major_Depressive_Episode&quot;</span>)</a>
<a class="sourceLine" id="cb82-3" data-line-number="3"><span class="kw">head</span>(table11<span class="fl">.3</span>b)</a></code></pre></div>
<pre><code># A tibble: 6 x 16
  Demographic `2006` `2007` `2008` `2009` `2010` `2011` `2012` `2013` `2014`
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 TOTAL          5.5    5.5    6      5.8    5.7    5.7    6.3    7.7    8.2
2 Age_12-13      2.7    2.5    3.2    3.2    3      2.8    3.7    4.1    4.9
3 Age_14-15      6      6      6.1    6.2    6.1    5.9    7.1    9.1    8.5
4 Age_16-17      7.5    7.9    8.4    7.7    7.7    8.1    8      9.7   10.9
5 Male           2.6    3      2.9    3.2    3.2    3.2    3      3.5    3.7
6 Female         8.4    8.2    9.3    8.6    8.2    8.3    9.8   12     13  
# … with 6 more variables: `2015` &lt;dbl&gt;, `2016` &lt;dbl&gt;, `2017` &lt;dbl&gt;,
#   `2018` &lt;dbl&gt;, subgroup &lt;chr&gt;, data_type &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1">table11<span class="fl">.4</span>a &lt;-<span class="st"> </span><span class="kw">data_dem_settings</span>(<span class="dt">TABLE =</span> table11<span class="fl">.4</span>a)</a>
<a class="sourceLine" id="cb84-2" data-line-number="2">table11<span class="fl">.4</span>a <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">data_type =</span> <span class="st">&quot;treatment&quot;</span>)</a>
<a class="sourceLine" id="cb84-3" data-line-number="3"><span class="kw">head</span>(table11<span class="fl">.4</span>a)</a></code></pre></div>
<pre><code># A tibble: 6 x 18
  Demographic `2004` `2005` `2006` `2007` `2008` `2009` `2010` `2011` `2012`
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 TOTAL          895    822    760    782    764    673    721    769    813
2 Age_12-13      169    136    133    137    122     98    106    112    127
3 Age_14-15      278    329    263    259    236    244    271    258    307
4 Age_16-17      448    357    364    386    405    331    343    400    379
5 Male           239    193    189    214    183    168    171    199    163
6 Female         656    629    571    568    581    505    549    570    650
# … with 8 more variables: `2013` &lt;dbl&gt;, `2014` &lt;dbl&gt;, `2015` &lt;dbl&gt;,
#   `2016` &lt;dbl&gt;, `2017` &lt;dbl&gt;, `2018` &lt;dbl&gt;, subgroup &lt;chr&gt;, data_type &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1">table11<span class="fl">.4</span>b &lt;-<span class="st"> </span><span class="kw">data_dem_settings</span>(<span class="dt">TABLE =</span> table11<span class="fl">.4</span>b)</a>
<a class="sourceLine" id="cb86-2" data-line-number="2">table11<span class="fl">.4</span>b <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">data_type =</span> <span class="st">&quot;treatment&quot;</span>)</a>
<a class="sourceLine" id="cb86-3" data-line-number="3"><span class="kw">head</span>(table11<span class="fl">.4</span>b)</a></code></pre></div>
<pre><code># A tibble: 6 x 18
  Demographic `2004` `2005` `2006` `2007` `2008` `2009` `2010` `2011` `2012`
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 TOTAL         40.3   37.8   38.8   39     37.7   34.6   37.8   38.4   37  
2 Age_12-13     38.2   32.9   35.1   41.5   33.5   30     32.5   36.3   30.7
3 Age_14-15     35.5   41.1   38.4   36.8   33.6   33.2   38.4   36.3   36.6
4 Age_16-17     45     37.1   40.7   39.8   42.4   37.5   39.3   40.5   40  
5 Male          37.7   34.1   35.3   36.7   34     29.2   32     35.3   28.3
6 Female        41.3   39     40.2   40     39.1   36.9   40.1   39.5   40.1
# … with 8 more variables: `2013` &lt;dbl&gt;, `2014` &lt;dbl&gt;, `2015` &lt;dbl&gt;,
#   `2016` &lt;dbl&gt;, `2017` &lt;dbl&gt;, `2018` &lt;dbl&gt;, subgroup &lt;chr&gt;, data_type &lt;chr&gt;</code></pre>
<p>Great! All of the demographic tables look good.</p>
<p>Next, let’s combine the count data (the “a” tables) and the percent data (the “b” tables) using the <code>bind_rows()</code> function of the <code>dplyr</code> package, which will append each of the subsequent tables together.</p>
<p>We can use the <code>distinct()</code> function of the <code>dplyr</code> package to check that we indeed have all the data types now in these larger tibbles.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1">counts &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(table11<span class="fl">.2</span>a, table11<span class="fl">.3</span>a, table11<span class="fl">.4</span>a)</a>
<a class="sourceLine" id="cb88-2" data-line-number="2">percents &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(table11<span class="fl">.2</span>b, table11<span class="fl">.3</span>b, table11<span class="fl">.4</span>b)</a>
<a class="sourceLine" id="cb88-3" data-line-number="3"></a>
<a class="sourceLine" id="cb88-4" data-line-number="4">counts <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">distinct</span>(data_type)</a></code></pre></div>
<pre><code># A tibble: 3 x 1
  data_type                      
  &lt;chr&gt;                          
1 Major_Depressive_Episode       
2 Severe_Major_Depressive_Episode
3 treatment                      </code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1">percents <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">distinct</span>(data_type)</a></code></pre></div>
<pre><code># A tibble: 3 x 1
  data_type                      
  &lt;chr&gt;                          
1 Major_Depressive_Episode       
2 Severe_Major_Depressive_Episode
3 treatment                      </code></pre>
<p>Great!</p>
<p>Now we will reformat both the <code>counts</code> and <code>percents</code> data to be in the long format using <code>pivot_longer()</code> once again.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1">counts <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb92-2" data-line-number="2"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">contains</span>(<span class="st">&quot;20&quot;</span>), </a>
<a class="sourceLine" id="cb92-3" data-line-number="3">               <span class="dt">names_to =</span> <span class="st">&quot;Year&quot;</span>, </a>
<a class="sourceLine" id="cb92-4" data-line-number="4">               <span class="dt">values_to =</span> <span class="st">&quot;Number&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb92-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Year =</span> <span class="kw">as.numeric</span>(Year))</a>
<a class="sourceLine" id="cb92-6" data-line-number="6"></a>
<a class="sourceLine" id="cb92-7" data-line-number="7">percents <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb92-8" data-line-number="8"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">contains</span>(<span class="st">&quot;20&quot;</span>), </a>
<a class="sourceLine" id="cb92-9" data-line-number="9">               <span class="dt">names_to =</span> <span class="st">&quot;Year&quot;</span>, </a>
<a class="sourceLine" id="cb92-10" data-line-number="10">               <span class="dt">values_to =</span> <span class="st">&quot;Percent&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb92-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Year =</span> <span class="kw">as.numeric</span>(Year))</a></code></pre></div>
<p>We finished wrangling the data and we are ready to proceed with our analysis.</p>
</div>
</div>
<div id="data-visualization" class="section level2">
<h2><strong>Data Visualization</strong></h2>
<hr />
<p>In this section, we will create some data visualizations to explore our data and questions of interest:</p>
<div id="section-15" class="section level4 main_question_block">
<h4></h4>
<p><b><u> Our main questions: </u></b></p>
<ol style="list-style-type: decimal">
<li>How have depression rates in American youth changed since 2004, according to the NSDUH data? How have rates differed between different youth subgroups (age, gender, ethnicity)?</li>
<li>Do mental health services appear to be reaching more youths? Again, how have rates differed between different youth subgroups (age, gender, ethnicity)?</li>
</ol>
</div>
<div id="section-16" class="section level4">
<h4></h4>
<p>We are going to use the <code>ggplot2</code> package to create our plots.</p>
<hr />
<details>
<p><summary> Click here for an introduction about this package if you are new to using <code>ggplot2</code> </summary></p>
<p>The <a href="http://ggplot2.tidyverse.org">ggplot2 package</a> is generally intuitive for beginners because it is based on a <a href="http://vita.had.co.nz/papers/layered-grammar.html">grammar of graphics</a> or the <code>gg</code> in <code>ggplot2</code>. The idea is that you can construct many sentences by learning just a few nouns, adjectives, and verbs. There are specific “words” that we will need to learn and once we do, you will be able to create (or “write”) hundreds of different plots.</p>
<p>The critical part to making graphics using <code>ggplot2</code> is the data needs to be in a <em>tidy</em> format. Given that we have just spent time putting our data in <em>tidy</em> format, we are primed to take advantage of all that <code>ggplot2</code> has to offer!</p>
<p>We will show how it is easy to pipe <em>tidy</em> data (output) as input to other functions that create plots. This all works because we are working within the <em>tidyverse</em>.</p>
<p><strong>What is the <code>ggplot()</code> function?</strong> As explained by Hadley Wickham:</p>
<blockquote>
<p>The grammar tells us that a statistical graphic is a mapping from data to aesthetic attributes (colour, shape, size) of geometric objects (points, lines, bars). The plot may also contain statistical transformations of the data and is drawn on a specific coordinates system.</p>
</blockquote>
<p><code>ggplot2</code> Terminology:</p>
<ul>
<li><strong>ggplot</strong> - the main function where you specify the dataset and variables to plot (this is where we define the <code>x</code> and <code>y</code> variable names)</li>
<li><strong>geoms</strong> - geometric objects
<ul>
<li>e.g. <code>geom_point()</code>, <code>geom_bar()</code>, <code>geom_line()</code>, <code>geom_histogram()</code></li>
</ul></li>
<li><strong>aes</strong> - aesthetics
<ul>
<li>shape, transparency, color, fill, line types</li>
</ul></li>
<li><strong>scales</strong> - define how your data will be plotted
<ul>
<li>continuous, discrete, log, etc</li>
</ul></li>
</ul>
<p>The function <code>aes()</code> is an aesthetic mapping function inside the <code>ggplot()</code> object. We use this function to specify plot attributes (e.g. <code>x</code> and <code>y</code> variable names) that will not change as we add more layers.</p>
<p>Anything that goes in the <code>ggplot()</code> object becomes a global setting. From there, we use the <code>geom</code> objects to add more layers to the base <code>ggplot()</code> object. These will define what we are interested in illustrating using the data.</p>
</details>
<hr />
</div>
<div id="mde-across-time" class="section level3">
<h3>MDE across time</h3>
<p>We will start by taking a look at the rate of major depressive episodes (MDE) among youths across time in various demographic groups. For this we will use the <code>percents</code> dataset that we wrangled in the section above.</p>
<p>OK, we will start out by using the <code>ggplot()</code> function to specify what data we would like to plot on each axis. We will also indicate that would like to use the <code>Demographic</code> variable in our dataset to group our data and to color our data. This is our first layer of the plot, thus for subsequent layers we need to use a plus sign <code>+</code>.</p>
<p>Next, we will use the <code>geom_line()</code> function of the <code>ggplot2</code> package to specify that we would like to create a line plot.</p>
<p>Then, we will add labels for the title and subtitle using the <code>labs()</code> function of the <code>ggplot2</code> package.</p>
<p>Finally, we will move our legend to the bottom of the plot using the <code>theme()</code> function which helps us control various details about our plot.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1">percents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb93-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;Major_Depressive_Episode&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb93-3" data-line-number="3"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, </a>
<a class="sourceLine" id="cb93-4" data-line-number="4">                      <span class="dt">color =</span> Demographic)) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-5" data-line-number="5"><span class="st">      </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-6" data-line-number="6"><span class="st">      </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Major Depressive Episode among Persons Aged 12 to 17&quot;</span>,</a>
<a class="sourceLine" id="cb93-7" data-line-number="7">           <span class="dt">subtitle =</span> <span class="st">&quot;By Demographic Characteristics, Percentages, 2004-2018&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-71-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>This plot is very difficult to read because there are so many groups. Now let’s look at just the total across time. We can do so by first filtering our data for <code>TOTAL</code> values.</p>
<p>It would also BE nice to include every year in the x-axis. We can do so by using the <code>scale_x_continuous()</code> function which gives us greater control about how the x-axis is displayed.</p>
<p>Finally, we will drop the legend since we will only have one group using <code>legend.position = &quot;none&quot;</code> and we can change the angle of the x-axis text using <code>axis.text.x = element_text(angle = 90)</code> within the <code>theme()</code> function.</p>
<p>We will also make the line thicker using the <code>size =</code> argument for the <code>geom_line()</code> function.</p>
<p>The <code>theme_linedraw()</code> function changes the aesthetics of the plot. See <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" target="_blank">here</a> for a list of options.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1">MDE_total &lt;-</a>
<a class="sourceLine" id="cb94-2" data-line-number="2"><span class="st">  </span>percents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;Major_Depressive_Episode&quot;</span>, </a>
<a class="sourceLine" id="cb94-4" data-line-number="4">         Demographic <span class="op">==</span><span class="st"> &quot;TOTAL&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, <span class="dt">color =</span> Demographic)) <span class="op">+</span></a>
<a class="sourceLine" id="cb94-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Demographic), <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb94-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb94-8" data-line-number="8">                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb94-9" data-line-number="9">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2004</span>, <span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb94-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Percent of Persons Aged 12 to 17 Reporting Having a </span><span class="ch">\n</span><span class="st"> Major Depressive Episode in the Past Year &quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb94-11" data-line-number="11"><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb94-12" data-line-number="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>),</a>
<a class="sourceLine" id="cb94-13" data-line-number="13">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) </a>
<a class="sourceLine" id="cb94-14" data-line-number="14"></a>
<a class="sourceLine" id="cb94-15" data-line-number="15">MDE_total</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-72-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can see that there is a steep increase after around 2011!</p>
<p>Let’s add a different background color for the years since 2011. We can do so by adding a <code>geom_rect()</code> layer before we plot the line. We just need to specify the location of the rectangle on our plot.</p>
<p>We also use the <code>theme_classic()</code> theme and we will add a facet using the <code>facet_wrap()</code> function to add strip of text to the top of the plot to tell more about what is contained within the plot. This function is typically used to create subplots which we will demonstrate next.</p>
<p>We want to change the value <code>TOTAL</code> of the <code>Demographic varaible</code> to <code>&quot;Percent of respondants with MDE&quot;</code> so that the text in the strip above the plot shows this instead. We can do so by using the <code>recode()</code> function of the <code>dplyr</code> package.</p>
<p>We will also change the color of the line using the <code>scale_color_manual()</code> function of the <code>ggplot2</code> package.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1">MDE_total &lt;-</a>
<a class="sourceLine" id="cb95-2" data-line-number="2"><span class="st">  </span>percents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb95-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;Major_Depressive_Episode&quot;</span>, </a>
<a class="sourceLine" id="cb95-4" data-line-number="4">         Demographic <span class="op">==</span><span class="st"> &quot;TOTAL&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb95-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Demographic =</span> <span class="kw">recode</span>(Demographic, </a>
<a class="sourceLine" id="cb95-6" data-line-number="6">             <span class="st">&quot;TOTAL&quot;</span> =<span class="st"> &quot;Percent of respondents with MDE&quot;</span>))<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb95-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, <span class="dt">group =</span> Demographic)) <span class="op">+</span></a>
<a class="sourceLine" id="cb95-8" data-line-number="8"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Demographic)<span class="op">+</span></a>
<a class="sourceLine" id="cb95-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="dv">2011</span>, <span class="dt">xmax =</span> <span class="ot">Inf</span>,  </a>
<a class="sourceLine" id="cb95-10" data-line-number="10">            <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>,  </a>
<a class="sourceLine" id="cb95-11" data-line-number="11">            <span class="dt">fill =</span> <span class="st">&quot;light gray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb95-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Demographic), <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb95-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb95-14" data-line-number="14">                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb95-15" data-line-number="15">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2004</span>, <span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb95-16" data-line-number="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;The Rate of Youths Aged 12 to 17 Reporting Having a </span><span class="ch">\n</span><span class="st"> Major Depressive Episode (MDE) is Increasing&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb95-17" data-line-number="17"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb95-18" data-line-number="18"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>),</a>
<a class="sourceLine" id="cb95-19" data-line-number="19">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb95-20" data-line-number="20">       <span class="dt">strip.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span><span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb95-21" data-line-number="21">             <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, </a>
<a class="sourceLine" id="cb95-22" data-line-number="22">                                       <span class="dt">size =</span> <span class="dv">14</span>, </a>
<a class="sourceLine" id="cb95-23" data-line-number="23">                                      <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb95-24" data-line-number="24"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>))</a>
<a class="sourceLine" id="cb95-25" data-line-number="25"></a>
<a class="sourceLine" id="cb95-26" data-line-number="26">MDE_total</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-73-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div id="section-17" class="section level4 question_block">
<h4></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>What do you expect will happen when if we had used the <code>+</code> symbol to add the <code>geom_rect()</code> function with <code>MDE_total</code> like so? Is that what you anticipated? Why or why not?</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1">MDE_total <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb96-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="dv">2011</span>, <span class="dt">xmax =</span> <span class="ot">Inf</span>,  </a>
<a class="sourceLine" id="cb96-3" data-line-number="3">            <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>,  </a>
<a class="sourceLine" id="cb96-4" data-line-number="4">            <span class="dt">fill =</span> <span class="st">&quot;light gray&quot;</span>)</a></code></pre></div>
</div>
<div id="section-18" class="section level4">
<h4></h4>
<p>We can create a theme for our future similar ggplots like so:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1">overview_theme &lt;-<span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb97-2" data-line-number="2">  <span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb97-3" data-line-number="3"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>),</a>
<a class="sourceLine" id="cb97-4" data-line-number="4">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb97-5" data-line-number="5">       <span class="dt">strip.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span><span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb97-6" data-line-number="6">             <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, </a>
<a class="sourceLine" id="cb97-7" data-line-number="7">                                       <span class="dt">size =</span> <span class="dv">14</span>, </a>
<a class="sourceLine" id="cb97-8" data-line-number="8">                                      <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>))</a>
<a class="sourceLine" id="cb97-9" data-line-number="9">  }</a></code></pre></div>
<p>Now let’s look at group differences.</p>
<p>To make sure our plot is not too overwhelming, let’s limit to only age and sex subgroups. Thus, we will filter out the data about totals and different racial/ethnic groups for now. We will also use the <code>facet_wrap()</code> function to make subplots based on the demographic categories, which we put in a variable called <code>subgroups</code> earlier when we wrangled the data.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1">MDE_age_sex &lt;-percents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;Major_Depressive_Episode&quot;</span>, </a>
<a class="sourceLine" id="cb98-3" data-line-number="3">         subgroup <span class="op">!=</span><span class="st"> &quot;Race/Ethnicity&quot;</span>, </a>
<a class="sourceLine" id="cb98-4" data-line-number="4">         Demographic <span class="op">!=</span><span class="st"> &quot;TOTAL&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, <span class="dt">color =</span> Demographic)) <span class="op">+</span></a>
<a class="sourceLine" id="cb98-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Demographic), <span class="dt">size =</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb98-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb98-8" data-line-number="8">                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb98-9" data-line-number="9">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2004</span>, <span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb98-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Major Depressive Episode</span><span class="ch">\n</span><span class="st">among Persons Aged 12 to 17&quot;</span>,</a>
<a class="sourceLine" id="cb98-11" data-line-number="11">       <span class="dt">subtitle =</span> <span class="st">&quot;By Demographic Characteristics, Percentages, 2004-2018&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb98-12" data-line-number="12"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>subgroup)<span class="op">+</span></a>
<a class="sourceLine" id="cb98-13" data-line-number="13"><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb98-14" data-line-number="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb98-15" data-line-number="15">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) </a>
<a class="sourceLine" id="cb98-16" data-line-number="16"></a>
<a class="sourceLine" id="cb98-17" data-line-number="17">MDE_age_sex</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-76-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Nice! Now it is much easier to tell how each group has changed over time.</p>
<p>We can also add labels directly to the lines using the <code>directlabels</code> package. There are several methods to do so. See <a href="http://directlabels.r-forge.r-project.org/docs/index.html" target="_blank">here</a> for more information about the options for adding labels with this package.<br />
We use the <code>&quot;far.from.others.borders&quot;</code> method so that our labels do not overlap one another. We also use <code>dl.trans()</code> of the <code>directlabels</code> package to move the labels slightly upward (<code>y = y +0.35</code>) and to the left (<code>x = x -0.1</code>). The <code>dl.move()</code> function of the <code>directlabels</code> package is used to move one of the labels to a particular location.</p>
<p>Note: the dl.move functions are set up for the rendering the rmarkdown - so if you are viewing the case study from RStudio the labels will overlap.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1">directlabels<span class="op">::</span><span class="kw">direct.label</span>(</a>
<a class="sourceLine" id="cb99-2" data-line-number="2">  MDE_age_sex, </a>
<a class="sourceLine" id="cb99-3" data-line-number="3">  <span class="kw">list</span>(<span class="kw">dl.trans</span>(<span class="dt">y =</span> y <span class="op">+</span><span class="st"> </span><span class="fl">0.38</span>, <span class="dt">x =</span> x <span class="fl">-0.1</span>), </a>
<a class="sourceLine" id="cb99-4" data-line-number="4">       <span class="st">&quot;far.from.others.borders&quot;</span>,</a>
<a class="sourceLine" id="cb99-5" data-line-number="5">       <span class="dt">cex =</span> <span class="fl">.8</span>, </a>
<a class="sourceLine" id="cb99-6" data-line-number="6">       <span class="kw">dl.move</span>(<span class="st">&quot;Age_14-15&quot;</span>, <span class="dt">x =</span> <span class="dv">2008</span>, <span class="dt">y =</span> <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb99-7" data-line-number="7">  )</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-77-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>This looks very clear now!</p>
<p>We can see that the majority of individuals that reported experiencing a major depressive episode in the past year were in an older age bracket (16-17 compared to 12-13). We can also see that the trend has been increasing for all three age brackets since roughly 2011.</p>
<p>We can also see an increase for both sexes since about 2011, but there is a steeper increase for females. Furthermore, females have a much higher rate than males across all years.</p>
<p>Let’s make the same plot with a different shaded background for the years of the increase like we did for the total plot.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1">MDE_age_sex &lt;-</a>
<a class="sourceLine" id="cb100-2" data-line-number="2"><span class="st">  </span>percents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb100-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;Major_Depressive_Episode&quot;</span>, </a>
<a class="sourceLine" id="cb100-4" data-line-number="4">         subgroup <span class="op">!=</span><span class="st"> &quot;Race/Ethnicity&quot;</span>, </a>
<a class="sourceLine" id="cb100-5" data-line-number="5">         Demographic <span class="op">!=</span><span class="st"> &quot;TOTAL&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb100-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, <span class="dt">group =</span> Demographic)) <span class="op">+</span></a>
<a class="sourceLine" id="cb100-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="dv">2011</span>, <span class="dt">xmax =</span> <span class="ot">Inf</span>,  </a>
<a class="sourceLine" id="cb100-8" data-line-number="8">            <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>,  </a>
<a class="sourceLine" id="cb100-9" data-line-number="9">            <span class="dt">fill =</span> <span class="st">&quot;light gray&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb100-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Demographic), <span class="dt">size =</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb100-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb100-12" data-line-number="12">                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb100-13" data-line-number="13">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2004</span>, <span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb100-14" data-line-number="14"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Major Depressive Episode</span><span class="ch">\n</span><span class="st">among Persons Aged 12 to 17&quot;</span>,</a>
<a class="sourceLine" id="cb100-15" data-line-number="15">       <span class="dt">subtitle =</span> <span class="st">&quot;By Demographic Characteristics, Percentages, 2004-2018&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb100-16" data-line-number="16"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>subgroup) <span class="op">+</span></a>
<a class="sourceLine" id="cb100-17" data-line-number="17"><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb100-18" data-line-number="18"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb100-19" data-line-number="19">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) </a>
<a class="sourceLine" id="cb100-20" data-line-number="20"></a>
<a class="sourceLine" id="cb100-21" data-line-number="21">MDE_age_sex &lt;-<span class="st"> </span><span class="kw">direct.label</span>(</a>
<a class="sourceLine" id="cb100-22" data-line-number="22">  MDE_age_sex, </a>
<a class="sourceLine" id="cb100-23" data-line-number="23">  <span class="kw">list</span>(<span class="kw">dl.trans</span>(<span class="dt">y =</span> y <span class="fl">+0.38</span>, <span class="dt">x =</span> x <span class="fl">-0.2</span>), </a>
<a class="sourceLine" id="cb100-24" data-line-number="24">       <span class="st">&quot;far.from.others.borders&quot;</span>, </a>
<a class="sourceLine" id="cb100-25" data-line-number="25">       <span class="dt">cex =</span> <span class="fl">.8</span>,</a>
<a class="sourceLine" id="cb100-26" data-line-number="26">       <span class="kw">dl.move</span>(<span class="st">&quot;Age_14-15&quot;</span>, <span class="dt">x =</span> <span class="dv">2008</span>, <span class="dt">y =</span><span class="dv">10</span>))</a>
<a class="sourceLine" id="cb100-27" data-line-number="27">  )</a>
<a class="sourceLine" id="cb100-28" data-line-number="28">MDE_age_sex</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-78-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>In the next section, we will formally test whether <code>Sex</code> is independent of the differences in rates of MDE across time.</p>
<p>whether there is a statistically significant difference between the expected frequencies and the observed frequencies in one or more categories of a contingency table.</p>
<p>While, it is very intriguing that there is an increase around 2011, we do not go into details here as to why that might be happening. However, we summarize a few articles that did investigate increased depression rates.</p>
<hr />
<details>
<p><summary> Click here for a summary on a few articles investigating increased depression rates. </summary></p>
<p>This cross-cultural <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3330161/" target="_blank">review article</a> published in 2012 suggests that aspects related to life-style due to modernity may be causing increased depression rates:</p>
<blockquote>
<p>Modern populations are increasingly overfed, malnourished, sedentary, sunlight-deficient, sleep-deprived, and socially-isolated. These changes in lifestyle each contribute to poor physical health and affect the incidence and treatment of depression.</p>
</blockquote>
<p>And although this may be true globally, the US has been arguably experiencing these modern lifestyle changes for years prior to this steep increase in 2011.</p>
<p>So what might have happened in the US around this time?</p>
<p>There is large amount of literature about how the use of smart phone and social media may have lead to increased depression rates. See this <a href="https://childmind.org/article/is-social-media-use-causing-depression/" target="_blank">article</a> which links to many scientific articles on the subject.</p>
<p>This has been a controversial topic due to conflicting findings, likely due to focus on different sites and aspects of social media across different studies.</p>
<p>The article points out that the true relationship between social media use and depression may be nuanced. Some individuals who have high face-to-face levels of interaction or lack of the opportunity to interact with others face-to-face (due to various barriers like geography), may actually experience lower risk for depression with more social media use.</p>
<p>Furthermore, different social media platforms may vary for their influence on depression.</p>
<p>Instagram was released in 2010 (which is around when our plot starts to show the upward increase in major depressive episodes, particularly in females) and according to the article:</p>
<blockquote>
<p>Image-driven Instagram shows up in surveys as the platform that most leads young people to report feeling anxiety, depression and worries about body image.</p>
</blockquote>
<p>Furthermore, it may be secondary effects of social media use, like less physical activity or less sleep that may increase the risk for depression.</p>
</details>
<hr />
<p>Next, let’s take a look at how the rate of major depressive episodes has changed across time for different racial/ethnic groups.</p>
<p>Since we have so many groups, we probably don’t want to directly label the lines this time. Instead, we will rely on the legend that will be automatically created.</p>
<p>We will use the the <code>fct_reorder()</code> function of the <code>forcats</code> package to order the racial/ethnic groups in the legend based on the last value (using <code>tail()</code>) of the <code>Percent</code> variable.</p>
<p>We will also manually color our lines based on a color palette called <a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html" target="_blank">viridis</a>, which is more discernible for individuals with color-blindness. To do so we will use the <code>scale_color_viridis_d()</code> function of the <code>ggplot2</code> package, which is intended for coloring discrete values.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1">MDE_race &lt;-</a>
<a class="sourceLine" id="cb101-2" data-line-number="2"><span class="st">  </span>percents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb101-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;Major_Depressive_Episode&quot;</span>, </a>
<a class="sourceLine" id="cb101-4" data-line-number="4">         subgroup <span class="op">==</span><span class="st"> &quot;Race/Ethnicity&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb101-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Demographic =</span> </a>
<a class="sourceLine" id="cb101-6" data-line-number="6">           <span class="kw">fct_reorder</span>(Demographic, Percent, </a>
<a class="sourceLine" id="cb101-7" data-line-number="7">                       tail, <span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">.desc =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb101-8" data-line-number="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, <span class="dt">group =</span> Demographic)) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-9" data-line-number="9"><span class="st">    </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="dv">2011</span>, <span class="dt">xmax =</span> <span class="ot">Inf</span>,   </a>
<a class="sourceLine" id="cb101-10" data-line-number="10">              <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>,   </a>
<a class="sourceLine" id="cb101-11" data-line-number="11">              <span class="dt">fill =</span> <span class="st">&quot;light gray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Demographic), <span class="dt">size =</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-13" data-line-number="13"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>subgroup) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb101-15" data-line-number="15">                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb101-16" data-line-number="16">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2004</span>, <span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb101-18" data-line-number="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Major Depressive Episode</span><span class="ch">\n</span><span class="st">among Persons Aged 12 to 17&quot;</span>,</a>
<a class="sourceLine" id="cb101-19" data-line-number="19">       <span class="dt">subtitle =</span> <span class="st">&quot;By Demographic Characteristics, Percentages, 2004-2018&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-20" data-line-number="20"><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb101-21" data-line-number="21"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb101-22" data-line-number="22">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) </a>
<a class="sourceLine" id="cb101-23" data-line-number="23"></a>
<a class="sourceLine" id="cb101-24" data-line-number="24">MDE_race</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-79-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Using the definitions from the <a href="https://www.census.gov/programs-surveys/cps/data/data-tools/cps-table-creator-help/race-definitions.html#:~:text=NHOPI%20Alone%20%E2%80%93%20NHOPI%20alone%20refers,not%20report%20any%20other%20race." target="_blank">Census Bureau</a>:</p>
<ol style="list-style-type: decimal">
<li><strong>AIAN</strong> stands for American Indian and Alaska Native<br />
</li>
<li><strong>NHOPI</strong> stands for Native Hawaiian or Other Pacific Islander</li>
</ol>
<p>Unfortunately, there is only one value for <code>NHOPI</code> group, thus since this is a line plot, we do not have enough points (2 at minimum) to create a line, so lets remove this group from the plot to remove the group from the legend.</p>
</div>
<div id="section-19" class="section level4 question_block">
<h4></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>How might we remove the <code>NHOPI</code> group from the legend?</p>
</div>
<div id="section-20" class="section level4">
<h4></h4>
<details>
<p><summary> Click here to reveal the code. </summary></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1">MDE_race &lt;-</a>
<a class="sourceLine" id="cb102-2" data-line-number="2"><span class="st">  </span>percents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb102-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;Major_Depressive_Episode&quot;</span>, </a>
<a class="sourceLine" id="cb102-4" data-line-number="4">         subgroup <span class="op">==</span><span class="st"> &quot;Race/Ethnicity&quot;</span>, </a>
<a class="sourceLine" id="cb102-5" data-line-number="5">         Demographic <span class="op">!=</span><span class="st"> &quot;NHOPI&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb102-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Demographic =</span> </a>
<a class="sourceLine" id="cb102-7" data-line-number="7">           <span class="kw">fct_reorder</span>(Demographic, Percent, </a>
<a class="sourceLine" id="cb102-8" data-line-number="8">                       tail, <span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">.desc =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb102-9" data-line-number="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, <span class="dt">group =</span> Demographic)) <span class="op">+</span></a>
<a class="sourceLine" id="cb102-10" data-line-number="10"><span class="st">    </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="dv">2011</span>, <span class="dt">xmax =</span> <span class="ot">Inf</span>,   </a>
<a class="sourceLine" id="cb102-11" data-line-number="11">              <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>,   </a>
<a class="sourceLine" id="cb102-12" data-line-number="12">              <span class="dt">fill =</span> <span class="st">&quot;light gray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb102-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Demographic), <span class="dt">size =</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb102-14" data-line-number="14"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>subgroup) <span class="op">+</span></a>
<a class="sourceLine" id="cb102-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb102-16" data-line-number="16">                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb102-17" data-line-number="17">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2004</span>, <span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb102-18" data-line-number="18"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb102-19" data-line-number="19"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Major Depressive Episode</span><span class="ch">\n</span><span class="st">among Persons Aged 12 to 17&quot;</span>,</a>
<a class="sourceLine" id="cb102-20" data-line-number="20">       <span class="dt">subtitle =</span> <span class="st">&quot;By Demographic Characteristics, Percentages, 2004-2018&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb102-21" data-line-number="21"><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb102-22" data-line-number="22"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb102-23" data-line-number="23">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) </a></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-81-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can see that the group of individuals who reported as being two or more races, had the highest percentages of having a major depressive episode in the past year. Those group who reported as Black or African American had the lowest percentages. However, we can see that most of the racial/ethnic groups are fairly similar and we see an increasing for most groups since around 2011. Keep in mind the limitations listed in the <a href="#limitations"><strong>Limitations</strong></a> section as you view these findings. It is possible that this group may be less likely to report experiencing symptoms of depression.</p>
</div>
</div>
<div id="mde-with-severe-impairment" class="section level3">
<h3>MDE with Severe Impairment</h3>
<p>Now let’s take a look at how the rate of youths reporting having a major depressive episode (MDE) <strong>with severe impairment</strong> has changed over time. See the <a href="#what-are-the-data"><strong>What are the data?</strong></a> section about how severe impairment was defined.</p>
<div id="section-21" class="section level4 question_block">
<h4></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Try to come up with the code for the following two plots on your own before you reveal it. This time we will use the <code>overview_theme()</code> function that we created.</p>
</div>
<div id="section-22" class="section level4">
<h4></h4>
<details>
<p><summary> Click here to reveal the code. </summary></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" data-line-number="1">MDES_total &lt;-</a>
<a class="sourceLine" id="cb103-2" data-line-number="2"><span class="st">  </span>percents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb103-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;Severe_Major_Depressive_Episode&quot;</span>, </a>
<a class="sourceLine" id="cb103-4" data-line-number="4">         Demographic <span class="op">==</span><span class="st"> &quot;TOTAL&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb103-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Demographic =</span> <span class="kw">recode</span>(Demographic, </a>
<a class="sourceLine" id="cb103-6" data-line-number="6">             <span class="st">&quot;TOTAL&quot;</span> =<span class="st"> &quot;Percent of respondents with Severe MDE&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb103-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, <span class="dt">group =</span> Demographic)) <span class="op">+</span></a>
<a class="sourceLine" id="cb103-8" data-line-number="8"><span class="st">    </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="dv">2011</span>, <span class="dt">xmax =</span> <span class="ot">Inf</span>,  </a>
<a class="sourceLine" id="cb103-9" data-line-number="9">              <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>,  </a>
<a class="sourceLine" id="cb103-10" data-line-number="10">              <span class="dt">fill =</span> <span class="st">&quot;light gray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb103-11" data-line-number="11"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Demographic), <span class="dt">size =</span><span class="dv">1</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb103-12" data-line-number="12"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2006</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb103-13" data-line-number="13">                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2006</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb103-14" data-line-number="14">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2006</span>, <span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb103-15" data-line-number="15"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Major Depressive Episode with Severe Impairment</span><span class="ch">\n</span><span class="st">among Persons Aged 12 to 17&quot;</span>,</a>
<a class="sourceLine" id="cb103-16" data-line-number="16">         <span class="dt">subtitle =</span> <span class="st">&quot;By Demographic Characteristics, Percentages, 2004-2018&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb103-17" data-line-number="17"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Demographic) <span class="op">+</span></a>
<a class="sourceLine" id="cb103-18" data-line-number="18"><span class="st">    </span><span class="kw">overview_theme</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb103-19" data-line-number="19"><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>))</a></code></pre></div>
</details>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1">MDES_total</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-83-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Next let’s look at age groups and sex differences:</p>
<details>
<p><summary> Click here to reveal the code. </summary></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" data-line-number="1">MDES_age_sex &lt;-</a>
<a class="sourceLine" id="cb105-2" data-line-number="2"><span class="st">  </span>percents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb105-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;Severe_Major_Depressive_Episode&quot;</span>, </a>
<a class="sourceLine" id="cb105-4" data-line-number="4">         subgroup <span class="op">!=</span><span class="st"> &quot;Race/Ethnicity&quot;</span>, </a>
<a class="sourceLine" id="cb105-5" data-line-number="5">         Demographic <span class="op">!=</span><span class="st"> &quot;TOTAL&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb105-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, <span class="dt">group =</span> Demographic)) <span class="op">+</span></a>
<a class="sourceLine" id="cb105-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="dv">2011</span>, <span class="dt">xmax =</span> <span class="ot">Inf</span>,  </a>
<a class="sourceLine" id="cb105-8" data-line-number="8">              <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>,  </a>
<a class="sourceLine" id="cb105-9" data-line-number="9">              <span class="dt">fill =</span> <span class="st">&quot;light gray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb105-10" data-line-number="10"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Demographic), <span class="dt">size =</span><span class="dv">1</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb105-11" data-line-number="11"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2006</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb105-12" data-line-number="12">                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2006</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb105-13" data-line-number="13">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2006</span>, <span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb105-14" data-line-number="14"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Major Depressive Episode with Severe Impairment</span><span class="ch">\n</span><span class="st">among Persons Aged 12 to 17&quot;</span>,</a>
<a class="sourceLine" id="cb105-15" data-line-number="15">         <span class="dt">subtitle =</span> <span class="st">&quot;By Demographic Characteristics, Percentages, 2004-2018&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb105-16" data-line-number="16"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>subgroup) <span class="op">+</span></a>
<a class="sourceLine" id="cb105-17" data-line-number="17"><span class="st">    </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb105-18" data-line-number="18"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb105-19" data-line-number="19">          <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) </a>
<a class="sourceLine" id="cb105-20" data-line-number="20"></a>
<a class="sourceLine" id="cb105-21" data-line-number="21">MDES_age_sex  &lt;-<span class="st"> </span><span class="kw">direct.label</span>(</a>
<a class="sourceLine" id="cb105-22" data-line-number="22">  MDES_age_sex, </a>
<a class="sourceLine" id="cb105-23" data-line-number="23">  <span class="kw">list</span>(<span class="kw">dl.trans</span>(<span class="dt">y =</span> y <span class="fl">+0.39</span>, <span class="dt">x =</span> x <span class="fl">-0.1</span>), </a>
<a class="sourceLine" id="cb105-24" data-line-number="24">       <span class="st">&quot;far.from.others.borders&quot;</span>,</a>
<a class="sourceLine" id="cb105-25" data-line-number="25">       <span class="dt">cex =</span> <span class="fl">.8</span>, </a>
<a class="sourceLine" id="cb105-26" data-line-number="26">       <span class="kw">dl.move</span>(<span class="st">&quot;Age_14-15&quot;</span>, <span class="dt">x=</span> <span class="fl">2016.5</span>, <span class="dt">y =</span> <span class="dv">11</span>))</a>
<a class="sourceLine" id="cb105-27" data-line-number="27">  )</a></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-85-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can see that the majority of individuals that reported experiencing a major depressive episode with severe impairment were in an older age bracket. However there appears to be a more dramatic change in the middle age group from 2011-2012. We can see a very steep increase in the data for the females after 2011, again this is much more steep than the increase seen for males over time.</p>
<p>Now let’s look at different racial/ethnic groups.</p>
</div>
<div id="section-23" class="section level4 question_block">
<h4></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Try to come up with the code for this plot on your own before you reveal it.</p>
</div>
<div id="section-24" class="section level4">
<h4></h4>
<details>
<p><summary> Click here to reveal the code. </summary></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1">Race_MDES &lt;-</a>
<a class="sourceLine" id="cb106-2" data-line-number="2"><span class="st">  </span>percents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb106-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;Severe_Major_Depressive_Episode&quot;</span>, </a>
<a class="sourceLine" id="cb106-4" data-line-number="4">         subgroup <span class="op">==</span><span class="st"> &quot;Race/Ethnicity&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb106-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Demographic =</span> </a>
<a class="sourceLine" id="cb106-6" data-line-number="6">           <span class="kw">fct_reorder</span>(Demographic, Percent, </a>
<a class="sourceLine" id="cb106-7" data-line-number="7">                       tail, <span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">.desc =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb106-8" data-line-number="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, <span class="dt">group =</span> Demographic)) <span class="op">+</span></a>
<a class="sourceLine" id="cb106-9" data-line-number="9"><span class="st">    </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="dv">2011</span>, <span class="dt">xmax =</span> <span class="ot">Inf</span>,  </a>
<a class="sourceLine" id="cb106-10" data-line-number="10">              <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>,  </a>
<a class="sourceLine" id="cb106-11" data-line-number="11">              <span class="dt">fill =</span> <span class="st">&quot;light gray&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb106-12" data-line-number="12"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Demographic), <span class="dt">size =</span><span class="dv">1</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb106-13" data-line-number="13"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>subgroup) <span class="op">+</span></a>
<a class="sourceLine" id="cb106-14" data-line-number="14"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2006</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb106-15" data-line-number="15">                       <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2006</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb106-16" data-line-number="16">                       <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2006</span>, <span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb106-17" data-line-number="17"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Major Depressive Episode with Severe Impairment</span><span class="ch">\n</span><span class="st">among Persons Aged 12 to 17&quot;</span>,</a>
<a class="sourceLine" id="cb106-18" data-line-number="18">         <span class="dt">subtitle =</span> <span class="st">&quot;By Demographic Characteristics: Percentages, 2006-2018&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb106-19" data-line-number="19"><span class="st">    </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb106-20" data-line-number="20"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb106-21" data-line-number="21">          <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb106-22" data-line-number="22"><span class="st">    </span><span class="kw">scale_color_viridis_d</span>()</a></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-87-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We see similar trends as we saw for the previous racial/ethnic group plot. The rate is highest for those who are two are more races and lowest for those who are Black or African American. The data for the AIAN group is sparse, so it is unclear if their levels would be lowest on the last year.</p>
</div>
</div>
<div id="mde-treatment" class="section level3">
<h3>MDE Treatment</h3>
<p>Now we will take a look at those who reported having a MDE and received treatment for depression.</p>
<p>First, let’s look overall using the <code>Demographic == &quot;TOTAL&quot;</code> group.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" data-line-number="1">Treat_total &lt;-</a>
<a class="sourceLine" id="cb107-2" data-line-number="2"><span class="st">  </span>percents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb107-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;treatment&quot;</span>, </a>
<a class="sourceLine" id="cb107-4" data-line-number="4">         Demographic <span class="op">==</span><span class="st"> &quot;TOTAL&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb107-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Demographic =</span> <span class="kw">recode</span>(Demographic, </a>
<a class="sourceLine" id="cb107-6" data-line-number="6">             <span class="st">&quot;TOTAL&quot;</span> =<span class="st"> &quot;Percent of MDE respondents with treatment&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb107-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, <span class="dt">group =</span> Demographic)) <span class="op">+</span></a>
<a class="sourceLine" id="cb107-8" data-line-number="8"><span class="st">    </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="dv">2011</span>, <span class="dt">xmax =</span> <span class="ot">Inf</span>,  </a>
<a class="sourceLine" id="cb107-9" data-line-number="9">              <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>,   </a>
<a class="sourceLine" id="cb107-10" data-line-number="10">              <span class="dt">fill =</span> <span class="st">&quot;light gray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb107-11" data-line-number="11"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Demographic), <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb107-12" data-line-number="12"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Demographic)<span class="op">+</span></a>
<a class="sourceLine" id="cb107-13" data-line-number="13"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb107-14" data-line-number="14">                       <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb107-15" data-line-number="15">                       <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2004</span>, <span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb107-16" data-line-number="16"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;The Rate of Youths Aged 12 to 17 Receiving Treatment after</span><span class="ch">\n</span><span class="st">Reporting Having a Major Depressive Episode is Increasing&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb107-17" data-line-number="17"><span class="st">    </span><span class="kw">overview_theme</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb107-18" data-line-number="18"><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>))</a>
<a class="sourceLine" id="cb107-19" data-line-number="19"></a>
<a class="sourceLine" id="cb107-20" data-line-number="20">Treat_total</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-88-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Overall, roughly 40 percent of youths who self-reported experiencing a major depressive episode, also received treatment for depression. This rate could definitely be improved.</p>
<p>This rate is increasing over time like the trend of those who had a major depressive episode, yet the data are much more variable from one year to the next.</p>
<p>Next, we consider differences between males and females and different age groups.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1">treat &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb108-2" data-line-number="2"><span class="st">  </span>percents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb108-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;treatment&quot;</span>, </a>
<a class="sourceLine" id="cb108-4" data-line-number="4">         subgroup <span class="op">!=</span><span class="st"> &quot;Race/Ethnicity&quot;</span>, </a>
<a class="sourceLine" id="cb108-5" data-line-number="5">         subgroup <span class="op">!=</span><span class="st"> &quot;Total&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb108-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, <span class="dt">color =</span> Demographic)) <span class="op">+</span></a>
<a class="sourceLine" id="cb108-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb108-8" data-line-number="8"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>subgroup)<span class="op">+</span></a>
<a class="sourceLine" id="cb108-9" data-line-number="9"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb108-10" data-line-number="10">                       <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb108-11" data-line-number="11">                       <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2004</span>, <span class="dv">2018</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb108-12" data-line-number="12"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Receipt of Treatment for Depression among</span><span class="ch">\n</span><span class="st">Persons Aged 12 to 17 with Major Depressive Episode&quot;</span>,</a>
<a class="sourceLine" id="cb108-13" data-line-number="13">         <span class="dt">subtitle =</span> <span class="st">&quot;By Demographic Characteristics: Percentages, 2004-2018&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb108-14" data-line-number="14"><span class="st">    </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb108-15" data-line-number="15"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb108-16" data-line-number="16">          <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) </a>
<a class="sourceLine" id="cb108-17" data-line-number="17"></a>
<a class="sourceLine" id="cb108-18" data-line-number="18">treat &lt;-<span class="st"> </span><span class="kw">direct.label</span>(</a>
<a class="sourceLine" id="cb108-19" data-line-number="19">  treat, </a>
<a class="sourceLine" id="cb108-20" data-line-number="20">  <span class="kw">list</span>(<span class="kw">dl.trans</span>(<span class="dt">y =</span> y <span class="fl">-1.5</span>, <span class="dt">x =</span> x <span class="fl">-0.4</span>),</a>
<a class="sourceLine" id="cb108-21" data-line-number="21">       <span class="st">&quot;far.from.others.borders&quot;</span>, </a>
<a class="sourceLine" id="cb108-22" data-line-number="22">       <span class="dt">cex =</span> <span class="fl">.8</span>, </a>
<a class="sourceLine" id="cb108-23" data-line-number="23">       <span class="kw">dl.move</span>(<span class="st">&quot;Age_16-17&quot;</span>, <span class="dt">x =</span> <span class="dv">2010</span>, <span class="dt">y =</span> <span class="dv">42</span>),</a>
<a class="sourceLine" id="cb108-24" data-line-number="24">       <span class="kw">dl.move</span>(<span class="st">&quot;Age_14-15&quot;</span>, <span class="dt">x =</span> <span class="dv">2015</span>, <span class="dt">y =</span> <span class="dv">38</span>)))</a>
<a class="sourceLine" id="cb108-25" data-line-number="25">treat</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-89-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>There seems to be an upward trend, but it isn’t nearly as much as the trend we saw for the increase of major depressive episodes. In general, the data seems to vary much more as well.</p>
<div id="section-25" class="section level4 question_block">
<h4></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Create a similar plot on your own for the different race / ethnic groups.</p>
</div>
<div id="section-26" class="section level4">
<h4></h4>
<details>
<p><summary> Click here to reveal the code. </summary></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" data-line-number="1">Race_treat &lt;-percents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb109-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;treatment&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb109-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(subgroup <span class="op">==</span><span class="st"> &quot;Race/Ethnicity&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb109-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Demographic =</span> </a>
<a class="sourceLine" id="cb109-5" data-line-number="5">           <span class="kw">fct_reorder</span>(Demographic, Percent, </a>
<a class="sourceLine" id="cb109-6" data-line-number="6">                       tail, <span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">.desc =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb109-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, <span class="dt">color =</span> Demographic)) <span class="op">+</span></a>
<a class="sourceLine" id="cb109-8" data-line-number="8"><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">size =</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb109-9" data-line-number="9"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>subgroup) <span class="op">+</span></a>
<a class="sourceLine" id="cb109-10" data-line-number="10"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2009</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb109-11" data-line-number="11">                       <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2009</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb109-12" data-line-number="12">                       <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2009</span>, <span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb109-13" data-line-number="13"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Receipt of Treatment for Depression among</span><span class="ch">\n</span><span class="st">Persons Aged 12 to 17 with Major Depressive Episode&quot;</span>,</a>
<a class="sourceLine" id="cb109-14" data-line-number="14">         <span class="dt">subtitle =</span> <span class="st">&quot;By Demographic Characteristics: Percentages, 2004-2018&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb109-15" data-line-number="15"><span class="st">    </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb109-16" data-line-number="16"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb109-17" data-line-number="17">          <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb109-18" data-line-number="18"><span class="st">    </span><span class="kw">scale_color_viridis_d</span>()</a></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-91-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>It looks as though youths who report as being white received the most care from mental health services.</p>
</div>
</div>
<div id="mental-health-services" class="section level3">
<h3>Mental Health Services</h3>
<p>We will also take a look at where youths are receiving treatment by using values from <code>table11.1b</code> which has the percentage values for counts presented in <code>table11.1a</code>.</p>
<p>We can use the <code>str_detect()</code> function of the <code>stringr</code> package to filter for the values of the <code>short_label</code> variable that has the word <code>total</code> in it.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1">plotMHS &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb110-2" data-line-number="2"><span class="st">  </span>table11<span class="fl">.1</span>b <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb110-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(short_label, <span class="st">&quot;total&quot;</span>) ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb110-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, </a>
<a class="sourceLine" id="cb110-5" data-line-number="5">             <span class="dt">group =</span> MHS_setting, <span class="dt">color =</span> short_label)) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-6" data-line-number="6"><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-7" data-line-number="7"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>type) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-8" data-line-number="8"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2009</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb110-9" data-line-number="9">                                <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2009</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb110-10" data-line-number="10">                                <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2009</span>, <span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-11" data-line-number="11"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Settings Where Mental Health Services Were Received</span><span class="ch">\n</span><span class="st">among Persons Aged 12 to 17&quot;</span>,</a>
<a class="sourceLine" id="cb110-12" data-line-number="12">         <span class="dt">subtitle =</span> <span class="st">&quot;Percentages, 2002-2018&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-13" data-line-number="13"><span class="st">    </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb110-14" data-line-number="14"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb110-15" data-line-number="15">          <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) </a>
<a class="sourceLine" id="cb110-16" data-line-number="16"></a>
<a class="sourceLine" id="cb110-17" data-line-number="17">plotMHS &lt;-<span class="st"> </span><span class="kw">direct.label</span>(</a>
<a class="sourceLine" id="cb110-18" data-line-number="18">  plotMHS, </a>
<a class="sourceLine" id="cb110-19" data-line-number="19">  <span class="kw">list</span>(<span class="kw">dl.trans</span>(<span class="dt">y =</span> y <span class="fl">+0.35</span>, <span class="dt">x =</span> x <span class="fl">-0.1</span>),</a>
<a class="sourceLine" id="cb110-20" data-line-number="20">       <span class="st">&quot;far.from.others.borders&quot;</span>, </a>
<a class="sourceLine" id="cb110-21" data-line-number="21">       <span class="dt">cex =</span> <span class="fl">.8</span>, </a>
<a class="sourceLine" id="cb110-22" data-line-number="22">       <span class="kw">dl.move</span>(<span class="st">&quot;Outpatient total&quot;</span>, <span class="dt">x =</span> <span class="dv">2015</span>, <span class="dt">y =</span><span class="dv">11</span>))</a>
<a class="sourceLine" id="cb110-23" data-line-number="23">  )</a>
<a class="sourceLine" id="cb110-24" data-line-number="24">plotMHS</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-92-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can see that youths appear to be receiving care in nonspecialty facilities at a slightly higher rate than that of specialty facilities. However, the rates appear to be very similar and the relative differences appear to be consistent across time.</p>
<p>Let’s take a look at subcategories of mental health services. To do this, we will filter for values within the <code>short_label</code> variable that do not contain the word “total” by using a <code>!</code> in front of the <code>str_dectect</code> statement.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" data-line-number="1">plotMHSS &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb111-2" data-line-number="2"><span class="st">  </span>table11<span class="fl">.1</span>b <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb111-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">str_detect</span>(short_label, <span class="st">&quot;total&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb111-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, </a>
<a class="sourceLine" id="cb111-5" data-line-number="5">         <span class="dt">group =</span> MHS_setting, <span class="dt">color =</span> short_label)) <span class="op">+</span></a>
<a class="sourceLine" id="cb111-6" data-line-number="6"><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb111-7" data-line-number="7"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>type) <span class="op">+</span></a>
<a class="sourceLine" id="cb111-8" data-line-number="8"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2002</span>, <span class="dv">2019</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb111-9" data-line-number="9">                       <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2002</span>, <span class="dv">2019</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb111-10" data-line-number="10">                       <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2002</span>, <span class="dv">2019</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb111-11" data-line-number="11"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Settings Where Mental Health Services Were Received</span><span class="ch">\n</span><span class="st">among Persons Aged 12 to 17&quot;</span>,</a>
<a class="sourceLine" id="cb111-12" data-line-number="12">         <span class="dt">subtitle =</span> <span class="st">&quot;Percentages, 2002-2018&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb111-13" data-line-number="13"><span class="st">    </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb111-14" data-line-number="14"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb111-15" data-line-number="15">          <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) </a>
<a class="sourceLine" id="cb111-16" data-line-number="16"></a>
<a class="sourceLine" id="cb111-17" data-line-number="17">plotMHSS &lt;-<span class="st"> </span><span class="kw">direct.label</span>(</a>
<a class="sourceLine" id="cb111-18" data-line-number="18">  plotMHSS, </a>
<a class="sourceLine" id="cb111-19" data-line-number="19">  <span class="kw">list</span>(<span class="kw">dl.trans</span>(<span class="dt">y =</span> y <span class="fl">+0.3</span>),</a>
<a class="sourceLine" id="cb111-20" data-line-number="20">       <span class="st">&quot;far.from.others.borders&quot;</span>, </a>
<a class="sourceLine" id="cb111-21" data-line-number="21">       <span class="kw">dl.move</span>(<span class="st">&quot;School Therapist&quot;</span>, <span class="dv">2010</span>, <span class="dv">10</span>), </a>
<a class="sourceLine" id="cb111-22" data-line-number="22">       <span class="kw">dl.move</span>(<span class="st">&quot;Fostercare&quot;</span>, <span class="dv">2010</span>, <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb111-23" data-line-number="23">       <span class="kw">dl.move</span>(<span class="st">&quot;Therapist&quot;</span>, <span class="dt">x=</span><span class="dv">2009</span>, <span class="dt">y =</span> <span class="fl">10.5</span>))</a>
<a class="sourceLine" id="cb111-24" data-line-number="24">  )</a>
<a class="sourceLine" id="cb111-25" data-line-number="25">plotMHSS</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-93-1.png" width="90%" style="display: block; margin: auto;" /> It looks like most youths are receiving care from either a therapist or a school therapist.</p>
<p>OK, so now we know how the rates of different subgroups compare for having a MDE in the past year, having a MDE with severe impairment, and receiving treatment after a MDE. We also know where youths are typically getting treatment. But, how do the rates of having a MDE in the past year, having a MDE with severe impairment, and receiving treatment compare within each subgroup (e.g. just females)?</p>
<p>This is what we tackle in the next section.</p>
</div>
<div id="overall-outcomes-by-group" class="section level3">
<h3>Overall outcomes by group</h3>
<p>In the next plot, we first filter for <code>Male</code>, <code>Female</code> and <code>Total</code> and then facet by the <code>Demographic</code> variable.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1">sex_outcomes &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb112-2" data-line-number="2"><span class="st">  </span>percents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb112-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(Demographic <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>, <span class="st">&quot;TOTAL&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb112-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, <span class="dt">color =</span> Demographic)) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-5" data-line-number="5"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> data_type), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-6" data-line-number="6"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb112-7" data-line-number="7">                       <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb112-8" data-line-number="8">                       <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2004</span>, <span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-9" data-line-number="9"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Major Depressive Episode among Persons Aged 12 to 17&quot;</span>,</a>
<a class="sourceLine" id="cb112-10" data-line-number="10">         <span class="dt">subtitle =</span> <span class="st">&quot;By Demographic Characteristics, Percentages, 2004-2018&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-11" data-line-number="11"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Demographic, <span class="dt">strip.position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-12" data-line-number="12"><span class="st">    </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb112-13" data-line-number="13"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb112-14" data-line-number="14">          <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>),</a>
<a class="sourceLine" id="cb112-15" data-line-number="15">          <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb112-16" data-line-number="16">          <span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-17" data-line-number="17"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb112-18" data-line-number="18"></a>
<a class="sourceLine" id="cb112-19" data-line-number="19">sex_outcomes </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-94-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can see that a large portion of individuals experiencing a major depressive episode have an episode with severe impairment for each group. Females have a higher rate of both types of episode and of treatment. Although females have more than double the rate of reported episodes, they receive a relatively similar rate of treatment as males for depression. This suggests that females are either more likely than males to self-report depression symptoms in surveys, or females may not be receiving as much care despite the larger need.</p>
<div id="section-27" class="section level4 question_block">
<h4></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Create a similar plot on your own for different age groups.</p>
</div>
<div id="section-28" class="section level4">
<h4></h4>
<details>
<p><summary> Click here to reveal the code. </summary></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" data-line-number="1">age_outcomes &lt;-</a>
<a class="sourceLine" id="cb113-2" data-line-number="2"><span class="st">  </span>percents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb113-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(subgroup <span class="op">==</span><span class="st"> &quot;Age&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb113-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, <span class="dt">color =</span> Demographic)) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-5" data-line-number="5"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype=</span> data_type), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-6" data-line-number="6"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb113-7" data-line-number="7">                       <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb113-8" data-line-number="8">                       <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2004</span>, <span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-9" data-line-number="9"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Major Depressive Episode</span><span class="ch">\n</span><span class="st">among Persons Aged 12 to 17&quot;</span>,</a>
<a class="sourceLine" id="cb113-10" data-line-number="10">         <span class="dt">subtitle =</span> <span class="st">&quot;By Demographic Characteristics, Percentages, 2004-2018&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-11" data-line-number="11"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Demographic, <span class="dt">strip.position =</span> <span class="st">&quot;top&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb113-12" data-line-number="12"><span class="st">    </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb113-13" data-line-number="13"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb113-14" data-line-number="14">          <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>),</a>
<a class="sourceLine" id="cb113-15" data-line-number="15">          <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb113-16" data-line-number="16">          <span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb113-17" data-line-number="17"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-96-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>All age groups show a similar ratio of severe major depressive episodes for those that experienced an episode.</p>
</div>
<div id="section-29" class="section level4 question_block">
<h4></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Create a similar plot on your own for the different race / ethnic groups.</p>
</div>
<div id="section-30" class="section level4">
<h4></h4>
<details>
<p><summary> Click here to reveal the code. </summary></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" data-line-number="1">race_outcomes &lt;-</a>
<a class="sourceLine" id="cb114-2" data-line-number="2"><span class="st">  </span>percents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb114-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(subgroup <span class="op">==</span><span class="st"> &quot;Race/Ethnicity&quot;</span>, </a>
<a class="sourceLine" id="cb114-4" data-line-number="4">         Demographic <span class="op">!=</span><span class="st"> &quot;NHOPI&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb114-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, <span class="dt">color =</span> Demographic)) <span class="op">+</span></a>
<a class="sourceLine" id="cb114-6" data-line-number="6"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> data_type), <span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb114-7" data-line-number="7"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb114-8" data-line-number="8">                       <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb114-9" data-line-number="9">                       <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2004</span>, <span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb114-10" data-line-number="10"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Major Depressive Episode</span><span class="ch">\n</span><span class="st">among Persons Aged 12 to 17&quot;</span>,</a>
<a class="sourceLine" id="cb114-11" data-line-number="11">         <span class="dt">subtitle =</span> <span class="st">&quot;By Demographic Characteristics, Percentages, 2004-2018&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb114-12" data-line-number="12"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Demographic, <span class="dt">strip.position =</span> <span class="st">&quot;top&quot;</span>, <span class="dt">nrow =</span> <span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb114-13" data-line-number="13"><span class="st">    </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb114-14" data-line-number="14"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb114-15" data-line-number="15">          <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>),</a>
<a class="sourceLine" id="cb114-16" data-line-number="16">          <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb114-17" data-line-number="17">          <span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb114-18" data-line-number="18"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
</details>
<p><img src="index_files/figure-html/unnamed-chunk-98-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>All racial and ethnic groups also show a similar rate of severe episodes relative to general episode rate. The rate of receiving treatment is fairly similar relative to the percentage of youths that reported having symptoms for each group.</p>
</div>
</div>
</div>
<div id="data-analysis" class="section level2">
<h2><strong>Data Analysis</strong></h2>
<hr />
<p>Recall what our main questions were:</p>
<div id="section-31" class="section level4 main_question_block">
<h4></h4>
<p><b><u> Our main questions: </u></b></p>
<ol style="list-style-type: decimal">
<li>How have depression rates in American youth changed since 2004, according to the NSDUH data? How have rates differed between different youth subgroups (age, gender, ethnicity)?</li>
<li>Do mental health services appear to be reaching more youths? Again, how have rates differed between different youth subgroups (age, gender, ethnicity)?</li>
</ol>
</div>
<div id="section-32" class="section level4">
<h4></h4>
<p>We are specifically interested in how the frequency of recent major depressive episodes among youths differ compared to those in 2004. We are also interested how different subgroups differ. We will start with examining how male and females differ across time.</p>
<p>Since we have counts for the two sexes: males and females, and for the two years of interest, 2004 and 2018, we can conduct a <a href="https://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test#:~:text=Pearson&#39;s%20chi%2Dsquared%20test%20is,differs%20from%20a%20theoretical%20distribution." target="_blank">Pearson’s chi-squared test</a> for <strong>independence</strong>, which is also written like this: <span class="math inline">\({\chi}^2\)</span>.</p>
<p>This will allow us to compare if the frequencies of major depressive episodes differs from what we would expect by chance if the variables years and sex were independent.</p>
<p>The null hypothesis is that the variables are independent or that the difference in the proportions is equal to zero. Thus, we want to test if sex and year are independent. In other words, we want to know if sex influences the number of major depressive episodes in 2004 and 2018. Or stated yet another way: <em>are major depressive episode counts across the two years associated with sex?</em></p>
<p>According to <a href="https://en.wikipedia.org/wiki/Chi-squared_test?oldformat=true" target="_blank">wikipedia</a>:</p>
<blockquote>
<p>Pearson’s chi-square test is used to determine whether there is a statistically significant difference between the <strong>expected frequencies</strong> and the <strong>observed frequencies</strong> in one or more <strong>categories</strong> of a <a href="https://en.wikipedia.org/wiki/Contingency_table" target="_blank">contingency table</a>.</p>
</blockquote>
<p>Thus, to conduct this statistical test, we first need to create a <a href="https://en.wikipedia.org/wiki/Contingency_table" target="_blank">contingency table</a>, which in this case could also be called a 2x2 table, which is the simplest kind of contingency table (only two levels for two variables).</p>
<p>Before we create a contingency table for our data and use the chi-squared test, let’s practice this with a different example.</p>
<hr />
<p>Consider a hypothetical scenario where we sample 100 individuals and report a contingency table representing the number of hypothetical individuals that we observed who are left and right handed, stratified by males and females (assuming all individuals had binary gender).</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" data-line-number="1">observed &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Sex =</span> <span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Total&quot;</span>), </a>
<a class="sourceLine" id="cb115-2" data-line-number="2">                   <span class="dt">Righthanded =</span> <span class="kw">c</span>(<span class="dv">41</span>,<span class="dv">47</span>,<span class="dv">88</span>), </a>
<a class="sourceLine" id="cb115-3" data-line-number="3">                   <span class="dt">Lefthanded =</span> <span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">3</span>, <span class="dv">12</span>), </a>
<a class="sourceLine" id="cb115-4" data-line-number="4">                   <span class="dt">Total =</span> <span class="kw">c</span>(<span class="dv">50</span>,<span class="dv">50</span>,<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb115-5" data-line-number="5">observed</a></code></pre></div>
<pre><code># A tibble: 3 x 4
  Sex    Righthanded Lefthanded Total
  &lt;chr&gt;        &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;
1 Male            41          9    50
2 Female          47          3    50
3 Total           88         12   100</code></pre>
<p>We can see that there are two variables: <code>Sex</code> and <code>Handedness</code> and each have two levels (<code>Male</code> and <code>Female</code> for <code>Sex</code> and right and left for handedness). The table also includes totals of each of the 4 possible groups as well as the overall total.</p>
<p>Next, we create a table of what we <strong>expect</strong> assuming <code>Sex</code> and <code>Handedness</code> are independent.</p>
<ul>
<li>The total number of individuals who are right-handed is 88 out of 100 which is equal to 88%.</li>
<li>The total number of individuals who are left-handed is 12 out of 100 which is equal to 12%.</li>
</ul>
<p>Thus, if each both <code>Male</code> and <code>Females</code> had the same amount of right-handedness and left-handedness, we would expect 88% of the males to be right-handed and 12% to be left-handed; and we would expect the exact same proportions of 88% right-handed and 12% left-handed for the females.</p>
<p>Since we have 50 males and 50 females and 12% of 50 is 6 and 88% of 50 is 44, we would thus have the following table of expected frequencies:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" data-line-number="1">expected &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Sex =</span> <span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Total&quot;</span>), </a>
<a class="sourceLine" id="cb117-2" data-line-number="2">                   <span class="dt">Righthanded =</span> <span class="kw">c</span>(<span class="dv">44</span>,<span class="dv">44</span>,<span class="dv">88</span>), </a>
<a class="sourceLine" id="cb117-3" data-line-number="3">                   <span class="dt">Lefthanded =</span> <span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">6</span>, <span class="dv">12</span>), </a>
<a class="sourceLine" id="cb117-4" data-line-number="4">                   <span class="dt">Total =</span> <span class="kw">c</span>(<span class="dv">50</span>,<span class="dv">50</span>,<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb117-5" data-line-number="5">expected</a></code></pre></div>
<pre><code># A tibble: 3 x 4
  Sex    Righthanded Lefthanded Total
  &lt;chr&gt;        &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;
1 Male            44          6    50
2 Female          44          6    50
3 Total           88         12   100</code></pre>
<p>The <span class="math inline">\({\chi}^2\)</span> test statistics is calculated using the <code>observed</code> (O) and <code>expected</code> (E) frequencies we just calculated above using the following formula:</p>
<p><span class="math display">\[{\chi}^2=\sum_{j=1}^{m} \frac{(O_j - E_j)^2}{E_j}\]</span></p>
<p>where <span class="math inline">\(O_j = j^{th}\)</span> observed count and <span class="math inline">\(E_j = j^{th}\)</span> expected count for the jth cell of a contingency table with <span class="math inline">\(m\)</span> cells.</p>
<p>The degrees of freedom (<span class="math inline">\(df\)</span>) is calculated like so: <span class="math inline">\(df= (r-1)(c-1)\)</span>.</p>
<p>Where <span class="math inline">\(r\)</span> = # of rows and <span class="math inline">\(c\)</span> = the # of columns.</p>
<p>So to calculate the <span class="math inline">\({\chi}^2\)</span> test statistics for handedness and sex manually, we can do the following for each of the four values in the table (ignoring the <code>Totals</code>) like this:</p>
<p><span class="math display">\[{\chi}^2 =  \frac{(41-44)^2}{44} + \frac{(9-6)^2}{6}+ \frac{(47-44)^2}{44}+ \frac{(3-6)^2}{6}\]</span></p>
<p>where we calculate the fraction of the square difference of the observed minus the expected, divided by expected for</p>
<ol style="list-style-type: decimal">
<li>right-handed males</li>
<li>left-handed males</li>
<li>right-handed females</li>
<li>left-handed females</li>
</ol>
<p>After summing these individual terms together, this is equal to</p>
<p><span class="math inline">\({\chi}^2\)</span> = 3.4090909</p>
<p>Where the degrees of freedom = <span class="math inline">\(df = (92-1)(2-1) = 1\)</span></p>
<p>What does this mean? We need to consult a chi-square distribution to determine what the <span class="math inline">\(p\)</span>-value is and if this is significant.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/8/8e/Chi-square_distributionCDF-English.png" width="90%" style="display: block; margin: auto;" /></p>
<div id="source-9" class="section level5">
<h5><a href="https://en.wikipedia.org/wiki/Chi-squared_test#/media/File:Chi-square_distributionCDF-English.png" target="_blank">[source]</a></h5>
<p>This <a href="http://homepage.divms.uiowa.edu/~mbognar/applets/chisq.html" target="_blank">website</a> has a simple way to check this, without requiring you to get out a ruler and consult this plot. Note on this website the notation for <span class="math inline">\(df\)</span> is <span class="math inline">\({\nu}\)</span>.</p>
<p>Plugging in 3.409091 as <span class="math inline">\({\chi}^2\)</span> and 1 as <span class="math inline">\({\nu}\)</span>, we get a <span class="math inline">\(p\)</span>-value of 0.06484.</p>
<p>Thus, we do not have enough evidence to reject the null hypothesis. Therefore, using the data we have, we do not have evidence in our data to suggest that sex and handedness are not independent.</p>
<p>See here for a more thorough explanation of the <a href="https://www.ling.upenn.edu/~clight/chisquared.htm" target="_blank">chi-square test</a>.</p>
<hr />
<p>Now let’s create a contingency table with our own data and see how we can implement this test in R.</p>
<p>It is critical that we use the counts data, and not the percentage data for our analysis, as the <span class="math inline">\({\chi}^2\)</span> test <strong>requires</strong> counts.</p>
<p>We will filter the count data for the <code>Major_Depressive_Episode</code> data, as well as for the <code>Male</code> and <code>Female</code> data from <code>2004</code> and <code>2018</code>.</p>
<p>The following code subsets the data we need and makes the necessary manipulations so that the units of observation are appropriate. If we take a look at the title of the table we can see that the numbers in the table represent individuals by the thousands.</p>
<p><img src="img/dem_table.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" data-line-number="1">chi_square_<span class="fl">11.2</span>a &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb119-2" data-line-number="2"><span class="st">  </span>counts <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb119-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;Major_Depressive_Episode&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb119-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">2004</span>, <span class="dv">2018</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb119-5" data-line-number="5"><span class="st">  </span><span class="kw">filter</span>(Demographic <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>,<span class="st">&quot;Female&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb119-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Number =</span> Number <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>)</a></code></pre></div>
<p>The resulting object contains all the values we need for out contingency table.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1">chi_square_<span class="fl">11.2</span>a</a></code></pre></div>
<pre><code># A tibble: 4 x 5
  Demographic subgroup data_type                 Year  Number
  &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;                    &lt;dbl&gt;   &lt;dbl&gt;
1 Male        Sex      Major_Depressive_Episode  2004  637000
2 Male        Sex      Major_Depressive_Episode  2018  946000
3 Female      Sex      Major_Depressive_Episode  2004 1588000
4 Female      Sex      Major_Depressive_Episode  2018 2537000</code></pre>
<p>A contingency table can now be produced from this data (which currently is in long format) by transforming the data to wide format and re-purposing some values as row names. To reformat the data to wide format, we can use the <code>pivot_wider()</code> function of the <code>tidyr</code> package.</p>
<p>For this function there are several important arguments:</p>
<ol style="list-style-type: decimal">
<li><code>names_from</code> - this is the variable where the names of new columns will come from</li>
<li><code>values_from</code> - this is the variable where the values for the new columns will come from</li>
<li><code>names_prefix</code> - if we want to add a prefix to the new columns we can do so using this argument</li>
</ol>
<p>In our case, we want to spread out the year data into two columns thus the names will come from the <code>Year</code> variable and the values will come from the <code>Number</code> variable. We want to add the word <code>Year</code> to the new columns. We also want the remove the <code>subgroup</code> and <code>data_type</code> variables and only keep the <code>Demographic</code>, <code>Year</code>, and <code>Number</code> variables. To do so we can use the <code>select()</code> function.</p>
</div>
</div>
<div id="section-33" class="section level4 question_block">
<h4></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Using what you just learned about <code>pivot_wider()</code> and <code>select()</code> and without scrolling up, try to come up with the code to do the wrangling for this data.</p>
</div>
<div id="section-34" class="section level4">
<h4></h4>
<details>
<p><summary> Click here to reveal the code. </summary></p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" data-line-number="1">chi_square_<span class="fl">11.2</span>a <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb122-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(Demographic, Year, Number) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb122-3" data-line-number="3"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> Year,</a>
<a class="sourceLine" id="cb122-4" data-line-number="4">                     <span class="dt">names_prefix =</span> <span class="st">&quot;Year&quot;</span>, </a>
<a class="sourceLine" id="cb122-5" data-line-number="5">                     <span class="dt">values_from =</span> Number)</a>
<a class="sourceLine" id="cb122-6" data-line-number="6">chi_square_<span class="fl">11.2</span>a</a></code></pre></div>
<pre><code># A tibble: 2 x 3
  Demographic Year2004 Year2018
  &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;
1 Male          637000   946000
2 Female       1588000  2537000</code></pre>
</details>
<p>At this point we have three columns, but the first column we only need the <code>Male</code> and <code>Female</code> labels and want to treat it as row names. To convert a column to the names of rows, you can use the <code>column_to_rownames()</code> function of the <code>tibble</code> package to make the <code>Demographic</code> variable levels for the row names. Otherwise, we would need to select the numeric columns to perform the stats test.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" data-line-number="1">chi_square_<span class="fl">11.2</span>a <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb124-2" data-line-number="2"><span class="st">  </span>tibble<span class="op">::</span><span class="kw">column_to_rownames</span>(<span class="st">&quot;Demographic&quot;</span>)</a>
<a class="sourceLine" id="cb124-3" data-line-number="3"></a>
<a class="sourceLine" id="cb124-4" data-line-number="4">chi_square_<span class="fl">11.2</span>a</a></code></pre></div>
<pre><code>       Year2004 Year2018
Male     637000   946000
Female  1588000  2537000</code></pre>
<p><strong>Note</strong>: a contingency table would usually also have totals for all groups as well, but this is not necessary for the <code>stats::chisq.test()</code> function.</p>
<p>The chi-squared test for independence can be conducted using the <code>stats::chisq.test()</code> function.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" data-line-number="1">stats<span class="op">::</span><span class="kw">chisq.test</span>(chi_square_<span class="fl">11.2</span>a)</a></code></pre></div>
<pre><code>
    Pearson&#39;s Chi-squared test with Yates&#39; continuity correction

data:  chi_square_11.2a
X-squared = 1461.2, df = 1, p-value &lt; 2.2e-16</code></pre>
<p>We see that the <span class="math inline">\(p\)</span>-value is very small, which suggests there is an association between <code>Sex</code> and the number of major depressive episodes across time (2004 compared to 2018).</p>
</div>
<div id="section-35" class="section level4 question_block">
<h4></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Using what you learned about the Chi-squared test, describe the results in reference to the null hypothesis.</p>
</div>
<div id="section-36" class="section level4">
<h4></h4>
<p>How about for severe major depressive episodes?</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" data-line-number="1">chi_square_<span class="fl">11.3</span>a &lt;-<span class="st"> </span>counts <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb128-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;Severe_Major_Depressive_Episode&quot;</span>, </a>
<a class="sourceLine" id="cb128-3" data-line-number="3">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">2009</span>, <span class="dv">2018</span>), </a>
<a class="sourceLine" id="cb128-4" data-line-number="4">         Demographic <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>,<span class="st">&quot;Female&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb128-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Number =</span> Number <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb128-6" data-line-number="6"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>data_type, <span class="op">-</span>subgroup) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb128-7" data-line-number="7"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> Year,</a>
<a class="sourceLine" id="cb128-8" data-line-number="8">              <span class="dt">names_prefix =</span> <span class="st">&quot;Year&quot;</span>, </a>
<a class="sourceLine" id="cb128-9" data-line-number="9">              <span class="dt">values_from =</span> Number) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb128-10" data-line-number="10"><span class="st">  </span><span class="kw">column_to_rownames</span>(<span class="st">&quot;Demographic&quot;</span>)</a>
<a class="sourceLine" id="cb128-11" data-line-number="11"></a>
<a class="sourceLine" id="cb128-12" data-line-number="12">chi_square_<span class="fl">11.3</span>a</a></code></pre></div>
<pre><code>       Year2009 Year2018
Male     391000   628000
Female  1013000  1795000</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" data-line-number="1"><span class="kw">chisq.test</span>(chi_square_<span class="fl">11.3</span>a)</a></code></pre></div>
<pre><code>
    Pearson&#39;s Chi-squared test with Yates&#39; continuity correction

data:  chi_square_11.3a
X-squared = 1696, df = 1, p-value &lt; 2.2e-16</code></pre>
<p>There also appears to be an influence of sex on the rate of severe major depressive episodes across the years.</p>
<p>How about treatment?</p>
</div>
<div id="section-37" class="section level4 question_block">
<h4></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Try performing the same wrangling as we did for the percentage of each demographic that reported having a major depressive episode for the data about treatment.</p>
</div>
<div id="section-38" class="section level4">
<h4></h4>
<details>
<p><summary> Click here to reveal the code. </summary></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" data-line-number="1">chi_square_<span class="fl">11.4</span>a &lt;-<span class="st"> </span>counts <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb132-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;treatment&quot;</span>, </a>
<a class="sourceLine" id="cb132-3" data-line-number="3">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">2009</span>, <span class="dv">2018</span>), </a>
<a class="sourceLine" id="cb132-4" data-line-number="4">         Demographic <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>,<span class="st">&quot;Female&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb132-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Number =</span> Number <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb132-6" data-line-number="6"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>data_type, <span class="op">-</span>subgroup) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb132-7" data-line-number="7"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> Year,</a>
<a class="sourceLine" id="cb132-8" data-line-number="8">              <span class="dt">names_prefix =</span> <span class="st">&quot;Year&quot;</span>, </a>
<a class="sourceLine" id="cb132-9" data-line-number="9">              <span class="dt">values_from =</span> Number) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb132-10" data-line-number="10"><span class="st">  </span><span class="kw">column_to_rownames</span>(<span class="st">&quot;Demographic&quot;</span>)</a>
<a class="sourceLine" id="cb132-11" data-line-number="11"></a>
<a class="sourceLine" id="cb132-12" data-line-number="12">chi_square_<span class="fl">11.4</span>a</a></code></pre></div>
<pre><code>       Year2009 Year2018
Male     168000   351000
Female   505000  1081000</code></pre>
</details>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" data-line-number="1"><span class="kw">chisq.test</span>(chi_square_<span class="fl">11.4</span>a)</a></code></pre></div>
<pre><code>
    Pearson&#39;s Chi-squared test with Yates&#39; continuity correction

data:  chi_square_11.4a
X-squared = 50.256, df = 1, p-value = 1.349e-12</code></pre>
<p>There also appears to be an influence of sex on the rate at which youths received treatment across the two years.</p>
</div>
</div>
<div id="summary" class="section level2">
<h2><strong>Summary</strong></h2>
<hr />
<div id="summary-plot" class="section level3">
<h3>Summary Plot</h3>
<p>Let’s make a plot that summarizes our major findings.</p>
<p>We will use the <code>ggdraw()</code> function in the <code>cowplot</code> package. This allows you to add labels and other plot aspects on top of existing plots. Thus if we want to add a title element to our overall plot that we will add to a combined plot of our existing plots we can use <code>ggdraw()</code> to start and then the <code>draw_label()</code> function to add text.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" data-line-number="1">title_plots &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb136-2" data-line-number="2"><span class="st">  </span><span class="kw">ggdraw</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb136-3" data-line-number="3"><span class="st">  </span><span class="kw">draw_label</span>(</a>
<a class="sourceLine" id="cb136-4" data-line-number="4">    <span class="st">&quot;Self-Reported Depression Among American Youths&quot;</span>,</a>
<a class="sourceLine" id="cb136-5" data-line-number="5">    <span class="dt">fontface =</span> <span class="st">&#39;bold&#39;</span>,</a>
<a class="sourceLine" id="cb136-6" data-line-number="6">    <span class="dt">size=</span><span class="dv">18</span>,</a>
<a class="sourceLine" id="cb136-7" data-line-number="7">    <span class="dt">x =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb136-8" data-line-number="8">    <span class="dt">hjust =</span> <span class="fl">-0.01</span></a>
<a class="sourceLine" id="cb136-9" data-line-number="9">  )</a></code></pre></div>
<p>The <code>x = 0</code> argument places the title on the far left edge of the plot area. Thus, if we use a value of -0.01 it will move the title just a bit away from the left edge of the plot area.</p>
<div id="section-39" class="section level4 question_block">
<h4></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>What happens if we modify the <code>hjust</code> value?</p>
<details>
<p><summary> Click here to reveal the answer. </summary></p>
<p>The <code>hjust</code> argument moves the label in the horizontal direction.</p>
</details>
</div>
<div id="section-40" class="section level4">
<h4></h4>
<p>We can also make a subtitle in the same way. Here, we create a subtitle called <code>forward</code>, which we will use later on.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" data-line-number="1">forward &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb137-2" data-line-number="2"><span class="st">  </span><span class="kw">draw_label</span>(</a>
<a class="sourceLine" id="cb137-3" data-line-number="3">    <span class="st">&quot;The percentage of youths (age 12-17) experiencing major depressive episodes (MDE) has</span><span class="ch">\n</span><span class="st">increased since 2011. Of these youths, the percentage receiving treatment for depression has also</span><span class="ch">\n</span><span class="st"> increased but remains limited to less than 42%.&quot;</span>,</a>
<a class="sourceLine" id="cb137-4" data-line-number="4">    <span class="dt">size =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb137-5" data-line-number="5">    <span class="dt">x =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb137-6" data-line-number="6">    <span class="dt">hjust =</span> <span class="fl">-0.01</span></a>
<a class="sourceLine" id="cb137-7" data-line-number="7">  )</a></code></pre></div>
<p>Next, we will modify some of our existing plots using the <code>theme()</code> function as we did before to remove the x-axis title, to change the color of the axis text and the title size and color, as well as change the titles of the plots.</p>
<p>Using our <code>MDE_total</code> plot:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" data-line-number="1">MDE_total_for_mp &lt;-</a>
<a class="sourceLine" id="cb138-2" data-line-number="2"><span class="st">  </span>MDE_total <span class="op">+</span></a>
<a class="sourceLine" id="cb138-3" data-line-number="3"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb138-4" data-line-number="4">     <span class="dt">plot.subtitle =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb138-5" data-line-number="5">         <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>))</a></code></pre></div>
<p>Using our <code>Treat_total</code> plot:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" data-line-number="1">treat_for_mp &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb139-2" data-line-number="2"><span class="st">  </span>Treat_total <span class="op">+</span></a>
<a class="sourceLine" id="cb139-3" data-line-number="3"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb139-4" data-line-number="4">     <span class="dt">plot.subtitle =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb139-5" data-line-number="5">         <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>))</a></code></pre></div>
<p>Using our <code>MDE_age_sex</code> plot:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" data-line-number="1">MDE_age_sex_for_mp &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb140-2" data-line-number="2"><span class="st">  </span>MDE_age_sex <span class="op">+</span></a>
<a class="sourceLine" id="cb140-3" data-line-number="3"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title=</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb140-4" data-line-number="4">        <span class="dt">plot.subtitle =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb140-5" data-line-number="5">        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb140-6" data-line-number="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Older youths and females report MDE at the highest rates</span><span class="ch">\n</span><span class="st">and show the steepest increase&quot;</span>) </a></code></pre></div>
<p>For this last plot, we also want to get the legend and save it as a separate object so that we can add it to our plot grid in a way that does not shrink the size of our plot to accommodate the legend. We can use the <code>get_legend()</code> function of the <code>cowplot</code> package to do this. We can also specify how it should be justified using <code>theme(legend.justification =)</code> this takes a number of options including “center”, “left”, and &quot;right.</p>
<p>However, beforehand, we also want to change the way the legend is displayed. We can use the <code>guides()</code> function of the <code>ggplot2</code> package to modify the legend to specify that we want the legend to be displayed in 2 columns like so <code>guides(color = guide_legend(ncol = 2))</code>. We need to specify that we are modifying the legend for color.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" data-line-number="1">MDE_race_for_mp_leg &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb141-2" data-line-number="2"><span class="st">  </span>MDE_race <span class="op">+</span></a>
<a class="sourceLine" id="cb141-3" data-line-number="3"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title=</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb141-4" data-line-number="4">        <span class="dt">plot.subtitle =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb141-5" data-line-number="5">        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb141-6" data-line-number="6">        <span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, </a>
<a class="sourceLine" id="cb141-7" data-line-number="7">        <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb141-8" data-line-number="8">        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb141-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;All racial/ethnic groups show similar</span><span class="ch">\n</span><span class="st">increases since 2011&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb141-10" data-line-number="10"><span class="st"> </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="dt">ncol =</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb141-11" data-line-number="11"></a>
<a class="sourceLine" id="cb141-12" data-line-number="12">legend&lt;-<span class="st"> </span><span class="kw">get_legend</span>(MDE_race_for_mp_leg <span class="op">+</span></a>
<a class="sourceLine" id="cb141-13" data-line-number="13"><span class="st">          </span><span class="kw">theme</span>(<span class="dt">legend.justification =</span><span class="st">&quot;right&quot;</span>))</a></code></pre></div>
<p>Now, we will remove the legend for this plot.</p>
</div>
<div id="section-41" class="section level4 question_block">
<h4></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Do you recall how to do this? Without scrolling up, see if you can figure out how.</p>
</div>
<div id="section-42" class="section level4">
<h4></h4>
<details>
<p><summary> Click here to reveal the code. </summary></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" data-line-number="1">MDE_race_for_mp &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb142-2" data-line-number="2"><span class="st">  </span>MDE_race_for_mp_leg <span class="op">+</span></a>
<a class="sourceLine" id="cb142-3" data-line-number="3"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
</details>
<p>OK, now we are ready to start putting our plots together using the <code>plot_grid()</code> function of the <code>cowplot</code> package.</p>
<p>It is helpful to first make rows by combining the plots that we want to be displayed next to each other and then combining these with the title and subtitle, called <code>forward</code>.</p>
<p>We can use the <code>rel_widths</code> (relative column width) argument to modify how wide each plot is displayed. For example, in a two-column grid, <code>rel_widths = c(2, 1)</code> would make the first column twice as wide as the second column.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" data-line-number="1">row_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(MDE_total_for_mp,</a>
<a class="sourceLine" id="cb143-2" data-line-number="2">                   treat_for_mp,</a>
<a class="sourceLine" id="cb143-3" data-line-number="3">                   <span class="dt">nrow =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb143-4" data-line-number="4"></a>
<a class="sourceLine" id="cb143-5" data-line-number="5">row_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(MDE_age_sex_for_mp,</a>
<a class="sourceLine" id="cb143-6" data-line-number="6">                   MDE_race_for_mp,</a>
<a class="sourceLine" id="cb143-7" data-line-number="7">                   <span class="dt">nrow =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb143-8" data-line-number="8">                   <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.6</span>))</a></code></pre></div>
<p>Now we can combine everything together using <code>plot_grid()</code> yet again. Now that we have rows, we can combine everything as a single column and easily modify the relative heights using the <code>rel_heights()</code> function so that our title, subtitle and legend are all relative short relative to the plots. We will make the first row half the height of the second row.</p>
<p>Finally, we will use the <code>png()</code> function of the <code>grDevices</code> package which is automatically loaded in RStudio sessions to save the plot. We will use the <code>here()</code> function of the <code>here</code> package, to specify that we want to save it in the <code>img</code> directory and call it <code>mainplot.png</code>. We can also use this function to specify the resolution with <code>res</code> and in doing so, we need to save the image with size specifications to make it larger.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" data-line-number="1"><span class="kw">png</span>(<span class="dt">filename =</span> here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;mainplot_orig.png&quot;</span>), </a>
<a class="sourceLine" id="cb144-2" data-line-number="2">         <span class="dt">res =</span> <span class="dv">300</span>, <span class="dt">width =</span> <span class="dv">10</span>, <span class="dt">height =</span> <span class="dv">10</span>, <span class="dt">units =</span> <span class="st">&quot;in&quot;</span>)</a>
<a class="sourceLine" id="cb144-3" data-line-number="3"><span class="kw">plot_grid</span>(title_plots, </a>
<a class="sourceLine" id="cb144-4" data-line-number="4">          forward,</a>
<a class="sourceLine" id="cb144-5" data-line-number="5">          row_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb144-6" data-line-number="6">          row_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb144-7" data-line-number="7">          legend,</a>
<a class="sourceLine" id="cb144-8" data-line-number="8">          <span class="dt">ncol =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb144-9" data-line-number="9">          <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,.<span class="dv">8</span>, <span class="dv">1</span>, <span class="fl">0.3</span>))</a>
<a class="sourceLine" id="cb144-10" data-line-number="10"><span class="kw">dev.off</span>()</a></code></pre></div>
<pre><code>quartz_off_screen 
                2 </code></pre>
<p>The <code>dev.off()</code> function is necessary to close the graphics device. This is good practice to allow you to create another plot again later.</p>
<p><img src="img/mainplot_orig.png" width="90%" style="display: block; margin: auto;" /></p>
<p>OK, this looks pretty good! But it is a bit busy, so we are now going to remove the Race/ethnicity plot so as to simplify our plot.</p>
<p>This time we need to recreate our <code>MDE_age_sex</code> plot again because we want to separate our plots so they look more similar to the total MDE and treatment plots. So we will actually make two separate plots.</p>
<p>We also want to recode the text for the strip above the plot and change the plot so that there are no grid lines like the first row of plots.</p>
</div>
<div id="section-43" class="section level4 question_block">
<h4></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Try to come up with the code for these plots on your own before you reveal it. We can use our <code>overview_theme()</code> for these plots to make all the plots look similar.</p>
</div>
<div id="section-44" class="section level4">
<h4></h4>
<details>
<p><summary> Click here to reveal the code. </summary></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" data-line-number="1">MDE_sex &lt;-percents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb146-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;Major_Depressive_Episode&quot;</span>, </a>
<a class="sourceLine" id="cb146-3" data-line-number="3">          subgroup <span class="op">==</span><span class="st"> &quot;Sex&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb146-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">subgroup =</span> <span class="kw">recode</span>(subgroup, <span class="st">&quot;Sex&quot;</span> =<span class="st"> </span></a>
<a class="sourceLine" id="cb146-5" data-line-number="5"><span class="st">         &quot;Percent of each sex reporting MDE&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb146-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, <span class="dt">group =</span> Demographic)) <span class="op">+</span></a>
<a class="sourceLine" id="cb146-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="dv">2011</span>, <span class="dt">xmax =</span> <span class="ot">Inf</span>,  </a>
<a class="sourceLine" id="cb146-8" data-line-number="8">            <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>,  </a>
<a class="sourceLine" id="cb146-9" data-line-number="9">            <span class="dt">fill =</span> <span class="st">&quot;light gray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb146-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Demographic), <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb146-11" data-line-number="11"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>subgroup)<span class="op">+</span></a>
<a class="sourceLine" id="cb146-12" data-line-number="12"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">23</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb146-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb146-14" data-line-number="14">                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb146-15" data-line-number="15">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2004</span>, <span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb146-16" data-line-number="16"><span class="st"> </span><span class="kw">overview_theme</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb146-17" data-line-number="17"><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#FF61C9&quot;</span>,</a>
<a class="sourceLine" id="cb146-18" data-line-number="18">                                <span class="st">&quot;#00A5FF&quot;</span>))</a>
<a class="sourceLine" id="cb146-19" data-line-number="19"></a>
<a class="sourceLine" id="cb146-20" data-line-number="20"></a>
<a class="sourceLine" id="cb146-21" data-line-number="21">MDE_sex&lt;-<span class="st"> </span><span class="kw">direct.label</span>(</a>
<a class="sourceLine" id="cb146-22" data-line-number="22">  MDE_sex, </a>
<a class="sourceLine" id="cb146-23" data-line-number="23">  <span class="kw">list</span>(<span class="kw">dl.trans</span>(<span class="dt">y =</span> y <span class="fl">+0.38</span>, <span class="dt">x =</span> x <span class="fl">-0.2</span>), </a>
<a class="sourceLine" id="cb146-24" data-line-number="24">       <span class="st">&quot;far.from.others.borders&quot;</span>, </a>
<a class="sourceLine" id="cb146-25" data-line-number="25">       <span class="dt">cex =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb146-26" data-line-number="26">       <span class="dt">fontface=</span><span class="kw">c</span>(<span class="st">&quot;bold&quot;</span>))</a>
<a class="sourceLine" id="cb146-27" data-line-number="27">  )</a>
<a class="sourceLine" id="cb146-28" data-line-number="28">       </a>
<a class="sourceLine" id="cb146-29" data-line-number="29"></a>
<a class="sourceLine" id="cb146-30" data-line-number="30"></a>
<a class="sourceLine" id="cb146-31" data-line-number="31">MDE_age &lt;-percents <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb146-32" data-line-number="32"><span class="st">  </span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;Major_Depressive_Episode&quot;</span>, </a>
<a class="sourceLine" id="cb146-33" data-line-number="33">          subgroup <span class="op">==</span><span class="st"> &quot;Age&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb146-34" data-line-number="34"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">subgroup =</span> <span class="kw">recode</span>(subgroup, <span class="st">&quot;Age&quot;</span> =<span class="st"> </span></a>
<a class="sourceLine" id="cb146-35" data-line-number="35"><span class="st">        &quot;Percent of each age group reporting MDE&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb146-36" data-line-number="36"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Percent, <span class="dt">group =</span> Demographic)) <span class="op">+</span></a>
<a class="sourceLine" id="cb146-37" data-line-number="37"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="dv">2011</span>, <span class="dt">xmax =</span> <span class="ot">Inf</span>,  </a>
<a class="sourceLine" id="cb146-38" data-line-number="38">            <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>,  </a>
<a class="sourceLine" id="cb146-39" data-line-number="39">            <span class="dt">fill =</span> <span class="st">&quot;light gray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb146-40" data-line-number="40"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Demographic), <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb146-41" data-line-number="41"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>subgroup)<span class="op">+</span></a>
<a class="sourceLine" id="cb146-42" data-line-number="42"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">23</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb146-43" data-line-number="43"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb146-44" data-line-number="44">                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">2004</span>, <span class="dv">2018</span>, <span class="dt">by=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb146-45" data-line-number="45">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2004</span>, <span class="dv">2018</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb146-46" data-line-number="46"><span class="st">  </span><span class="kw">overview_theme</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb146-47" data-line-number="47"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#ED8141&quot;</span>,</a>
<a class="sourceLine" id="cb146-48" data-line-number="48">                                <span class="st">&quot;#39B600&quot;</span>,</a>
<a class="sourceLine" id="cb146-49" data-line-number="49">                                <span class="st">&quot;darkorchid2&quot;</span>))<span class="co">##9590FF#00BFC4</span></a>
<a class="sourceLine" id="cb146-50" data-line-number="50"></a>
<a class="sourceLine" id="cb146-51" data-line-number="51">MDE_age&lt;-<span class="st"> </span><span class="kw">direct.label</span>(</a>
<a class="sourceLine" id="cb146-52" data-line-number="52">  MDE_age, </a>
<a class="sourceLine" id="cb146-53" data-line-number="53">  <span class="kw">list</span>(<span class="kw">dl.trans</span>(<span class="dt">y =</span> y <span class="op">+</span><span class="st"> </span><span class="fl">0.38</span>, <span class="dt">x =</span> x <span class="fl">-0.2</span>), </a>
<a class="sourceLine" id="cb146-54" data-line-number="54">       <span class="st">&quot;far.from.others.borders&quot;</span>, </a>
<a class="sourceLine" id="cb146-55" data-line-number="55">       <span class="dt">cex =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb146-56" data-line-number="56">       <span class="dt">fontface=</span><span class="kw">c</span>(<span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb146-57" data-line-number="57">       <span class="kw">dl.move</span>(<span class="st">&quot;Age_12-13&quot;</span>, <span class="dt">x =</span> <span class="dv">2015</span>, <span class="dt">y =</span> <span class="dv">9</span>))</a>
<a class="sourceLine" id="cb146-58" data-line-number="58">  )</a></code></pre></div>
</details>
<p>We will also make another subtitle for the sex and race plots. This time we will add bold text to our text using the base <code>expression()</code> function and the base <code>paste()</code> function which allows you to combine character strings together. We can specify that we don’t want any spaces or character for our separator.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" data-line-number="1">label &lt;-<span class="kw">expression</span>(<span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb147-2" data-line-number="2">    <span class="kw">bold</span>(<span class="st">&quot;Older &quot;</span>),</a>
<a class="sourceLine" id="cb147-3" data-line-number="3">    <span class="st">&quot;youths and &quot;</span>,</a>
<a class="sourceLine" id="cb147-4" data-line-number="4">    <span class="kw">bold</span>(<span class="st">&quot;females &quot;</span>),</a>
<a class="sourceLine" id="cb147-5" data-line-number="5">    <span class="st">&quot;report MDE at the highest rate and also show the steepest increase.&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb147-6" data-line-number="6"></a>
<a class="sourceLine" id="cb147-7" data-line-number="7">forward2 &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb147-8" data-line-number="8"><span class="st">  </span><span class="kw">draw_label</span>(label,</a>
<a class="sourceLine" id="cb147-9" data-line-number="9">    <span class="dt">size =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb147-10" data-line-number="10">    <span class="dt">x =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb147-11" data-line-number="11">    <span class="dt">hjust =</span> <span class="fl">-0.01</span></a>
<a class="sourceLine" id="cb147-12" data-line-number="12">  )</a></code></pre></div>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1">row_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(MDE_age, MDE_sex,</a>
<a class="sourceLine" id="cb148-2" data-line-number="2">                   <span class="dt">nrow =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb148-3" data-line-number="3"></a>
<a class="sourceLine" id="cb148-4" data-line-number="4"><span class="kw">png</span>(<span class="dt">filename =</span> here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;mainplot.png&quot;</span>), </a>
<a class="sourceLine" id="cb148-5" data-line-number="5">         <span class="dt">res =</span> <span class="dv">300</span>, <span class="dt">width =</span> <span class="dv">10</span>, <span class="dt">height =</span> <span class="dv">10</span>, <span class="dt">units =</span> <span class="st">&quot;in&quot;</span>)</a>
<a class="sourceLine" id="cb148-6" data-line-number="6"><span class="kw">plot_grid</span>(title_plots, </a>
<a class="sourceLine" id="cb148-7" data-line-number="7">          forward,</a>
<a class="sourceLine" id="cb148-8" data-line-number="8">          row_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb148-9" data-line-number="9">          forward2,</a>
<a class="sourceLine" id="cb148-10" data-line-number="10">          row_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb148-11" data-line-number="11">          <span class="dt">ncol =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb148-12" data-line-number="12">          <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="dv">1</span>, <span class="fl">0.1</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb148-13" data-line-number="13"><span class="kw">dev.off</span>()</a></code></pre></div>
<pre><code>quartz_off_screen 
                2 </code></pre>
<p><img src="img/mainplot.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="synopsis" class="section level3">
<h3>Synopsis</h3>
<p>In this case study we evaluated self-reported measures of depression symptoms among youths age 12-17 in the United States, as well as the rate of youths receiving treatment for depression. We learned how to scrape data directly from the web using the <code>rvest</code> package and we learned how to perform and interpret a chi-square test using the <code>chisq.test()</code> function of the <code>stats</code> package.</p>
<p>By analyzing and plotting our data, it is clear that depression rates appear to be increasing, particularly since 2011. However, it is possible that respondents had similar rates in previous years, but now feel less stigma about responding about depression symptoms when filling out the survey. The survey has always been anonymous, but <a href="https://en.wikipedia.org/wiki/Self-report_study#:~:text=Self%2Dreport%20studies%20are%20inherently,answers%20will%20be%20more%20positive." target="_blank">reporting bias</a> can sometimes cause individuals to exaggerate or minimize their symptoms because of what they think researchers want their response to be or out of shame or embarrassment, among other reasons. However, the data suggests that youths may be experiencing more symptoms of depression and that the rate of increase is quite high.</p>
<p>Nearly a quarter of all individuals that were female and of age 12-17 reported experiencing symptoms of depression. This warrants further investigation to see if this is a product of more reporting or if indeed American females are truly more depressed. Furthermore, if they are indeed more depressed, investigation about why young females are more depressed is also of critical importance. One important limitation is that the data does not include subgroup intersections, such as rates of major depressive episodes among females of various ethnic backgrounds.</p>
<p>Considering the very steep increase in females, this warrants further investigation about which females are particularly vulnerable and why.</p>
</div>
</div>
<div id="homework" class="section level2">
<h2><strong>Homework</strong></h2>
<hr />
<p>Ask students to scrape Tables 11.5A and 11.5B from the website, which contain data about the receipt of treatment among youths who reported having a severe episode. Ask students to create plots and perform Chi-square tests to evaluate how groups compare over time.</p>
</div>
<div id="additional-information" class="section level2">
<h2><strong>Additional Information</strong></h2>
<hr />
<div id="helpful-links" class="section level3">
<h3>Helpful Links</h3>
<p><a href="https://rstudio.com/products/rstudio/features/" target="_blank">RStudio</a><br />
<a href="https://github.com/rstudio/cheatsheets/raw/master/rstudio-ide.pdf" target="_blank">Cheatsheet on RStuido IDE</a><br />
<a href="https://rstudio.com/resources/cheatsheets/" target="_blank">Other RStudio cheatsheets</a><br />
<a href="https://www.tidyverse.org/" target="_blank">Tidyverse</a><br />
<a href="https://en.wikipedia.org/wiki/Selection_bias?oldformat=true" target="_blank">Selection bias</a><br />
<a href="https://en.wikipedia.org/wiki/Sampling_(statistics)?oldformat=true" target="_blank">Sampling methods</a><br />
<a href="https://en.wikipedia.org/wiki/Sampling_frame?oldformat=true" target="_blank">Sampling frame</a><br />
<a href="https://en.wikipedia.org/wiki/DSM-5" target="_blank">DSM 5</a></summary><br />
<a href="https://nsduhweb.rti.org/respweb/homepage.cfm" target="_blank">National Survey on Drug Use and Health (NSDUH)</a><br />
<a href="https://www.samhsa.gov/" target="_blank">Substance Abuse and Mental Health Services Administration (SAMHSA)</a><br />
<a href="https://www.hhs.gov/" target="_blank">U.S. Department of Health and Human Services (DHHS)</a><br />
<a href="https://www.samhsa.gov/data/sites/default/files/cbhsq-reports/NSDUHDetailedTabs2018R2/NSDUHDetTabsSect11pe2018.htm" target="_blank">NSDUH Survey Results Website</a> (where we got the data for this case study)<br />
<a href="https://nsduhweb.rti.org/respweb/about_nsduh.html" target="_blank">Details about the Survey</a><br />
<a href="https://www.samhsa.gov/data/sites/default/files/cbhsq-reports/NSDUHDetailedTabs2018R2/NSDUHDetailedTabs2018.pdf" target="_blank">Report about the 2018 NSDUH Survey</a><br />
<a href="https://en.wikipedia.org/wiki/Web_scraping?oldformat=true" target="_blank">Web scraping</a><br />
<a href="https://cran.r-project.org/web/packages/rvest/vignettes/selectorgadget.html" target="_blank">Selectorgadget Tool</a><br />
See this <a href="http://research.libd.org/rstatsclub/post/introduction-to-scraping-and-wranging-tables-from-research-articles/#.Xw878ZNKhQJ" target="_blank">blog post</a>, this <a href="http://blog.corynissen.com/2015/01/using-rvest-to-scrape-html-table.html" target="_blank">blog post</a>, and this <a href="https://rstudio-pubs-static.s3.amazonaws.com/266430_f3fd4660b2744751ab144aa130768a06.html" target="_blank">vignette</a> for more information about web scraping<br />
<a href="http://flukeout.github.io/#" target="_blank">CSS selectors tutorial</a> (and the <a href="https://gist.github.com/chrisman/fcb0a88459cd98239dbe6d2d200b02d1" target="_blank">answers</a>)<br />
<a href="https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html" target="_blank">Piping in R</a><br />
<a href="https://r4ds.had.co.nz/functions.html" target="_blank">Writing functions</a> Also see <a href="https://opencasestudies.github.io/ocs-bloomberg-vaping-case-study/" target="_blank">this case study</a> for more information on writing functions.<br />
<a href="https://rstudio.com/resources/cheatsheets/" target="_blank">String manipulation cheatsheet</a><br />
<a href="https://en.wikipedia.org/wiki/Wide_and_narrow_data" target="_blank">Table formats</a> <a href="https://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test#:~:text=Pearson&#39;s%20chi%2Dsquared%20test%20is,differs%20from%20a%20theoretical%20distribution." target="_blank">Pearson’s chi-squared test</a><br />
<a href="https://en.wikipedia.org/wiki/Contingency_table" target="_blank">contingency table</a><br />
<a href="https://en.wikipedia.org/wiki/Chi-squared_test#/media/File:Chi-square_distributionCDF-English.png" target="_blank">Chi-square distribution</a><br />
<a href="http://homepage.divms.uiowa.edu/~mbognar/applets/chisq.html" target="_blank">chi-square distribution applet</a><br />
See here for a more thorough explanation of the <a href="https://www.ling.upenn.edu/~clight/chisquared.htm" target="_blank">chi-square test</a><br />
<a href="http://ggplot2.tidyverse.org" target="_blank"><code>ggplot2</code> package</a><br />
Please see <a href="https://opencasestudies.github.io/ocs-bp-co2-emissions/" target="_blank">this case study</a> for more details on using <code>ggplot2</code>. <a href="http://vita.had.co.nz/papers/layered-grammar.html" target="_blank">grammar of graphics</a><br />
<a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" target="_blank"><code>ggplot2</code> themes</a><br />
<a href="http://directlabels.r-forge.r-project.org/docs/index.html" target="_blank"><code>directlabels</code> package methods</a><br />
<a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html" target="_blank">Viridis palette for colorblind friendly plots</a><br />
<a href="https://pubmed.ncbi.nlm.nih.gov/30869927/" target="_blank">Motivating article for this case study about depression rates</a> (Access is possible for those at Hopkins by using their email address)</p>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/24285382/" target="_blank">Motivating article about the rate of youths seeking mental health services</a></p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3330161/" target="_blank">Cross-cultural review article about possible causes for increased depression</a></p>
<p><a href="https://childmind.org/article/is-social-media-use-causing-depression/" target="_blank">Review article about social media and depression</a></p>
<p><u><strong>Packages used in this case study:</strong> </u></p>
<table>
<thead>
<tr class="header">
<th>Package</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://github.com/jennybc/here_here" target="_blank">here</a></td>
<td>to easily load and save data</td>
</tr>
<tr class="even">
<td><a href="https://github.com/tidyverse/rvest" target="_blank">rvest</a></td>
<td>to scrape web pages</td>
</tr>
<tr class="odd">
<td><a href="https://dplyr.tidyverse.org/" target="_blank">dplyr</a></td>
<td>to scrape web pages</td>
</tr>
<tr class="even">
<td><a href="https://magrittr.tidyverse.org/" target="_blank">magrittr</a></td>
<td>to scrape web pages</td>
</tr>
<tr class="odd">
<td><a href="https://stringr.tidyverse.org/" target="_blank">stringr</a></td>
<td>to manipulate strings</td>
</tr>
<tr class="even">
<td><a href="https://tidyr.tidyverse.org/" target="_blank">tidyr</a></td>
<td>to change the shape or format of tibbles to wide and long</td>
</tr>
<tr class="odd">
<td><a href="https://tibble.tidyverse.org/" target="_blank">tibble</a></td>
<td>to create tibbles and convert a column to row names</td>
</tr>
<tr class="even">
<td><a href="https://ggplot2.tidyverse.org/" target="_blank">ggplot2</a></td>
<td>to create plots</td>
</tr>
<tr class="odd">
<td><a href="http://directlabels.r-forge.r-project.org/docs/index.html" target="_blank">directlabels</a></td>
<td>to add labels directly to lines in plots</td>
</tr>
<tr class="even">
<td><a href="https://forcats.tidyverse.org/" target="_blank">forcats</a></td>
<td>to reorder factor for plot</td>
</tr>
<tr class="odd">
<td><a href="https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html" target="_blank">cowplot</a></td>
<td>to combine plots together</td>
</tr>
</tbody>
</table>
<div id="section-45" class="section level4 emphasis_block">
<h4></h4>
<p>If you are in crisis and need help, call this toll-free number for the <strong>National Suicide Prevention Lifeline (NSPL)</strong>, available 24 hours a day, every day: <strong>1-800-273-TALK (8255)</strong>. The service is available to everyone. The deaf and hard of hearing can contact the Lifeline via TTY at 1-800-799-4889. All calls are confidential. You can also visit the Lifeline’s website at <a href="www.suicidepreventionlifeline.org" target="_blank">www.suicidepreventionlifeline.org</a>.</p>
<p>The <strong>Crisis Text Line</strong> is another free, confidential resource available 24 hours a day, seven days a week. Text “HOME” to <strong>741741</strong> and a trained crisis counselor will respond to you with support and information over text message. Visit <a href="www.crisistextline.org" target="_blank">www.crisistextline.org</a>.</p>
</div>
<div id="section-46" class="section level4">
<h4></h4>
<p>Also see <a href="https://www.mhanational.org/depression-teens-0" target="_blank">here</a> for more information about how to recognize and help youths experiencing symptoms of depression</p>
</div>
</div>
<div id="acknowledgements" class="section level3">
<h3>Acknowledgements</h3>
<p>We would like to acknowledge <a href="https://www.jhsph.edu/faculty/directory/profile/1770/tamar-mendelson" target="_blank">Tamar Mendelson</a> for assisting in framing the major direction of the case study.</p>
<p>We would also like to acknowledge the <a href="https://americanhealth.jhu.edu/" target="_blank">Bloomberg American Health Initiative</a> for funding this work.</p>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiT3BlbiBDYXNlIFN0dWRpZXM6IE1lbnRhbCBIZWFsdGggb2YgQW1lcmljYW4gWW91dGgiCmNzczogc3R5bGUuY3NzCm91dHB1dDoKICBodG1sX2RvY3VtZW50OgogICAgc2VsZl9jb250YWluZWQ6IHllcwogICAgY29kZV9kb3dubG9hZDogeWVzCiAgICBoaWdobGlnaHQ6IHRhbmdvCiAgICBudW1iZXJfc2VjdGlvbnM6IG5vCiAgICB0aGVtZTogY29zbW8KICAgIHRvYzogeWVzCiAgICB0b2NfZmxvYXQ6IHllcwogIHBkZl9kb2N1bWVudDoKICAgIHRvYzogeWVzCiAgd29yZF9kb2N1bWVudDoKICAgIHRvYzogeWVzCgotLS0KPHN0eWxlPgojVE9DIHsKICBiYWNrZ3JvdW5kOiB1cmwoImh0dHBzOi8vb3BlbmNhc2VzdHVkaWVzLmdpdGh1Yi5pby9pbWcvbG9nby5qcGciKTsKICBiYWNrZ3JvdW5kLXNpemU6IGNvbnRhaW47CiAgcGFkZGluZy10b3A6IDI0MHB4ICFpbXBvcnRhbnQ7CiAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKfQo8L3N0eWxlPgoKCgpgYGB7ciBzZXR1cCwgaW5jbHVkZT1GQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGluY2x1ZGUgPSBUUlVFLCBjb21tZW50ID0gTkEsIGVjaG8gPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IEZBTFNFLCB3YXJuaW5nID0gRkFMU0UsIGNhY2hlID0gRkFMU0UsCiAgICAgICAgICAgICAgICAgICAgICBmaWcuYWxpZ24gPSAiY2VudGVyIiwgb3V0LndpZHRoID0gJzkwJScpCmxpYnJhcnkoaGVyZSkKbGlicmFyeShrbml0cikKbGlicmFyeShtYWdpY2spICMgdG8gY3JlYXRlIGdpZgpgYGAKCiMjIyMgey5vdXRsaW5lIH0KYGBge3IsIGVjaG8gPSBGQUxTRSwgb3V0LndpZHRoID0gIjgwMCBweCJ9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsICJtYWlucGxvdC5wbmciKSkKYGBgCgojIyMjCgojIyB7LmRpc2NsYWltZXJfYmxvY2t9CgoqKkRpc2NsYWltZXIqKjogVGhlIHB1cnBvc2Ugb2YgdGhlIFtPcGVuIENhc2UgU3R1ZGllc10oaHR0cHM6Ly9vcGVuY2FzZXN0dWRpZXMuZ2l0aHViLmlvKXt0YXJnZXQ9Il9ibGFuayJ9IHByb2plY3QgaXMgKip0byBkZW1vbnN0cmF0ZSB0aGUgdXNlIG9mIHZhcmlvdXMgZGF0YSBzY2llbmNlIG1ldGhvZHMsIHRvb2xzLCBhbmQgc29mdHdhcmUgaW4gdGhlIGNvbnRleHQgb2YgbWVzc3ksIHJlYWwtd29ybGQgZGF0YSoqLiBBIGdpdmVuIGNhc2Ugc3R1ZHkgZG9lcyBub3QgY292ZXIgYWxsIGFzcGVjdHMgb2YgdGhlIHJlc2VhcmNoIHByb2Nlc3MsIGlzIG5vdCBjbGFpbWluZyB0byBiZSB0aGUgbW9zdCBhcHByb3ByaWF0ZSB3YXkgdG8gYW5hbHl6ZSBhIGdpdmVuIGRhdGEgc2V0LCBhbmQgc2hvdWxkIG5vdCBiZSB1c2VkIGluIHRoZSBjb250ZXh0IG9mIG1ha2luZyBwb2xpY3kgZGVjaXNpb25zIHdpdGhvdXQgZXh0ZXJuYWwgY29uc3VsdGF0aW9uIGZyb20gc2NpZW50aWZpYyBleHBlcnRzLiAKCiMjIHsubGljZW5zZV9ibG9ja30KClRoaXMgd29yayBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQ3JlYXRpdmUgQ29tbW9ucyBBdHRyaWJ1dGlvbi1Ob25Db21tZXJjaWFsIDMuMCBbKENDIEJZLU5DIDMuMCldKGh0dHBzOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1uYy8zLjAvdXMvKXt0YXJnZXQ9Il9ibGFuayJ9ICBVbml0ZWQgU3RhdGVzIExpY2Vuc2UuCgojIyB7LnJlZmVyZW5jZV9ibG9ja30KClRvIGNpdGUgdGhpcyBjYXNlIHN0dWR5IHBsZWFzZSB1c2U6CgpXcmlnaHQsIENhcnJpZSwgYW5kIE9udGl2ZXJvcywgTWljaGFlbCBhbmQgSmFnZXIsIExlYWggYW5kIFRhdWIsIE1hcmdhcmV0IGFuZCBIaWNrcywgU3RlcGhhbmllLiAoMjAyMCkuIGh0dHBzOi8vZ2l0aHViLmNvbS9vcGVuY2FzZXN0dWRpZXMvb2NzLXlvdXRoLW1lbnRhbC1oZWFsdGgtY2FzZS1zdHVkeS4gTWVudGFsIEhlYWx0aCBvZiBBbWVyaWNhbiBZb3V0aCAoVmVyc2lvbiB2MS4wLjApLgoKCiMjICoqTW90aXZhdGlvbioqCioqKiAKClJhdGVzIG9mIGRlcHJlc3Npb24gYXBwZWFyIHRvIGhhdmUgYmVlbiBpbmNyZWFzaW5nIGFtb25nIEFtZXJpY2FuIHlvdXRocyBzaW5jZSBhcm91bmQgMjAxMCBhY2NvcmRpbmcgdG8gYSByZWNlbnQgW3JlcG9ydF0oaHR0cHM6Ly9jb250ZW50LmFwYS5vcmcvcmVjb3JkLzIwMTktMTI1NzgtMDAxKXt0YXJnZXQ9Il9ibGFuayJ9LiBBIFtyZWNlbnQgc3R1ZHldKGh0dHBzOi8vcHVibWVkLm5jYmkubmxtLm5paC5nb3YvMjQyODUzODIvKXt0YXJnZXQ9Il9ibGFuayJ9IGFsc28gc2hvd3MgdGhhdCB5b3V0aHMgYXBwZWFyIHRvIGJlIHNlZWtpbmcgbW9yZSBjYXJlIGZyb20gbWVudGFsIGhlYWx0aCBzZXJ2aWNlcy4KCgoKVGhpcyBjYXNlIHN0dWR5IHdpbGwgZXhwbG9yZSBob3cgcmF0ZXMgb2YgbWFqb3IgZGVwcmVzc2l2ZSBlcGlzb2RlcyBoYXZlIGNoYW5nZWQgc2luY2UgdGhlIGVhcmx5IDIwMDBzIGFuZCBhY3Jvc3MgZGlmZmVyZW50IHlvdXRoIHN1Ymdyb3VwcyAoYWdlLCBnZW5kZXIsIGV0aG5pY2l0eSkuIApXZSBhbHNvIHdpbGwgZXhwbG9yZSBob3cgcmF0ZXMgb2YgdHJlYXRtZW50IGZvciBkZXByZXNzaW9uIG9mIHlvdXRocyBoYXZlIGNoYW5nZWQgb3ZlciB0aW1lLgoKCmBgYHtyLGVjaG8gPSBGQUxTRSwgb3V0LndpZHRoPSI0MCUifQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCAiay1taXRjaC1ob2RnZS1JcVNhRzl6djJlMC11bnNwbGFzaC5qcGciKSkKYGBgCjxzcGFuPlBob3RvIGJ5IDxhIGhyZWY9Imh0dHBzOi8vdW5zcGxhc2guY29tL0BrbWl0Y2hob2RnZT91dG1fc291cmNlPXVuc3BsYXNoJmFtcDt1dG1fbWVkaXVtPXJlZmVycmFsJmFtcDt1dG1fY29udGVudD1jcmVkaXRDb3B5VGV4dCI+Sy4gTWl0Y2ggSG9kZ2U8L2E+IG9uIDxhIGhyZWY9Imh0dHBzOi8vdW5zcGxhc2guY29tL3MvcGhvdG9zL2RlcHJlc3Npb24/dXRtX3NvdXJjZT11bnNwbGFzaCZhbXA7dXRtX21lZGl1bT1yZWZlcnJhbCZhbXA7dXRtX2NvbnRlbnQ9Y3JlZGl0Q29weVRleHQiPlVuc3BsYXNoPC9hPjwvc3Bhbj4gIAoKClRoZSBtYWpvciBzeW1wdG9tcyBvZiBhIG1ham9yIGRlcHJlc3NpdmUgZXBpc29kZSBpbmNsdWRlOiAgIAoKKipTKipsZWVwIGRpc29yZGVyIChpbmNyZWFzZWQgb3IgZGVjcmVhc2VkKSAgCioqSSoqbnRlcmVzdCBkZWZpY2l0IChhbmhlZG9uaWEpICAKKipHKip1aWx0ICh3b3J0aGxlc3NuZXNzLCBob3BlbGVzc25lc3MsIHJlZ3JldCkgIAoqKkUqKm5lcmd5IGRlZmljaXQgIAoqKkMqKm9uY2VudHJhdGlvbiBkZWZpY2l0ICAKKipBKipwcGV0aXRlIGRpc29yZGVyIChpbmNyZWFzZWQgb3IgZGVjcmVhc2VkKSAgCioqUCoqc3ljaG9tb3RvciByZXRhcmRhdGlvbiBvciBhZ2l0YXRpb24gIAoqKlMqKnVpY2lkYWxpdHkgIAoKIyMjIyMgW1tzb3VyY2VdXShodHRwczovL3d3dy5pY3NpLm9yZy9ndWlkZWxpbmUvZGVwcmVzc2lvbi9kaWFnbm9zZS1hbmQtY2hhcmFjdGVyaXplLW1ham9yLWRlcHJlc3Npb24tcGVyc2lzdGVudC1kZXByZXNzaXZlLWRpc29yZGVyLXdpdGgtY2xpbmljYWwtaW50ZXJ2aWV3Lyl7dGFyZ2V0PSJfYmxhbmsifSAgCgoKYGBge3IsIGVjaG8gPSBGQUxTRSwgb3V0LndpZHRoPSI4MCUifQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCAiZGVwcmVzc2lvbi1zeW1wdG9tcy1hbmQtdHJlYXRtZW50LTc2OHg3NjguanBnIikpCmBgYAoKIyMjIyMgW1tzb3VyY2VdXShodHRwczovL25ld21pbGZvcmRjb3Vuc2VsaW5nY2VudGVyLmNvbS9kZXByZXNzaW9uLTIvKXt0YXJnZXQ9Il9ibGFuayJ9ICAKCioqKgoKPGRldGFpbHM+IDxzdW1tYXJ5PiBDbGljayBoZXJlIHRvIHNlZSB0aGUgZGlhZ25vc3RpYyByZXF1aXJlbWVudHMgZm9yIGEgbWFqb3IgZGVwcmVzc2l2ZSBlcGlzb2RlIChNU0UpIGFjY29yZGluZyB0byB0aGUgW0RTTSA1XShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9EU00tNSl7dGFyZ2V0PSJfYmxhbmsifS48L3N1bW1hcnk+ICAgIAoKQS4gRml2ZSBvciBtb3JlIG9mIHRoZSBmb2xsb3dpbmcgc3ltcHRvbXMgaGF2ZSBiZWVuIHByZXNlbnQgYW5kIGRvY3VtZW50ZWQgZHVyaW5nIHRoZSBzYW1lIHR3by13ZWVrIHBlcmlvZCBhbmQgcmVwcmVzZW50IGEgY2hhbmdlIGZyb20gcHJldmlvdXMgZnVuY3Rpb25pbmc7IGF0IGxlYXN0IG9uZSBvZiB0aGUgc3ltcHRvbXMgaXMgZWl0aGVyICgxKSBkZXByZXNzZWQgbW9vZCBvciAoMikgbG9zcyBvZiBpbnRlcmVzdCBvciBwbGVhc3VyZS4gIAoKKipOb3RlKio6IERvIG5vdCBpbmNsdWRlIHN5bXB0b21zIHRoYXQgYXJlIGNsZWFybHkgYXR0cmlidXRhYmxlIHRvIGFub3RoZXIgbWVkaWNhbCBjb25kaXRpb24uICAKCjEuIERlcHJlc3NlZCBtb29kIG1vc3Qgb2YgdGhlIGRheSwgbmVhcmx5IGV2ZXJ5IGRheSwgYXMgaW5kaWNhdGVkIGJ5IGVpdGhlciBzdWJqZWN0aXZlIHJlcG9ydCAoZS5nLiwgZmVlbHMgc2FkLCBlbXB0eSwgaG9wZWxlc3MpIG9yIG9ic2VydmF0aW9uIG1hZGUgYnkgb3RoZXJzIChlLmcuLCBhcHBlYXJzIHRlYXJmdWwpICAKCjIuIE1hcmtlZGx5IGRpbWluaXNoZWQgaW50ZXJlc3Qgb3IgcGxlYXN1cmUgaW4gYWxsLCBvciBhbG1vc3QgYWxsLCBhY3Rpdml0aWVzIG1vc3Qgb2YgdGhlIGRheSwgbmVhcmx5IGV2ZXJ5IGRheSAoYXMgaW5kaWNhdGVkIGJ5IGVpdGhlciBzdWJqZWN0aXZlIGFjY291bnQgb3Igb2JzZXJ2YXRpb24pICAKCjMuIFNpZ25pZmljYW50IHdlaWdodCBsb3NzIHdoZW4gbm90IGRpZXRpbmcgb3Igd2VpZ2h0IGdhaW4gKGUuZy4sIGEgY2hhbmdlIG9mIG1vcmUgdGhhbiA1JSBvZiBib2R5IHdlaWdodCBpbiBhIG1vbnRoKSwgb3IgZGVjcmVhc2Ugb3IgaW5jcmVhc2UgaW4gYXBwZXRpdGUgbmVhcmx5IGV2ZXJ5IGRheSAgCgo0LiBJbnNvbW5pYSBvciBoeXBlcnNvbW5pYSBuZWFybHkgZXZlcnkgZGF5ICAKCjUuIFBzeWNob21vdG9yIGFnaXRhdGlvbiBvciByZXRhcmRhdGlvbiBuZWFybHkgZXZlcnkgZGF5IChvYnNlcnZhYmxlIGJ5IG90aGVycywgbm90IG1lcmVseSBzdWJqZWN0aXZlIGZlZWxpbmdzIG9mIHJlc3RsZXNzbmVzcyBvciBiZWluZyBzbG93ZWQgZG93bikgIAoKNi4gRmF0aWd1ZSBvciBsb3NzIG9mIGVuZXJneSBuZWFybHkgZXZlcnkgZGF5ICAKCjcuIEZlZWxpbmdzIG9mIHdvcnRobGVzc25lc3Mgb3IgZXhjZXNzaXZlIG9yIGluYXBwcm9wcmlhdGUgZ3VpbHQgKHdoaWNoIG1heSBiZSBkZWx1c2lvbmFsKSBuZWFybHkgZXZlcnkgZGF5IChub3QgbWVyZWx5IHNlbGYtcmVwcm9hY2ggb3IgZ3VpbHQgYWJvdXQgYmVpbmcgc2ljaykgIAoKOC4gRGltaW5pc2hlZCBhYmlsaXR5IHRvIHRoaW5rIG9yIGNvbmNlbnRyYXRlLCBvciBpbmRlY2lzaXZlbmVzcywgbmVhcmx5IGV2ZXJ5IGRheSAoZWl0aGVyIGJ5IHN1YmplY3RpdmUgYWNjb3VudCBvciBhcyBvYnNlcnZlZCBieSBvdGhlcnMpICAKCjkuIFJlY3VycmVudCB0aG91Z2h0cyBvZiBkZWF0aCAobm90IGp1c3QgZmVhciBvZiBkeWluZyksIHJlY3VycmVudCBzdWljaWRhbCBpZGVhdGlvbiB3aXRob3V0IGEgc3BlY2lmaWMgcGxhbiwgb3IgYSBzdWljaWRlIGF0dGVtcHQgb3IgYSBzcGVjaWZpYyBwbGFuIGZvciBjb21taXR0aW5nIHN1aWNpZGUgIAoKQi4gVGhlIHN5bXB0b21zIGRvIG5vdCBtZWV0IGNyaXRlcmlhIGZvciBhIG1peGVkIGVwaXNvZGUuICAKCkMuIFRoZSBlcGlzb2RlIGlzIG5vdCBhdHRyaWJ1dGFibGUgdG8gdGhlIHBoeXNpb2xvZ2ljYWwgZWZmZWN0cyBvZiBhIHN1YnN0YW5jZSBvciB0byBhbm90aGVyIG1lZGljYWwgY29uZGl0aW9uLiAgCgoqKk5vdGUqKjogQ3JpdGVyaWEgQS1DIHJlcHJlc2VudCBhIG1ham9yIGRlcHJlc3NpdmUgZXBpc29kZS4gIAoKKipOb3RlKio6IFJlc3BvbnNlcyB0byBhIHNpZ25pZmljYW50IGxvc3MgKGUuZy4sIGJlcmVhdmVtZW50LCBmaW5hbmNpYWwgcnVpbiwgbG9zc2VzIGZyb20gYSBuYXR1cmFsIGRpc2FzdGVyLCBhIHNlcmlvdXMgbWVkaWNhbCBpbGxuZXNzIG9yIGRpc2FiaWxpdHkpIG1heSBpbmNsdWRlIGZlZWxpbmdzIG9mIGludGVuc2Ugc2FkbmVzcywgcnVtaW5hdGlvbiBhYm91dCB0aGUgbG9zcywgaW5zb21uaWEsIHBvb3IgYXBwZXRpdGUgYW5kIHdlaWdodCBsb3NzIG5vdGVkIGluIENyaXRlcmlvbiBBLCB3aGljaCBtYXkgcmVzZW1ibGUgYSBkZXByZXNzaXZlIGVwaXNvZGUuIEFsdGhvdWdoIHN1Y2ggc3ltcHRvbXMgbWF5IGJlIHVuZGVyc3RhbmRhYmxlIG9yIGNvbnNpZGVyZWQgYXBwcm9wcmlhdGUgdG8gdGhlIGxvc3MsIHRoZSBwcmVzZW5jZSBvZiBhIG1ham9yIGRlcHJlc3NpdmUgZXBpc29kZSBpbiBhZGRpdGlvbiB0byB0aGUgbm9ybWFsIHJlc3BvbnNlIHRvIGEgc2lnbmlmaWNhbnQgbG9zcyBzaG91bGQgYWxzbyBiZSBjYXJlZnVsbHkgY29uc2lkZXJlZC4gVGhpcyBkZWNpc2lvbiBpbmV2aXRhYmx5IHJlcXVpcmVzIHRoZSBleGVyY2lzZSBvZiBjbGluaWNhbCBqdWRnbWVudCBiYXNlZCBvbiB0aGUgaW5kaXZpZHVhbOKAmXMgaGlzdG9yeSBvZiBhbmQgdGhlIGN1bHR1cmFsIG5vcm1zIGZvciB0aGUgZXhwcmVzc2lvbiBvZiBkaXN0cmVzcyBpbiB0aGUgY29udGV4dCBvZiBsb3NzLiAgCgpELiBUaGUgb2NjdXJyZW5jZSBvZiB0aGUgbWFqb3IgZGVwcmVzc2l2ZSBlcGlzb2RlIGlzIG5vdCBiZXR0ZXIgZXhwbGFpbmVkIGJ5IHNjaGl6b2FmZmVjdGl2ZSBkaXNvcmRlciwgc2NoaXpvcGhyZW5pYSwgc2NoaXpvcGhyZW5pZm9ybSBkaXNvcmRlciwgZGVsdXNpb25hbCBkaXNvcmRlciwgb3Igb3RoZXIgc3BlY2lmaWVkIGFuZCB1bnNwZWNpZmllZCBzY2hpem9waHJlbmlhIHNwZWN0cnVtIGFuZCBvdGhlciBwc3ljaG90aWMgZGlzb3JkZXJzLiAgCgpFLiBUaGVyZSBoYXMgbmV2ZXIgYmVlbiBhIG1hbmljIGVwaXNvZGUgb3IgYSBoeXBvbWFuaWMgZXBpc29kZS4gIAoKTm90ZTogVGhpcyBleGNsdXNpb24gZG9lcyBub3QgYXBwbHkgaWYgYWxsIG9mIHRoZSBtYW5pYy1saWtlIG9yIGh5cG9tYW5pYy1saWtlIGVwaXNvZGVzIGFyZSBzdWJzdGFuY2UtaW5kdWNlZCBvciBhcmUgYXR0cmlidXRhYmxlIHRvIHRoZSBwaHlzaW9sb2dpY2FsIGVmZmVjdHMgb2YgYW5vdGhlciBtZWRpY2FsIGNvbmRpdGlvbi4gIAoKIyMjIyBbW3NvdXJjZV1dKGh0dHBzOi8vd3d3Lmljc2kub3JnL2d1aWRlbGluZS9kZXByZXNzaW9uL2RpYWdub3NlLWFuZC1jaGFyYWN0ZXJpemUtbWFqb3ItZGVwcmVzc2lvbi1wZXJzaXN0ZW50LWRlcHJlc3NpdmUtZGlzb3JkZXItd2l0aC1jbGluaWNhbC1pbnRlcnZpZXcvKXt0YXJnZXQ9Il9ibGFuayJ9Cgo8L2RldGFpbHM+ICAKCgoqKiogICAKCgpUaGlzIGNhc2Ugc3R1ZHkgaXMgbW90aXZhdGVkIGJ5IHRoZSBmb2xsb3dpbmcgdHdvIGFydGljbGVzOiAgCgojIyMjIHsucmVmZXJlbmNlX2Jsb2NrfQoKVHdlbmdlIEpNLCBDb29wZXIgQUIsIEpvaW5lciBURSwgRHVmZnkgTUUsIEJpbmF1IFNHLiBBZ2UsIHBlcmlvZCwgYW5kIGNvaG9ydCB0cmVuZHMgaW4gbW9vZCBkaXNvcmRlciBpbmRpY2F0b3JzIGFuZCBzdWljaWRlLXJlbGF0ZWQgb3V0Y29tZXMgaW4gYSBuYXRpb25hbGx5IHJlcHJlc2VudGF0aXZlIGRhdGFzZXQsIDIwMDUtMjAxNy4gKkogQWJub3JtIFBzeWNob2wqLjEyOCwzICgyMDE5KToxODUtMTk5LiBkb2k6MTAuMTAzNy9hYm4wMDAwNDEwCgoKT2xmc29uLCBNLiwgQmxhbmNvLCBDLiwgV2FuZywgUy4sIExhamUsIEcuICYgQ29ycmVsbCwgQy4gVS4gTmF0aW9uYWwgVHJlbmRzIGluIHRoZSBNZW50YWwgSGVhbHRoIENhcmUgb2YgQ2hpbGRyZW4sIEFkb2xlc2NlbnRzLCBhbmQgQWR1bHRzIGJ5IE9mZmljZS1CYXNlZCBQaHlzaWNpYW5zLiAqSkFNQSBQc3ljaGlhdHJ5Ki4gNzEsIDgxICgyMDE0KTo4MS05MC4gZG9pOiAxMC4xMDAxL2phbWFwc3ljaGlhdHJ5LjIwMTMuMzA3NC4KCiMjIyMKClRoZSBtYWluIGZpbmRpbmdzIG9mIHRoZSBmaXJzdCBbYXJ0aWNsZV0oaHR0cHM6Ly9jb250ZW50LmFwYS5vcmcvcmVjb3JkLzIwMTktMTI1NzgtMDAxKXt0YXJnZXQ9Il9ibGFuayJ9IGFyZToKCj4gUmF0ZXMgb2YgbWFqb3IgZGVwcmVzc2l2ZSBlcGlzb2RlIGluIHRoZSBsYXN0IHllYXIgaW5jcmVhc2VkIDUyJSAyMDA14oCTMjAxNyAoZnJvbSA4LjclIHRvIDEzLjIlKSBhbW9uZyBhZG9sZXNjZW50cyBhZ2VkIDEyIHRvIDE3IGFuZCA2MyUgMjAwOeKAkzIwMTcgKGZyb20gOC4xJSB0byAxMy4yJSkgYW1vbmcgeW91bmcgYWR1bHRzIDE44oCTMjUuIAoKPiBTZXJpb3VzIHBzeWNob2xvZ2ljYWwgZGlzdHJlc3MgaW4gdGhlIGxhc3QgbW9udGggYW5kIHN1aWNpZGUtcmVsYXRlZCBvdXRjb21lcyAoc3VpY2lkYWwgaWRlYXRpb24sIHBsYW5zLCBhdHRlbXB0cywgYW5kIGRlYXRocyBieSBzdWljaWRlKSBpbiB0aGUgbGFzdCB5ZWFyIGFsc28gaW5jcmVhc2VkIGFtb25nIHlvdW5nIGFkdWx0cyAxOOKAkzI1IGZyb20gMjAwOOKAkzIwMTcgKHdpdGggYSA3MSUgaW5jcmVhc2UgaW4gc2VyaW91cyBwc3ljaG9sb2dpY2FsIGRpc3RyZXNzKSwgd2l0aCBsZXNzIGNvbnNpc3RlbnQgYW5kIHdlYWtlciBpbmNyZWFzZXMgYW1vbmcgYWR1bHRzIGFnZXMgMjYgYW5kIG92ZXIuIAoKPiBDdWx0dXJhbCB0cmVuZHMgY29udHJpYnV0aW5nIHRvIGFuIGluY3JlYXNlIGluIG1vb2QgZGlzb3JkZXJzIGFuZCBzdWljaWRhbCB0aG91Z2h0cyBhbmQgYmVoYXZpb3JzIHNpbmNlIHRoZSBtaWQtMjAwMHMsIGluY2x1ZGluZyB0aGUgcmlzZSBvZiBlbGVjdHJvbmljIGNvbW11bmljYXRpb24gYW5kIGRpZ2l0YWwgbWVkaWEgYW5kIGRlY2xpbmVzIGluIHNsZWVwIGR1cmF0aW9uLCBtYXkgaGF2ZSBoYWQgYSBsYXJnZXIgaW1wYWN0IG9uIHlvdW5nZXIgcGVvcGxlLCBjcmVhdGluZyBhIGNvaG9ydCBlZmZlY3QuCgpXaGlsZSB0aGUgbWFpbiBmaW5kaW5ncyBvZiB0aGUgc2Vjb25kIFthcnRpY2xlXShodHRwczovL3B1Ym1lZC5uY2JpLm5sbS5uaWguZ292LzI0Mjg1MzgyLyl7dGFyZ2V0PSJfYmxhbmsifSBhcmU6Cgo+IENvbXBhcmVkIHdpdGggYWR1bHQgbWVudGFsIGhlYWx0aCBjYXJlLCB0aGUgbWVudGFsIGhlYWx0aApjYXJlIG9mIHlvdW5nIHBlb3BsZSBoYXMgaW5jcmVhc2VkIG1vcmUgcmFwaWRseS4KCj4gQmV0d2VlbiAxOTk1LTE5OTggYW5kIDIwMDctMjAxMCwgdmlzaXRzIHJlc3VsdGluZyBpbiBtZW50YWwgZGlzb3JkZXIgZGlhZ25vc2VzCnBlciAxMDAgcG9wdWxhdGlvbiBpbmNyZWFzZWQgc2lnbmlmaWNhbnRseSBmYXN0ZXIgZm9yIHlvdXRocyAoZnJvbSA3Ljc4IHRvIDE1LjMwIHZpc2l0cykgdGhhbiBmb3IKYWR1bHRzIChmcm9tIDIzLjIzIHRvIDI4LjQ4IHZpc2l0cykgKGludGVyYWN0aW9uOiBQIDwgLjAwMSkuIAoKPiBQc3ljaGlhdHJpc3QgdmlzaXRzIGFsc28gaW5jcmVhc2VkCnNpZ25pZmljYW50bHkgZmFzdGVyIGZvciB5b3V0aHMgKGZyb20gMi44NiB0byA1LjcxIHZpc2l0cykuCgoKKipTdW1tYXJ5Kio6IFdoaWxlIGRlcHJlc3Npb24gYXBwZWFyIHRvIGJlIG9uIHRoZSByaXNlIGZvciB5b3V0aHMsIHlvdXRocyBhbHNvIGFwcGVhciB0byBiZSBzZWVraW5nIG1vcmUgbWVudGFsIGhlYWx0aCBjYXJlLgoKSW4gdGhpcyBjYXNlIHN0dWR5LCB3ZSB3aWxsIGJlIHVzaW5nIGRhdGEgZnJvbSB0aGUgW05hdGlvbmFsIFN1cnZleSBvbiBEcnVnIFVzZSBhbmQgSGVhbHRoIChOU0RVSCldKGh0dHBzOi8vbnNkdWh3ZWIucnRpLm9yZy9yZXNwd2ViL2hvbWVwYWdlLmNmbSl7dGFyZ2V0PSJfYmxhbmsifSByZWxhdGVkIHRvIHRyZWF0bWVudCBhbmQgbWFqb3IgZGVwcmVzc2l2ZSBlcGlzb2RlIChNREUpIHJhdGUgdG8gZXhwbG9yZSBob3cgdGhpcyBoYXZlIGNoYW5nZWQgb3ZlciB0aW1lIGFuZCBob3cgZGlmZmVyZW50IGdyb3VwcyBjb21wYXJlLiAKVGhpcyBkYXRhIHdhcyBhbHNvIHVzZWQgaW4gdGhlIGZpcnN0IHJlZmVyZW5jZWQgYXJ0aWNsZS4gIAoKCiMjICoqTWFpbiBRdWVzdGlvbnMqKgoqKiogCgojIyMjIHsubWFpbl9xdWVzdGlvbl9ibG9ja30KPGI+PHU+IE91ciBtYWluIHF1ZXN0aW9uczogPC91PjwvYj4KCjEuIEhvdyBoYXZlIGRlcHJlc3Npb24gcmF0ZXMgaW4gQW1lcmljYW4geW91dGggY2hhbmdlZCBzaW5jZSAyMDA0LCBhY2NvcmRpbmcgdG8gdGhlIE5TRFVIIGRhdGE/IEhvdyBoYXZlIHJhdGVzIGRpZmZlcmVkIGJldHdlZW4gZGlmZmVyZW50IHlvdXRoIHN1Ymdyb3VwcyAoYWdlLCBnZW5kZXIsIGV0aG5pY2l0eSk/CjIuIERvIG1lbnRhbCBoZWFsdGggc2VydmljZXMgYXBwZWFyIHRvIGJlIHJlYWNoaW5nIG1vcmUgeW91dGhzPyBBZ2FpbiwgaG93IGhhdmUgcmF0ZXMgZGlmZmVyZWQgYmV0d2VlbiBkaWZmZXJlbnQgeW91dGggc3ViZ3JvdXBzIChhZ2UsIGdlbmRlciwgZXRobmljaXR5KT8KCiMjIyMKCiMjICoqTGVhcm5pbmcgT2JqZWN0aXZlcyoqIAoqKiogClRoZSBza2lsbHMsIG1ldGhvZHMsIGFuZCBjb25jZXB0cyB0aGF0IHN0dWRlbnRzIHdpbGwgYmUgZmFtaWxpYXIgd2l0aCBieSB0aGUgZW5kIG9mIHRoaXMgY2FzZSBzdHVkeSBhcmU6Cgo8dT4qKlN0YXRpc3RpY2FsIExlYXJuaW5nIE9iamVjdGl2ZXM6Kio8L3U+IAoKMS4gRGlzY3VzcyB0aGUgaW1wYWN0IGFuZCBvZiBzZWxmLXJlcG9ydGluZyBiaWFzIG9uIHN1cnZleSByZXNwb25zZXMuCjIuIERlZmluZSBhbmQgY3JlYXRlIGEgY29udGluZ2VuY3kgdGFibGUuCjMuIEltcGxlbWVudGF0aW9uIG9mIGEgY2hpLXNxdWFyZWQgdGVzdCBmb3IgaW5kZXBlbmRlbmNlLgo0LiBJbnRlcnByZXRhdGlvbiBvZiBhIGNoaS1zcXVhcmVkIHRlc3QgZm9yIGluZGVwZW5kZW5jZS4KCjx1PioqRGF0YSBzY2llbmNlIExlYXJuaW5nIE9iamVjdGl2ZXM6Kio8L3U+CgoxLiBTY3JhcGUgZGF0YSBkaXJlY3RseSBmcm9tIGEgd2Vic2l0ZSAoYHJ2ZXN0YCkuCjIuIFN1YnNldCBhbmQgZmlsdGVyIGRhdGEgKGBkcGx5cmApLgozLiBXcml0ZSBmdW5jdGlvbnMgdG8gd3JhbmdsZSBkYXRhIHJlcGV0aXRpdmVseS4KNC4gV29yayB3aXRoIGNoYXJhY3RlciBzdHJpbmdzIChgc3RyaW5ncmApLgo1LiBSZXNoYXBlIGRhdGEgaW50byBkaWZmZXJlbnQgZm9ybWF0cyAoYHRpZHlyYCkuCjYuIERhdGEgdmlzdWFsaXphdGlvbnMgKGBnZ3Bsb3QyYCkgd2l0aCBsYWJlbHMgKGBkaXJlY3RsYWJlbHNgKSBhbmQgZmFjZXRzIGZvciBkaWZmZXJlbnQgZ3JvdXBzLgo3LiBDb21iaW5lIG11bHRpcGxlIHBsb3RzIChgY293cGxvdGApLgo4LiBPcHRpb25hbDogQ3JlYXRlIGFuIGFuaW1hdGVkIGdpZiAoYG1hZ2lja2ApLgoKCkluIHRoaXMgY2FzZSBzdHVkeSwgd2Ugd2lsbCBlc3BlY2lhbGx5IGZvY3VzIG9uIHVzaW5nIHBhY2thZ2VzIGFuZCBmdW5jdGlvbnMgZnJvbSB0aGUgW2BUaWR5dmVyc2VgXShodHRwczovL3d3dy50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSwgc3VjaCBhcyBbYHJ2ZXN0YF0oaHR0cHM6Ly9naXRodWIuY29tL3RpZHl2ZXJzZS9ydmVzdCl7dGFyZ2V0PSJfYmxhbmsifS4gVGhlIHRpZHl2ZXJzZSBpcyBhIGxpYnJhcnkgb2YgcGFja2FnZXMgY3JlYXRlZCBieSBSU3R1ZGlvLiBXaGlsZSBzb21lIHN0dWRlbnRzIG1heSBiZSBmYW1pbGlhciB3aXRoIHByZXZpb3VzIFIgcHJvZ3JhbW1pbmcgcGFja2FnZXMsIHRoZXNlIHBhY2thZ2VzIG1ha2UgZGF0YSBzY2llbmNlIGluIFIgbW9yZSBsZWdpYmxlIGFuZCBpbnR1aXRpdmUuCgoKYGBge3IsIG91dC53aWR0aCA9ICIyMCUiLCBlY2hvID0gRkFMU0UsIGZpZy5hbGlnbiA9ImNlbnRlciJ9CmluY2x1ZGVfZ3JhcGhpY3MoImh0dHBzOi8vdGlkeXZlcnNlLnRpZHl2ZXJzZS5vcmcvbG9nby5wbmciKQpgYGAKCioqKiAKCldlIHdpbGwgYmVnaW4gYnkgbG9hZGluZyB0aGUgcGFja2FnZXMgdGhhdCB3ZSB3aWxsIG5lZWQ6CgpgYGB7cn0KbGlicmFyeShoZXJlKQpsaWJyYXJ5KHJ2ZXN0KQpsaWJyYXJ5KGRwbHlyKQpsaWJyYXJ5KG1hZ3JpdHRyKQpsaWJyYXJ5KHN0cmluZ3IpCmxpYnJhcnkodGlkeXIpCmxpYnJhcnkodGliYmxlKQpsaWJyYXJ5KGdncGxvdDIpCmxpYnJhcnkoZGlyZWN0bGFiZWxzKQpsaWJyYXJ5KGZvcmNhdHMpCmxpYnJhcnkoY293cGxvdCkKYGBgCgoKCiBQYWNrYWdlICAgfCBVc2UgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCi0tLS0tLS0tLS0gfC0tLS0tLS0tLS0tLS0KW2hlcmVdKGh0dHBzOi8vZ2l0aHViLmNvbS9qZW5ueWJjL2hlcmVfaGVyZSl7dGFyZ2V0PSJfYmxhbmsifSAgICAgICB8IHRvIGVhc2lseSBsb2FkIGFuZCBzYXZlIGRhdGEgIApbcnZlc3RdKGh0dHBzOi8vZ2l0aHViLmNvbS90aWR5dmVyc2UvcnZlc3Qpe3RhcmdldD0iX2JsYW5rIn0gICAgICB8IHRvIHNjcmFwZSB3ZWIgcGFnZXMgIApbZHBseXJdKGh0dHBzOi8vZHBseXIudGlkeXZlcnNlLm9yZy8pe3RhcmdldD0iX2JsYW5rIn0gICAgICB8IHRvIHNjcmFwZSB3ZWIgcGFnZXMgIApbbWFncml0dHJdKGh0dHBzOi8vbWFncml0dHIudGlkeXZlcnNlLm9yZy8pe3RhcmdldD0iX2JsYW5rIn0gICAgICB8IHRvIHNjcmFwZSB3ZWIgcGFnZXMgIApbc3RyaW5ncl0oaHR0cHM6Ly9zdHJpbmdyLnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICAgfCB0byBtYW5pcHVsYXRlIHN0cmluZ3MgIApbdGlkeXJdKGh0dHBzOi8vdGlkeXIudGlkeXZlcnNlLm9yZy8pe3RhcmdldD0iX2JsYW5rIn0gICAgICB8IHRvIGNoYW5nZSB0aGUgc2hhcGUgb3IgZm9ybWF0IG9mIHRpYmJsZXMgdG8gd2lkZSBhbmQgbG9uZyAgClt0aWJibGVdKGh0dHBzOi8vdGliYmxlLnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICAgfCB0byBjcmVhdGUgdGliYmxlcyBhbmQgY29udmVydCB2YWx1ZXMgb2YgYSBjb2x1bW4gdG8gcm93IG5hbWVzICAKW2dncGxvdDJdKGh0dHBzOi8vZ2dwbG90Mi50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgICAgIHwgdG8gY3JlYXRlIHBsb3RzICAKW2RpcmVjdGxhYmVsc10oaHR0cDovL2RpcmVjdGxhYmVscy5yLWZvcmdlLnItcHJvamVjdC5vcmcvZG9jcy9pbmRleC5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICAgfCB0byBhZGQgbGFiZWxzIGRpcmVjdGx5IHRvIGxpbmVzIGluIHBsb3RzICAKW2ZvcmNhdHNdKGh0dHBzOi8vZm9yY2F0cy50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgICAgIHwgdG8gcmVvcmRlciBmYWN0b3IgZm9yIHBsb3QgIApbY293cGxvdF0oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL2Nvd3Bsb3QvdmlnbmV0dGVzL2ludHJvZHVjdGlvbi5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICAgfCB0byBjb21iaW5lIHBsb3RzIHRvZ2V0aGVyICAKCgpUaGUgZmlyc3QgdGltZSB3ZSB1c2UgYSBmdW5jdGlvbiwgd2Ugd2lsbCB1c2UgdGhlIGA6OmAgdG8gaW5kaWNhdGUgd2hpY2ggcGFja2FnZSB3ZSBhcmUgdXNpbmcuIFVubGVzcyB3ZSBoYXZlIG92ZXJsYXBwaW5nIGZ1bmN0aW9uIG5hbWVzLCB0aGlzIGlzIG5vdCBuZWNlc3NhcnksIGJ1dCB3ZSB3aWxsIGluY2x1ZGUgaXQgaGVyZSB0byBiZSBpbmZvcm1hdGl2ZSBhYm91dCB3aGVyZSB0aGUgZnVuY3Rpb25zIHdlIHdpbGwgdXNlIGNvbWUgZnJvbS4KCiMjICoqQ29udGV4dCoqCioqKiAKClRvIG1vdGl2YXRlIHRoZSBleGFtaW5hdGlvbiBvZiB0aGUgbWVudGFsIGhlYWx0aCBvZiBBbWVyaWNhbiB5b3V0aHMsIHdlIGJlZ2luIGJ5IGV4cGxvcmluZyB0aGUgcmF0ZSBvZiBzdWljaWRlIGluIHRoZSBVbml0ZWQgU3RhdGVzIChVUykuIApBY2NvcmRpbmcgdG8gdGhlIENEQyB0aGUgcmF0ZSBvZiBzdWljaWRlIGhhcyBpbmNyZWFzZWQgZm9yIGJvdGggZ2VuZGVycy4KCgpgYGB7ciwgb3V0LndpZHRoID0gIjgwJSIsIGVjaG8gPSBGQUxTRSwgZmlnLmFsaWduID0iY2VudGVyIn0KaW5jbHVkZV9ncmFwaGljcygiaHR0cHM6Ly93d3cuY2RjLmdvdi9uY2hzL2ltYWdlcy9kYXRhYnJpZWZzLzMwMS0zNTAvZGIzMDlfZmlnMS5wbmciKQpgYGAKCiMjIyMjIFtbc291cmNlXV0oaHR0cHM6Ly93d3cuY2RjLmdvdi9uY2hzL3Byb2R1Y3RzL2RhdGFicmllZnMvZGIzMDkuaHRtKXt0YXJnZXQ9Il9ibGFuayJ9CgoKV2hpbGUgc3VpY2lkZSBkb2VzIGFwcGVhciB0byBiZSBpbmNyZWFzaW5nIGFtb25nIHlvdXRocyBpdCBhbHNvIGFwcGVhcnMgdG8gYmUgaW5jcmVhc2luZyBhbW9uZyBtb3N0IGFnZSBncm91cHMgaW4gdGhlIFVTIG92ZXIgdGhlIHBhc3QgZGVjYWRlIGFuZCBhIGhhbGYgZm9yIGJvdGggZmVtYWxlczogCgpgYGB7ciwgb3V0LndpZHRoID0gIjgwJSIsIGVjaG8gPSBGQUxTRSwgZmlnLmFsaWduID0iY2VudGVyIn0KaW5jbHVkZV9ncmFwaGljcygiaHR0cHM6Ly93d3cuY2RjLmdvdi9uY2hzL2ltYWdlcy9kYXRhYnJpZWZzLzMwMS0zNTAvZGIzMDlfZmlnMi5wbmciKQpgYGAKCiMjIyMjIFtbc291cmNlXV0oaHR0cHM6Ly93d3cuY2RjLmdvdi9uY2hzL3Byb2R1Y3RzL2RhdGFicmllZnMvZGIzMDkuaHRtKXt0YXJnZXQ9Il9ibGFuayJ9CgoKYW5kIG1hbGVzOgoKYGBge3IsIG91dC53aWR0aCA9ICI4MCUiLCBlY2hvID0gRkFMU0UsIGZpZy5hbGlnbiA9ImNlbnRlciJ9CmluY2x1ZGVfZ3JhcGhpY3MoImh0dHBzOi8vd3d3LmNkYy5nb3YvbmNocy9pbWFnZXMvZGF0YWJyaWVmcy8zMDEtMzUwL2RiMzA5X2ZpZzMucG5nIikKYGBgCgojIyMjIyBbW3NvdXJjZV1dKGh0dHBzOi8vd3d3LmNkYy5nb3YvbmNocy9wcm9kdWN0cy9kYXRhYnJpZWZzL2RiMzA5Lmh0bSl7dGFyZ2V0PSJfYmxhbmsifQoKCkFjY29yZGluZyB0byB0aGUgW0NEQ10oaHR0cHM6Ly93d3cuY2RjLmdvdi9uY2hzL3Byb2R1Y3RzL2RhdGFicmllZnMvZGIzMDkuaHRtKXt0YXJnZXQ9Il9ibGFuayJ9OgoKPiBTaW5jZSAyMDA4LCBzdWljaWRlIGhhcyByYW5rZWQgYXMgdGhlIDEwdGggbGVhZGluZyBjYXVzZSBvZiBkZWF0aCBmb3IgKiphbGwgYWdlcyoqIGluIHRoZSBVbml0ZWQgU3RhdGVzLiAKCmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aD0iODAwcHgifQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCJtb3J0YWxpdHkucG5nIikpCmBgYAoKIyMjIyMgW1tzb3VyY2VdXShodHRwczovL3d3dy5jZGMuZ292L25jaHMvZGF0YS9kYXRhYnJpZWZzL2RiMjkzLnBkZil7dGFyZ2V0PSJfYmxhbmsifSAgIAoKRnVydGhlcm1vcmUsIGFjY29yZGluZyB0byB0aGUgW0NEQ10oaHR0cHM6Ly93d3cuY2RjLmdvdi9uY2hzL3Byb2R1Y3RzL2RhdGFicmllZnMvZGIzMDkuaHRtKXt0YXJnZXQ9Il9ibGFuayJ9OgoKPkluIDIwMTYsIHN1aWNpZGUgYmVjYW1lIHRoZSAqKnNlY29uZCBsZWFkaW5nIGNhdXNlIG9mIGRlYXRoKiogYW1vbmcgW3lvdXRoc10uCgoKKipTbyBhbHRob3VnaCBzdWljaWRlIGlzIG9uIHRoZSByaXNlIGZvciBtb3N0IGFnZSBncm91cHMsIHN1aWNpZGUgaXMgb25lIG9mIHRoZSB0b3AgKnR3byogY29udHJpYnV0b3JzIHRvIGRlYXRoIGZvciB5b3V0aHMuKiogICAKClRodXMsIHRoaXMgd2FycmFudHMgZnVydGhlciBleGFtaW5hdGlvbiBvZiB0aGUgbWVudGFsIGhlYWx0aCBvZiBBbWVyaWNhbiB5b3V0aHMuICAKCmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aD0iODAwcHgifQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCJtb3J0YWxpdHlfYWdlLnBuZyIpKQpgYGAKCiMjIyMjIFtbc291cmNlXV0oaHR0cHM6Ly93d3cuY2RjLmdvdi9uY2hzL2RhdGEvbnZzci9udnNyNjgvbnZzcjY4XzA2LTUwOC5wZGYpe3RhcmdldD0iX2JsYW5rIn0KCgpIaXN0b3JpY2FsbHksIHN1aWNpZGUgcmF0ZXMgd2VyZSBtdWNoIGhpZ2hlciBiZWZvcmUgMTk1MCwgaG93ZXZlciwgd2UgYXJlIHNlZWluZyBhbiBpbmNyZWFzZSBpbiB0aGUgbGFzdCAyMCB5ZWFycy4KCmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aD0iODAwcHgifQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCJzdWljaWRlLnBuZyIpKQpgYGAKCiMjIyMjIFtbc291cmNlXV0oaHR0cHM6Ly90aW1lLmNvbS81NjA5MTI0L3VzLXN1aWNpZGUtcmF0ZS1pbmNyZWFzZS8pe3RhcmdldD0iX2JsYW5rIn0KCgpCZXNpZGVzIHRoZSBVUywgW290aGVyIGNvdW50cmllc10oaHR0cHM6Ly9hY2FkZW1pYy5vdXAuY29tL2lqZS9hcnRpY2xlLzQ4LzUvMTY1MC81MzY2MjEwKXt0YXJnZXQ9Il9ibGFuayJ9IGFyZSBhbHNvIGV4cGVyaWVuY2luZyBpbmNyZWFzZWQgcmF0ZXMgb2YgZGVwcmVzc2lvbiBpbiB5b3V0aHMuIAoKU2VlIFt0aGlzIHJlcG9ydF0oaHR0cHM6Ly9hcHBzLndoby5pbnQvaXJpcy9iaXRzdHJlYW0vaGFuZGxlLzEwNjY1LzI1NDYxMC9XSE8tTVNELU1FUi0yMDE3LjItZW5nLnBkZjtqc2Vzc2lvbmlkPUU0NDM2MDA1NUREODNFQUM0NzJBQTQwQzI4NTNEQkZBP3NlcXVlbmNlPTEpe3RhcmdldD0iX2JsYW5rIn0gZnJvbSB0aGUgV29ybGQgSGVhbHRoIE9yZ2FuaXphdGlvbiAoV0hPKSBhYm91dCByYXRlcyBvZiBkZXByZXNzaW9uIGluIG90aGVyIGNvdW50cmllcy4KClNlZSBbaGVyZV0oaHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9wbWMvYXJ0aWNsZXMvUE1DMzMzMDE2MS8pe3RhcmdldD0iX2JsYW5rIn0gZm9yIGFuIGludGVyZXN0aW5nIGRpc2N1c3Npb24gYWJvdXQgd2hhdCBtYXkgYmUgY2F1c2luZyBpbmNyZWFzZWQgZGVwcmVzc2lvbiByYXRlcy4gCgoKQWNjb3JkaW5nIHRvIHRoZSBbTmF0aW9uYWwgSW5zdGl0dXRlIG9mIE1lbnRhbCBIZWFsdGggKE5JTUgpXShodHRwczovL3d3dy5uaW1oLm5paC5nb3YvaGVhbHRoL3B1YmxpY2F0aW9ucy90ZWVuLWRlcHJlc3Npb24vaW5kZXguc2h0bWwpe3RhcmdldD0iX2JsYW5rIn06CgoKIyMjIyB7LmVtcGhhc2lzX2Jsb2NrfQoKSWYgeW91IGFyZSBpbiBjcmlzaXMgYW5kIG5lZWQgaGVscCwgY2FsbCB0aGlzIHRvbGwtZnJlZSBudW1iZXIgZm9yIHRoZSAqKk5hdGlvbmFsIFN1aWNpZGUgUHJldmVudGlvbiBMaWZlbGluZSAoTlNQTCkqKiwgYXZhaWxhYmxlIDI0IGhvdXJzIGEgZGF5LCBldmVyeSBkYXk6ICoqMS04MDAtMjczLVRBTEsgKDgyNTUpKiouIFRoZSBzZXJ2aWNlIGlzIGF2YWlsYWJsZSB0byBldmVyeW9uZS4gVGhlIGRlYWYgYW5kIGhhcmQgb2YgaGVhcmluZyBjYW4gY29udGFjdCB0aGUgTGlmZWxpbmUgdmlhIFRUWSBhdCAxLTgwMC03OTktNDg4OS4gQWxsIGNhbGxzIGFyZSBjb25maWRlbnRpYWwuIFlvdSBjYW4gYWxzbyB2aXNpdCB0aGUgTGlmZWxpbmXigJlzIHdlYnNpdGUgYXQgW3d3dy5zdWljaWRlcHJldmVudGlvbmxpZmVsaW5lLm9yZ10od3d3LnN1aWNpZGVwcmV2ZW50aW9ubGlmZWxpbmUub3JnKXt0YXJnZXQ9Il9ibGFuayJ9LgoKVGhlICoqQ3Jpc2lzIFRleHQgTGluZSoqIGlzIGFub3RoZXIgZnJlZSwgY29uZmlkZW50aWFsIHJlc291cmNlIGF2YWlsYWJsZSAyNCBob3VycyBhIGRheSwgc2V2ZW4gZGF5cyBhIHdlZWsuIFRleHQg4oCcSE9NReKAnSB0byAqKjc0MTc0MSoqIGFuZCBhIHRyYWluZWQgY3Jpc2lzIGNvdW5zZWxvciB3aWxsIHJlc3BvbmQgdG8geW91IHdpdGggc3VwcG9ydCBhbmQgaW5mb3JtYXRpb24gb3ZlciB0ZXh0IG1lc3NhZ2UuIFZpc2l0IFt3d3cuY3Jpc2lzdGV4dGxpbmUub3JnXSh3d3cuY3Jpc2lzdGV4dGxpbmUub3JnKXt0YXJnZXQ9Il9ibGFuayJ9LgoKIyMjIwoKQWxzbyBzZWUgW2hlcmVdKGh0dHBzOi8vd3d3Lm1oYW5hdGlvbmFsLm9yZy9kZXByZXNzaW9uLXRlZW5zLTApe3RhcmdldD0iX2JsYW5rIn0gZm9yIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgaG93IHRvIHJlY29nbml6ZSBhbmQgaGVscCB5b3V0aHMgZXhwZXJpZW5jaW5nIHN5bXB0b21zIG9mIGRlcHJlc3Npb24uCgojIyAqKkxpbWl0YXRpb25zKioKKioqIAoKVGhlcmUgYXJlIHNvbWUgaW1wb3J0YW50IGNvbnNpZGVyYXRpb25zIHJlZ2FyZGluZyB0aGlzIGRhdGEgYW5hbHlzaXMgdG8ga2VlcCBpbiBtaW5kOiAKCjEuIFRoZSBkYXRhIHRoYXQgd2Ugd2lsbCB1c2UgY29tZSBmcm9tIGEgc3VydmV5IGFuZCBhcmUgdGhlcmVmb3JlIHZhbHVlcyBmcm9tIGEgc2FtcGxlIHRoYXQgZXN0aW1hdGUgdGhhdCBvZiB0aGUgdHJ1ZSBwb3B1bGF0aW9uLiBJbiBvdXIgc3RhdGlzdGljYWwgYW5hbHlzaXMgd2UgdXNlIHRoZXNlIHNhbXBsZSB2YWx1ZXMgYXMgaWYgdGhleSBhcmUgcG9wdWxhdGlvbiBlc3RpbWF0ZXMgKGJlY2F1c2UgdGhpcyBpcyBhbGwgd2UgaGF2ZSBhY2Nlc3MgdG8pLiBUaHVzLCBvdXIgcmVzdWx0cyBhcmUgbm90IG5lY2Vzc2FyaWx5IGluZGljYXRpdmUgb2YgcG9wdWxhdGlvbiBkaWZmZXJlbmNlcy4KCjIuIEZ1cnRoZXJtb3JlLCB0aGUgc2FtcGxpbmcgbWVjaGFuaXNtIHV0aWxpemVkIGZvciB0aGUgc3VydmV5IGNhbiBpbnRyb2R1Y2UgW3NlbGVjdGlvbiBiaWFzXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9TZWxlY3Rpb25fYmlhcz9vbGRmb3JtYXQ9dHJ1ZSl7dGFyZ2V0PSJfYmxhbmsifSBpbiBjYXNlcyB3aGVyZSB0aGUgdGhlIFtzYW1wbGluZyBtZXRob2RzIGRvIG5vdCBwcm9kdWNlIGEgcmVwcmVzZW50YXRpdmUgc2FtcGxlXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9TYW1wbGluZ18oc3RhdGlzdGljcyk/b2xkZm9ybWF0PXRydWUpe3RhcmdldD0iX2JsYW5rIn0uIAoKMy4gRGF0YSBhcmUgY29sbGVjdGVkIGZyb20gaHVtYW4gcGFydGljaXBhbnRzOyB0aGlzIHByZXNlbnRzIHRoZSAqcG90ZW50aWFsKiBmb3IgaW5mb3JtYXRpb24gYmlhcywgYXMgdGhlcmUgaXMgdGhlICpwb3RlbnRpYWwqIHRoYXQgcGFydGljaXBhbnRzIGluIHRoZSBbc2FtcGxpbmcgZnJhbWVdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1NhbXBsaW5nX2ZyYW1lP29sZGZvcm1hdD10cnVlKXt0YXJnZXQ9Il9ibGFuayJ9IG1heSBmb3IgYSB2YXJpZXR5IG9mIHJlYXNvbnMgcmVwb3J0IGluYWNjdXJhdGUgaW5mb3JtYXRpb24uIAoKCjQuIERhdGEgYWJvdXQgY2VydGFpbiBncm91cCBbaW50ZXJzZWN0aW9uc10oaHR0cHM6Ly93d3cudm94LmNvbS90aGUtaGlnaGxpZ2h0LzIwMTkvNS8yMC8xODU0Mjg0My9pbnRlcnNlY3Rpb25hbGl0eS1jb25zZXJ2YXRpc20tbGF3LXJhY2UtZ2VuZGVyLWRpc2NyaW1pbmF0aW9uKXt0YXJnZXQ9Il9ibGFuayJ9IChtZWFuaW5nIGZvciBleGFtcGxlIGluZGl2aWR1YWxzIG9mIGEgcGFydGljdWxhciBnZW5kZXIgYW5kIGV0aG5pY2l0eSkgb3IgcGFydGljdWxhciBncm91cHMgaW4gZ2VuZXJhbCBzdWNoIGFzIHNwZWNpZmljIGV0aG5pY2l0aWVzIG9yIGdlbmRlciBvciBzZXh1YWwgaWRlbnRpdHkgZ3JvdXBzIHN1Y2ggYXMgTEdCVCAobGVzYmlhbi9nYXkvYmlzZXh1YWwvdHJhbnNnZW5kZXIvcXVlZXIgYW5kIHF1ZXN0aW9uaW5nKSBvciBub24tYmluYXJ5IGdlbmRlciBwb3B1bGF0aW9ucyBpcyB1bmZvcnR1bmF0ZWx5IG5vdCBhdmFpbGFibGUgaW4gdGhlIGRhdGEgdXNlZCBpbiB0aGlzIGFuYWx5c2lzIGFuZCBpbiBtb3N0IHJlc2VhcmNoIGFib3V0IHRoaXMgdG9waWMuCgoKTm90ZTogV2hpbGUgW2dlbmRlciBhbmQgc2V4XShodHRwczovL3d3dy53aG8uaW50L2dlbm9taWNzL2dlbmRlci9lbi9pbmRleDEuaHRtbCkgYXJlIG5vdCBhY3R1YWxseSBiaW5hcnksIHRoZSBkYXRhIHVzZWQgaW4gdGhpcyBhbmFseXNpcyB1bmZvcnR1bmF0ZWx5IG9ubHkgY29udGFpbnMgaW5mb3JtYXRpb24gZm9yIGdyb3VwcyBvZiBpbmRpdmlkdWFscyB3aG8gc2VsZi1yZXBvcnRlZCBhcyBtYWxlIG9yIGZlbWFsZS4gV2UgYWxzbyBhY2tub3dsZWRnZSB0aGF0IHVuZm9ydHVuYXRlbHkgbm90IGFsbCBldGhuaWNpdGllcyBvciBncm91cCBpbnRlcnNlY3Rpb25zIGFyZSByZXByZXNlbnRlZCBpbiB0aGUgZGF0YSBlaXRoZXIuIE1vcmUgcmVzZWFyY2ggc2hvdWxkIGJlIGRldm90ZWQgdG8gY29sbGVjdGluZyBkYXRhIGFib3V0IHRoZSBtZW50YWwgaGVhbHRoIG9mIHRoZXNlIGdyb3Vwcy4gCgojIyAqKldoYXQgYXJlIHRoZSBkYXRhPyoqCioqKiAKCldlIHdpbGwgYmUgdXNpbmcgZGF0YSBmcm9tIHRoZSBbTmF0aW9uYWwgU3VydmV5IG9uIERydWcgVXNlIGFuZCBIZWFsdGggKE5TRFVIKV0oaHR0cHM6Ly9uc2R1aHdlYi5ydGkub3JnL3Jlc3B3ZWIvaG9tZXBhZ2UuY2ZtKXt0YXJnZXQ9Il9ibGFuayJ9IHdoaWNoIGlzIGRpcmVjdGVkIGJ5IHRoZSBbU3Vic3RhbmNlIEFidXNlIGFuZCBNZW50YWwgSGVhbHRoIFNlcnZpY2VzIEFkbWluaXN0cmF0aW9uIChTQU1IU0EpXShodHRwczovL3d3dy5zYW1oc2EuZ292Lyl7dGFyZ2V0PSJfYmxhbmsifSwgYW4gYWdlbmN5IGluIHRoZSBbVS5TLiBEZXBhcnRtZW50IG9mIEhlYWx0aCBhbmQgSHVtYW4gU2VydmljZXMgKERISFMpXShodHRwczovL3d3dy5oaHMuZ292Lyl7dGFyZ2V0PSJfYmxhbmsifS4gCgpUaGlzIHN1cnZleSBzdGFydGVkIGluIDE5NzEgYW5kIGlzIGNvbmR1Y3RlZCBhbm51YWxseSBpbiBhbGwgNTAgc3RhdGVzIGFuZCB0aGUgRGlzdHJpY3Qgb2YgQ29sdW1iaWEuIEFwcHJveGltYXRlbHkgNzAsMDAwIHBlb3BsZSAoYWdlcyAxMiBhbmQgdXApIGFyZSBpbnRlcnZpZXdlZCBlYWNoIHllYXIgYWJvdXQgaGVhbHRoIHJlbGF0ZWQgaXNzdWVzLiBPbmx5IGNpdmlsaWFuLCBub24taW5zdGl0dXRpb25hbGl6ZWQgaW5kaXZpZHVhbHMgYXJlIGluY2x1ZGVkLiBIb3VzZWhvbGRzIGFyZSByYW5kb21seSBzZWxlY3RlZCBhbmQgdGhhbiBhIHByb2Zlc3Npb25hbCBpbnRlcnZpZXdlciB2aXNpdHMgdGhlIGFkZHJlc3NlcyBhbmQgYXNrcyBvbmUgb3IgdHdvIG9mIHRoZSByZXNpZGVudHMgdG8gaW50ZXJ2aWV3LiBUaGUgaW50ZXJ2aWV3ZXIgYnJpbmdzIGEgbGFwdG9wIHdpdGggdGhlbSB0aGF0IHRoZSBwYXJ0aWNpcGFudHMgdXNlIHRvIGZpbGwgb3V0IHRoZSBzdXJ2ZXkgd2hpY2ggdHlwaWNhbGx5IHRha2VzIGFuIGhvdXIgdG8gY29tcGxldGUuIElmIGEgcGFydGljaXBhbnQgY2hvb3NlcyB0byBwYXJ0aWNpcGF0ZSB0aGV5IHJlY2VpdmUgJDMwIGluIGNhc2guIEFsbCBjb2xsZWN0ZWQgaW5mb3JtYXRpb24gaXMgY29uZmlkZW50aWFsIGFuZCBpcyB1c2VkIGZvciBkaXNlYXNlIHN1cnZlaWxsYW5jZSBhbmQgdG8gZ3VpZGUgcHVibGljIHBvbGljeSBwYXJ0aWN1bGFybHkgZm9jdXNlZCBvbiBkcnVnIGFuZCBhbGNvaG9sIHVzZSBhcyB3ZWxsIGFzIG1lbnRhbCBoZWFsdGguIFNlZSBbaGVyZV0oaHR0cHM6Ly9uc2R1aHdlYi5ydGkub3JnL3Jlc3B3ZWIvYWJvdXRfbnNkdWguaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSBmb3IgbW9yZSBkZXRhaWxzIGFib3V0IHRoZSBzdXJ2ZXkuCgpUaGUgZGF0YSBhcmUgbWFkZSBhdmFpbGFibGUgcHVibGljbHkgb25saW5lIG9uIHRoZSBbU3Vic3RhbmNlIEFidXNlICYgTWVudGFsIEhlYWx0aCBEYXRhIEFyY2hpdmVdKGh0dHBzOi8vZGF0YWZpbGVzLnNhbWhzYS5nb3YvKXt0YXJnZXQ9Il9ibGFuayJ9LiAKCmBgYHtyLCBvdXQud2lkdGggPSAiMTAwJSIsIGVjaG8gPSBGQUxTRSwgZmlnLmFsaWduID0iY2VudGVyIn0KaW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCAibnN1ZGhfc2NyZWVuc2hvdF93ZWJwYWdlLnBuZyIpKQpgYGAKCk9uIHRoZSBbd2Vic2l0ZV0oaHR0cHM6Ly93d3cuc2FtaHNhLmdvdi9kYXRhL3NpdGVzL2RlZmF1bHQvZmlsZXMvY2Joc3EtcmVwb3J0cy9OU0RVSERldGFpbGVkVGFiczIwMThSMi9OU0RVSERldFRhYnNTZWN0MTFwZTIwMTguaHRtKXt0YXJnZXQ9Il9ibGFuayJ9IHdpdGggdGhlIHN1cnZleSBkYXRhLCB5b3UgY2FuIHNlZSB0aGF0IHRoZSByZXN1bHRzIGFyZSBkaXNwbGF5ZWQgaW4gbWFueSB0YWJsZXMuIEltcG9ydGFudGx5LCB0aGVyZSBpcyBubyBvYnZpb3VzIHdheSB0byBkb3dubG9hZCB0aGUgZGF0YSBkaXJlY3RseSBmcm9tIHRoaXMgcGFydGljdWxhciB3ZWJzaXRlLgoKYGBge3IsIG91dC53aWR0aCA9ICIxMDAlIiwgZWNobyA9IEZBTFNFLCBmaWcuYWxpZ24gPSJjZW50ZXIifQppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsICJ3ZWJzaXRlX292ZXJ2aWV3LnBuZyIpKQpgYGAKCklmIG9uZSBjbGlja3Mgb24gdGhlIFRPQyBidXR0b24gb24gdGhlIGZhciByaWdodCB1cHBlciBjb3JuZXIgdGhleSB3aWxsIGJlIGRpcmVjdGVkIHRvIGFub3RoZXIgW3dlYnNpdGVdKGh0dHBzOi8vd3d3LnNhbWhzYS5nb3YvZGF0YS9zaXRlcy9kZWZhdWx0L2ZpbGVzL2NiaHNxLXJlcG9ydHMvTlNEVUhEZXRhaWxlZFRhYnMyMDE4UjIvTlNEVUhEZXRhaWxlZFRhYnNUT0MyMDE4Lmh0bSN0b2Mpe3RhcmdldD0iX2JsYW5rIn0sIHdoZXJlIGEgbGFyZ2UgW3BkZiBkb2N1bWVudF0oaHR0cHM6Ly93d3cuc2FtaHNhLmdvdi9kYXRhL3NpdGVzL2RlZmF1bHQvZmlsZXMvY2Joc3EtcmVwb3J0cy9OU0RVSERldGFpbGVkVGFiczIwMThSMi9OU0RVSERldGFpbGVkVGFiczIwMTgucGRmKXt0YXJnZXQ9Il9ibGFuayJ9IGNvbnRhaW5pbmcgb2YgYWxsIG9mIHRoZSByZXN1bHRzIGNhbiBiZSBkb3dubG9hZGVkLgoKV2UgYXJlIGludGVyZXN0ZWQgaW4gaW52ZXN0aWdhdGluZyBob3cgZGVwcmVzc2lvbiByYXRlcyBoYXZlIGNoYW5nZWQgYW5kIGhvdyB5b3V0aHMgYXJlIGludGVyYWN0aW5nIHdpdGggbWVudGFsIGhlYWx0aCBzZXJ2aWNlcy4gVGh1cywgdGhlIGZvbGxvd2luZyB0YWJsZXMgYXJlIG9mIGludGVyZXN0IHRvIHVzIGFyZToKClRhYmxlICAgfCBEZXRhaWxzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAotLS18LS0tLS0tLS0tLS0tLQpUYWJsZSAxMS4xQSAgICAgICB8IFNldHRpbmdzIFdoZXJlIE1lbnRhbCBIZWFsdGggU2VydmljZXMgV2VyZSBSZWNlaXZlZCBpbiBQYXN0IFllYXIgYW1vbmcgUGVyc29ucyBBZ2VkIDEyIHRvIDE3OiBOdW1iZXJzIGluIFRob3VzYW5kcywgMjAwMi0yMDE4ICAgClRhYmxlIDExLjFCICAgICAgIHwgU2V0dGluZ3MgV2hlcmUgTWVudGFsIEhlYWx0aCBTZXJ2aWNlcyBXZXJlIFJlY2VpdmVkIGluIFBhc3QgWWVhciBhbW9uZyBQZXJzb25zIEFnZWQgMTIgdG8gMTc6IFBlcmNlbnRhZ2VzLCAyMDAyLTIwMTggIApUYWJsZSAxMS4yQSAgICAgICB8ICBNYWpvciBEZXByZXNzaXZlIEVwaXNvZGUgaW4gUGFzdCBZZWFyIGFtb25nIFBlcnNvbnMgQWdlZCAxMiB0byAxNywgYnkgRGVtb2dyYXBoaWMgQ2hhcmFjdGVyaXN0aWNzOiBOdW1iZXJzIGluIFRob3VzYW5kcywgMjAwNC0yMDE4ClRhYmxlIDExLjJCICAgICAgIHwgTWFqb3IgRGVwcmVzc2l2ZSBFcGlzb2RlIGluIFBhc3QgWWVhciBhbW9uZyBQZXJzb25zIEFnZWQgMTIgdG8gMTcsIGJ5IERlbW9ncmFwaGljIENoYXJhY3RlcmlzdGljczogUGVyY2VudGFnZXMsIDIwMDQtMjAxOApUYWJsZSAxMS4zQSAgICAgICB8IE1ham9yIERlcHJlc3NpdmUgRXBpc29kZSB3aXRoIFNldmVyZSBJbXBhaXJtZW50IGluIFBhc3QgWWVhciBhbW9uZyBQZXJzb25zIEFnZWQgMTIgdG8gMTcsIGJ5IERlbW9ncmFwaGljIENoYXJhY3RlcmlzdGljczogTnVtYmVycyBpbiBUaG91c2FuZHMsIDIwMDYtMjAxOApUYWJsZSAxMS4zQiAgICAgICB8IE1ham9yIERlcHJlc3NpdmUgRXBpc29kZSB3aXRoIFNldmVyZSBJbXBhaXJtZW50IGluIFBhc3QgWWVhciBhbW9uZyBQZXJzb25zIEFnZWQgMTIgdG8gMTcsIGJ5IERlbW9ncmFwaGljIENoYXJhY3RlcmlzdGljczogUGVyY2VudGFnZXMsIDIwMDYtMjAxOApUYWJsZSAxMS40QSAgICAgICB8IFJlY2VpcHQgb2YgVHJlYXRtZW50IGZvciBEZXByZXNzaW9uIGluIFBhc3QgWWVhciBhbW9uZyBQZXJzb25zIEFnZWQgMTIgdG8gMTcgd2l0aCBNYWpvciBEZXByZXNzaXZlIEVwaXNvZGUgaW4gUGFzdCBZZWFyLCBieSBEZW1vZ3JhcGhpYyBDaGFyYWN0ZXJpc3RpY3M6IE51bWJlcnMgaW4gVGhvdXNhbmRzLCAyMDA0LTIwMTgKVGFibGUgMTEuNEIgICAgICAgfCBSZWNlaXB0IG9mIFRyZWF0bWVudCBmb3IgRGVwcmVzc2lvbiBpbiBQYXN0IFllYXIgYW1vbmcgUGVyc29ucyBBZ2VkIDEyIHRvIDE3IHdpdGggTWFqb3IgRGVwcmVzc2l2ZSBFcGlzb2RlIGluIFBhc3QgWWVhciwgYnkgRGVtb2dyYXBoaWMgQ2hhcmFjdGVyaXN0aWNzOiBQZXJjZW50YWdlcywgMjAwNC0yMDE4CgpPdXIgZ29hbCBpcyB0byBicmluZyB0aGVzZSBkYXRhIGludG8gUiBzbyB3ZSBjYW4gZXhwbG9yZSB0aGVtLiAKCioqKgo8ZGV0YWlscz4gPHN1bW1hcnk+Q2xpY2sgaGVyZSBmb3IgdGhlIE5TRFVIIGRlZmluZXMgYSBtYWpvciBkZXByZXNzaXZlIGVwaXNvZGUgKE1ERSkgPC9zdW1tYXJ5PiAgCgpBY2NvcmRpbmcgdG8gdGhlIFtOU0RVSCAyMDE4IHJlcG9ydF0oaHR0cHM6Ly93d3cuc2FtaHNhLmdvdi9kYXRhL3NpdGVzL2RlZmF1bHQvZmlsZXMvY2Joc3EtcmVwb3J0cy9OU0RVSE5hdGlvbmFsRmluZGluZ3NSZXBvcnQyMDE4L05TRFVITmF0aW9uYWxGaW5kaW5nc1JlcG9ydDIwMTgucGRmKXt0YXJnZXQ9Il9ibGFuayJ9Cgo+IFJlc3BvbmRlbnRzIHdlcmUgZGVmaW5lZCBhcyBoYXZpbmcgaGFkIGFuIE1ERSBpbgp0aGUgcGFzdCAxMiBtb250aHMgaWYgdGhleSBoYWQgYXQgbGVhc3Qgb25lIHBlcmlvZCBvZiAyIHdlZWtzCm9yIGxvbmdlciBpbiB0aGUgcGFzdCB5ZWFyIHdoZW4gdGhleSBleHBlcmllbmNlZCBhIGRlcHJlc3NlZAptb29kIG9yIGxvc3Mgb2YgaW50ZXJlc3Qgb3IgcGxlYXN1cmUgaW4gZGFpbHkgYWN0aXZpdGllcywKYWNjb21wYW5pZWQgYnkgcHJvYmxlbXMgd2l0aCBzbGVlcGluZywgZWF0aW5nLCBlbmVyZ3ksCmNvbmNlbnRyYXRpb24sIG9yIHNlbGYtd29ydGguIFRoZSBNREUgcXVlc3Rpb25zIGFyZSBiYXNlZApvbiBkaWFnbm9zdGljIGNyaXRlcmlhIGZyb20gRFNNLTUuIFNvbWUgb2YgdGhlIHdvcmRpbmdzCm9mIHRoZSBkZXByZXNzaW9uIHF1ZXN0aW9ucyBmb3IgYWRvbGVzY2VudHMgYWdlZCAxMiB0byAxNwphbmQgYWR1bHRzIGFnZWQgMTggb3Igb2xkZXIgZGlmZmVyZWQgc2xpZ2h0bHkgdG8gbWFrZSB0aGUKcXVlc3Rpb25zIG1vcmUgZGV2ZWxvcG1lbnRhbGx5IGFwcHJvcHJpYXRlIGZvciBhZG9sZXNjZW50cy4KCj4gQWRvbGVzY2VudHMgd2VyZSBkZWZpbmVkIGFzIGhhdmluZyBhbiBNREUgd2l0aApzZXZlcmUgaW1wYWlybWVudCBpZiB0aGVpciBkZXByZXNzaW9uIGNhdXNlZCBzZXZlcmUgcHJvYmxlbXMKd2l0aCB0aGVpciBhYmlsaXR5IHRvIGRvIGNob3JlcyBhdCBob21lLCBkbyB3ZWxsIGF0IHdvcmsgb3IKc2Nob29sLCBnZXQgYWxvbmcgd2l0aCB0aGVpciBmYW1pbHksIG9yIGhhdmUgYSBzb2NpYWwgbGlmZS4KCjwvZGV0YWlscz4KKioqIAoKCiMjICoqRGF0YSBJbXBvcnQqKgoqKiogCgpEYXRhIGFyZSBvZnRlbiBtYWRlIGF2YWlsYWJsZSBvbmxpbmUuIFNvbWV0aW1lcywgdGhlIGRhdGEgd2UgYXJlIGludGVyZXN0ZWQgaW4gaXMgbWFkZSBhdmFpbGFibGUgZm9yIGRvd25sb2FkIG9uIGEgd2ViIHBhZ2UgYXMgYSBkZWxpbWl0ZWQgdGV4dCBmaWxlIG9yIGFuIGV4Y2VsIGZpbGUuIEhvd2V2ZXIsIHNvbWV0aW1lcyBkYXRhIGFyZSBub3QgbWFkZSBhdmFpbGFibGUgaW4gdGhpcyBtYW5uZXIsIHN1Y2ggYXMgdGhlIFtOU0RVSCBzdXJ2ZXkgZGF0YV0oaHR0cHM6Ly93d3cuc2FtaHNhLmdvdi9kYXRhL3NpdGVzL2RlZmF1bHQvZmlsZXMvY2Joc3EtcmVwb3J0cy9OU0RVSERldGFpbGVkVGFiczIwMThSMi9OU0RVSERldFRhYnNTZWN0MTFwZTIwMTguaHRtKXt0YXJnZXQ9Il9ibGFuayJ9LgoKSG93IGRvIHdlIHByb2NlZWQgaW4gdGhpcyBzY2VuYXJpbz8KCldlIGNhbiBtYW51YWxseSBjb3B5IGVhY2ggY2VsbCBvZiBkYXRhLCBob3dldmVyLCB0aGlzIHByb2Nlc3MgaXMgb2Z0ZW4gaW5lZmZpY2llbnQsIHN1YmplY3QgdG8gZXJyb3IsIGFuZCBub3QgcmVwcm9kdWNpYmxlLiBTYXkgd2Ugd2FudGVkIHRvIHJ1biBhbiBhbmFseXNpcyBuZXh0IHllYXIgb24gdGhlIG5leHQgeWVhcnMgZGF0YSBhbmQgaXQgaGFwcGVucyB0byBiZSBmb3JtYXR0ZWQgaW4gdGhlIHNhbWUgd2F5LiAKCkFsdGVybmF0aXZlbHksIHdlIGNvdWxkIHVzZSBgUmAgZm9yIHRvIHNjcmFwZSB0aGUgZGF0YSBmcm9tIHRoZSB3ZWIhIAoKRm9ybWFsbHksIFt3ZWIgc2NyYXBpbmddKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1dlYl9zY3JhcGluZz9vbGRmb3JtYXQ9dHJ1ZSl7dGFyZ2V0PSJfYmxhbmsifSBpcyB0aGUgcHJvY2VzcyBvZiBleHRyYWN0aW5nIGRhdGEgZnJvbSBhIHdlYnBhZ2UuIExldCdzIGxlYXJuIGhvdyB0byBkbyB0aGlzIGZvciBvdXIgY2FzZSBzdHVkeS4gCgoKIyMjIEJhc2ljIHN0ZXBzIG9mIHdlYiBzY3JhcGluZwoKVGhlcmUgYXJlIHR3byBtYWluIHN0ZXBzIHRvIHdlYiBzY3JhcGluZzogIAoKMS4gSWRlbnRpZnkgKipsb2NhdGlvbioqIG9mIGRhdGEgb24gdGhlIHdlYnBhZ2UgdGhhdCB3aWxsIGJlIHNjcmFwZWQuCgoyLiBTYXZlIHRoZSB3ZWJwYWdlICoqZWxlbWVudCoqIHRvIGFuIFIgKipvYmplY3QqKi4KCldlIGFjY29tcGxpc2ggU1RFUCAxIHdpdGggb3VyIHdlYiBicm93c2VyLgoKV2UgYWNjb21wbGlzaCBTVEVQIDIgaW4gdGhlIGBSYCBwcm9ncmFtbWluZyBlbnZpcm9ubWVudC4gCgojIyMjIHsucmVzb3VyY2VfYmxvY2t9IAoKPHU+QWRkaXRpb25hbCByZXNvdXJjZXMgZm9yIHdlYiBzY3JhcGluZzwvdT46CgotIFtWaWduZXR0ZV0oaHR0cHM6Ly9yc3R1ZGlvLXB1YnMtc3RhdGljLnMzLmFtYXpvbmF3cy5jb20vMjY2NDMwX2YzZmQ0NjYwYjI3NDQ3NTFhYjE0NGFhMTMwNzY4YTA2Lmh0bWwpe3RhcmdldD0iX2JsYW5rIn0KLSBbQmxvZ10oaHR0cDovL2Jsb2cuY29yeW5pc3Nlbi5jb20vMjAxNS8wMS91c2luZy1ydmVzdC10by1zY3JhcGUtaHRtbC10YWJsZS5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9Ci0gW0Jsb2ddKGh0dHA6Ly9yZXNlYXJjaC5saWJkLm9yZy9yc3RhdHNjbHViL3Bvc3QvaW50cm9kdWN0aW9uLXRvLXNjcmFwaW5nLWFuZC13cmFuZ2luZy10YWJsZXMtZnJvbS1yZXNlYXJjaC1hcnRpY2xlcy8jLlh3ODc4Wk5LaFFKKXt0YXJnZXQ9Il9ibGFuayJ9Ci0gW1NlbGVjdG9yZ2FkZ2V0IFRvb2xdKGh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9ydmVzdC92aWduZXR0ZXMvc2VsZWN0b3JnYWRnZXQuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifQoKIyMjIwoKCkluIHRoaXMgY2FzZSBzdHVkeSwgd2Ugd2lsbCBzY3JhcGUgZGF0YSBmcm9tIHRoZSB0YWJsZXMgb24gdGhlIFtOU0RVSCBzdXJ2ZXldKGh0dHBzOi8vd3d3LnNhbWhzYS5nb3YvZGF0YS9zaXRlcy9kZWZhdWx0L2ZpbGVzL2NiaHNxLXJlcG9ydHMvTlNEVUhEZXRhaWxlZFRhYnMyMDE4UjIvTlNEVUhEZXRUYWJzU2VjdDExcGUyMDE4Lmh0bSl7dGFyZ2V0PSJfYmxhbmsifSB3ZWJzaXRlLiAKVGhlc2UgZGF0YSBhcmUgYXZhaWxhYmxlIGluIGEgbGFyZ2UgUERGIHdpdGggYWxsIHRoZSByZXN1bHRzIGJ5IHllYXIuIApIb3dldmVyLCBpdCBpcyBub3QgZWFzeSB0byBmaW5kIHRoaXMgUERGIGFuZCBpdCB3b3VsZCBiZSBkaWZmaWN1bHQgYW5kIHRpbWUgY29uc3VtaW5nIHRvIGZpbmQgb3VyIHRhYmxlcyBvZiBpbnRlcmVzdCBhbmQgdG8gZXh0cmFjdCB0aGUgZGF0YSBmcm9tIHRoZSBwZGYgd2l0aCBgcGRmdG9vbHNgLiAKQWdhaW4sIGlmIHdlIGluc3RlYWQgZGVjaWRlZCB0byBjb3B5IHBhc3RlIHRoZSBkYXRhIGZyb20gdGhlIHdlYnNpdGUgdG8gYW5vdGhlciBmaWxlIHRoYXQgd2Ugd291bGQgYWxzbyBuZWVkIHRvIGltcG9ydCwgdGhpcyB3b3VsZCBub3QgYmUgYXMgZWZmaWNpZW50IG9yIHJlcHJvZHVjaWJsZSBhbmQgbWlnaHQgcmVzdWx0IGluIGVycm9ycy4gCgpBbHRlcm5hdGl2ZWx5LCB3ZSB3aWxsIHVzZSB0aGUgYHJ2ZXN0YCBwYWNrYWdlIHRvIFtzY3JhcGVdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1dlYl9zY3JhcGluZz9vbGRmb3JtYXQ9dHJ1ZSl7dGFyZ2V0PSJfYmxhbmsifSB0aGUgZGF0YSBkaXJlY3RseSBmcm9tIHRoZSB0YWJsZXMgb24gdGhlIHdlYnNpdGUuIApBc3N1bWluZyB0aGUgZGF0YSBuZXh0IHllYXIgd291bGQgYmUgZGlzcGxheWVkIGluIGEgc2ltaWxhciBtYW5uZXIsIHRoaXMgY291bGQgYWxsb3cgdXMgc2ltcGx5IG1vZGlmeSBvdXIgY29kZSBiYXNlZCBvbiB0aGUgdXJsIGZvciB0aGUgZGF0YSBuZXh0IHllYXIgdG8gcnVuIHRoZSBzYW1lIGFuYWx5c2lzIG9uIHRoZSBkYXRhIGVhc2lseS4gCgpUaGUgYHJ2ZXN0YCAgcGFja2FnZSBjYW4gYmUgdGhvdWdodCBvZiBhcyB0aGUgYHBkZnRvb2xzYCBwYWNrYWdlIGZvciB3ZWIgc2NyYXBpbmcuIApVcG9uIHB1bGxpbmcgdGhlIGRhdGEsIGFkZGl0aW9uYWwgd3JhbmdsaW5nIHdpbGwgbGlrZWx5IGJlIHJlcXVpcmVkOyBidXQgbGlrZSB0aGUgYHBkZnRvb2xzYCBwYWNrYWdlLCBgcnZlc3RgIHN0cmVhbWxpbmVzIHRoZSBleHRyYWN0aW9uIHByb2Nlc3MuICAKCiMjIyBTY3JhcGluZyB0YWJsZXMgaW50byBSCgpUaGUgdHdvIHdlYiBzY3JhcGluZyBzdGVwcyBmb3IgdGhlc2UgdGFibGVzIGNhbiBiZSBicm9rZW4gZG93biBldmVuIGZ1cnRoZXI6IAoKMS4gSWRlbnRpZnkgbG9jYXRpb24gb2YgZGF0YSB0aGF0IHdpbGwgYmUgc2NyYXBlZAoKKyByaWdodC1jbGljayB0byBpbnNwZWN0IGVsZW1lbnQgKHdlYnBhZ2UpCisgaG92ZXIgcG9pbnRlciBvdmVyIGNvbXBvbmVudHMgb2YgZWxlbWVudCAod2VicGFnZSkgdW50aWwgdGhlIGRhdGEgaGFzIGJlZW4gZm91bmQKKyBjb3B5IFhQYXRoIG9mIGRhdGEgc291Z2h0CgoyLiBTYXZlIHdlYnBhZ2UgZWxlbWVudCB0byBhbiBvYmplY3QgaW4gUgoKKyBpbXBvcnQgaHRtbCBjb2RlIGZvciB0aGUgd2VicGFnZQorIGV4dHJhY3QgcGllY2VzIG9mIEhUTUwgZG9jdW1lbnRzICh3ZWJwYWdlKSB1c2luZyBYUGF0aAorIHBhcnNlIHRoZSBleHRyYWN0ZWQgZGF0YSBpbnRvIGEgZGF0YSBmcmFtZQoKQmVsb3cgaXMgYSBhbmltYXRlZCBvdmVydmlldyBvZiB0aGUgcHJvY2Vzcy4KCjxkZXRhaWxzPjxzdW1tYXJ5PiBDbGljayBoZXJlIGlmIHlvdSB3YW50IHRvIHNlZSBob3cgdGhpcyBhbmltYXRpb24gd2FzIG1hZGUhPC9zdW1tYXJ5PgoKRmlyc3QgdGhlIGltYWdlcyBuZWVkIHRvIGJlIGltcG9ydGVkIGludG8gUiB1c2luZyB0aGUgYGltYWdlX3JlYWRgIGZ1bmN0aW9uIG9mIHRoZSBgbWFnaWNrYCBwYWNrYWdlLgoKYGBge3J9CnN0ZXAxIDwtIG1hZ2ljazo6aW1hZ2VfcmVhZChoZXJlOjpoZXJlKCJpbWciLCAid2VicGFnZV9zY3JlZW5zaG90LnBuZyIpKQpzdGVwMiA8LSBpbWFnZV9yZWFkKGhlcmU6OmhlcmUoImltZyIsICJ0YWJsZV9zY3JlZW5zaG90X2luc3BlY3QucG5nIikpCnN0ZXAzIDwtIGltYWdlX3JlYWQoaGVyZTo6aGVyZSgiaW1nIiwgInRhYmxlX3NjcmVlbnNob3RfaW5zcGVjdF90YWJsZS5wbmciKSkKc3RlcDQgPC0gaW1hZ2VfcmVhZChoZXJlOjpoZXJlKCJpbWciLCAidGFibGVfc2NyZWVuc2hvdF9pbnNwZWN0X3RhYmxlX3hwYXRoLnBuZyIpKQpzdGVwNSA8LSBpbWFnZV9yZWFkKGhlcmU6OmhlcmUoImltZyIsICJ0YWJsZV9zY3JlZW5zaG90X3hwYXRoX2NvcHlfci5wbmciKSkKc3RlcDVfem9vbSA8LSBpbWFnZV9yZWFkKGhlcmU6OmhlcmUoImltZyIsICJ0YWJsZV9zY3JlZW5zaG90X3hwYXRoX2NvcHlfcl96b29tLnBuZyIpKQpgYGAKClRoZSBsYXN0IGltYWdlIGlzIHNtYWxsZXIgdGhhbiB0aGUgb3RoZXJzLCB0byBnZXQgYSBzZW5zZSBvZiB0aGUgc2l6ZSB3ZSBjYW4gdXNlIHRoZSBgaW1hZ2VfaW5mbygpYCBmdW5jdGlvbiBvZiB0aGUgYG1hZ2lja2AgcGFja2FnZS4KCmBgYHtyfQpzdGVwNQpzdGVwNV96b29tCmltYWdlX2luZm8oc3RlcDUpCmltYWdlX2luZm8oc3RlcDVfem9vbSkKYGBgCgpGaXJzdCBsZXQncyByZS1zaXplIHRoZSBzZWNvbmQgaW1hZ2UgdG8gbWFrZSBpdCBhIGJpdCBsYXJnZXIgdXNpbmcgdGhlIGBpbWFnZV9yZXNpemUoKWAgZnVuY3Rpb24gb2YgdGhlIGBtYWdpY2tgIHBhY2thZ2UuIFdlIHdpbGwgcmUtc2l6ZSB0aGUgd2lkdGggdG8gYmUgdGhlIHNhbWUgYXMgdGhlIHByZXZpb3VzIGltYWdlIHdpZHRoIGFuZCBrZWVwIHRoZSBhc3BlY3QgcmF0aW8gZm9yIHRoZSBoZWlnaHQgYnkgdXNpbmcgIjE0NDB4Ii4gSWYgd2Ugd2FudGVkIHRvIGp1c3QgZG8gdGhlIHNhbWUgZm9yIGhlaWdodCB3ZSB3b3VsZCB1c2UgIng5MDAiLgoKYGBge3J9CnN0ZXA1X3pvb20gPC0gaW1hZ2VfcmVzaXplKHN0ZXA1X3pvb20sICAiMTQ0MHgiKQpzdGVwNV96b29tCmBgYAoKV2UgY2FuIGFkZCBhIHdoaXRlIGJvYXJkZXIgYXJvdW5kIHRoZSBsYXN0IGltYWdlIHRvIG1ha2UgdGhlIHNpemUgbW9yZSBzaW1pbGFyIGhlaWdodC13aXNlIHVzaW5nIHRoZSBgaW1hZ2VfYm9yZGVyKClgIGZ1bmN0aW9uIG9mIHRoZSBgbWFnaWNrYCBwYWNrYWdlLiBUaGVyZSBhcmUgbWFueSBpbWFnZSBtb2RpZmljYXRpb24gZnVuY3Rpb25zIGluIHRoZSBgbWFnaWNrYCBwYWNrYWdlISBTZWUgW2hlcmVdKGh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9tYWdpY2svdmlnbmV0dGVzL2ludHJvLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gdG8gbGVhcm4gbW9yZS4KCmBgYHtyfQpzdGVwNV96b29tIDwtIGltYWdlX2JvcmRlcihzdGVwNV96b29tLCAid2hpdGUiLCAiMngzMzQiKQpzdGVwNV96b29tCmBgYAoKTG9va3MgZ29vZCEKCk5vdyB3ZSB3aWxsIG1ha2UgdGhlIHNlcXVlbmNlIG9mIGltYWdlcyBmb3Igb3VyIGFuaW1hdGlvbi4gV2UgYWxzbyB3YW50IHRvIGluZGljYXRlIGhvdyBsb25nIHdlIHdhbnQgdG8gc3BlbmQgb24gZWFjaCByZWxhdGl2ZSB0byB0aGUgb3RoZXJzLiBXZSB3YW50IHRvIGxpbmdlciBvbiB0aGUgbGFzdCBpbWFnZSBzbyB3ZSBpbmNsdWRlIGl0IHR3byB0aW1lcy4KCmBgYHtyfQppbWcgPC0gYyhzdGVwMSwKICAgICAgICAgc3RlcDIsCiAgICAgICAgIHN0ZXAzLAogICAgICAgICBzdGVwNCwKICAgICAgICAgc3RlcDUsCiAgICAgICAgIHN0ZXA1X3pvb20sCiAgICAgICAgIHN0ZXA1X3pvb20pCmBgYAoKCk5vdywgd2UgYXJlIHJlYWR5IHRvIGNyZWF0ZSBvdXIgZ2lmISBCdXQgZmlyc3Qgd2Ugd2FudCB0byBtb2RpZnkgb3VyIGltYWdlcyBhIGJpdCBtb3JlLgoKRmlyc3Qgd2Ugd2FudCB0byBtYWtlIGFsbCBpbWFnZXMgd2l0aGluIGBpbWdgIHRoZSBleGFjdCBzYW1lIHNpemUgdXNpbmcgdGhlIGBpbWFnZV9yZXNpemUoKWAgZnVuY3Rpb24uIFRvIGRvIHRoaXMgZm9yIGFsbCBpbWFnZXMgd2UgY2FuIHVzZSB0aGUgYCFgIGF0IHRoZSBlbmQsIHdoaWNoIGlnbm9yaW5nIGFzcGVjdCByYXRpb3MuCgpgYGB7cn0KaW1hZ2VfaW5mbyhpbWcpCmltZyA8LWltYWdlX3Jlc2l6ZShpbWcsICcxNDQweDkwMCEnKQppbWFnZV9pbmZvKGltZykKYGBgCgpXZSBhbHNvIHdhbnQgdG8gbW9ycGggb3IgYmxlbmQgZWFjaCBpbWFnZSBpbnRvIHRoZSBuZXh0IHNvIHRoYXQgdGhlcmUgYXBwZWFycyB0byBiZSBhIHNtb290aCB0cmFuc2l0aW9uLiBXZSBjYW4gYWxzbyBzcGVjaWZ5IGhvdyBtYW55IGZyYW1lcyB0byBpbmNsdWRlIGluIHRoZSBtb3JwaCwgdG8gc3BlZWQgdXAgb3Igc2xvdyBkb3duIHRoZSBibGVuZCBmcm9tIG9uZSBpbWFnZSB0byBhbm90aGVyLiBXZSB3aWxsIHNwZWNpZnkgdGhhdCA0IGZyYW1lcyBzaG91bGQgYmUgdXNlZCBpbiB0aGUgbW9ycGggYnkgdXNpbmcgdGhlIGBpbWFnZV9tb3JwaCgpYCBmdW5jdGlvbi4gCgpUbyBtYWtlIHRoZSBmaW5hbCBhbmltYXRpb24gd2UgdXNlIHRoZSBgaW1hZ2VfYW5pbWF0ZSgpYCBmdW5jdGlvbgpJbXBvcnRhbnRseSwgd2Ugd2FudCB0byBkZWxheSBjaGFuZ2luZyBmcm9tIG9uZSBpbWFnZSB0byBhbm90aGVyIGFib3V0IDcwKiAxLzEwMCBzZWNvbmRzIHRvIGdpdmUgcGVvcGxlIGEgY2hhbmNlIHRvIHNlZSB3aGF0IGlzIGhhcHBlbmluZy4gU28gd2UgY2FuIHVzZSB0aGUgYGRlbGF5YCBhcmd1bWVudC4gVGhlIG9wdGltaXplIGFyZ3VtZW50IG9mIHRoaXMgZnVuY3Rpb24gcmVxdWlyZXMgdGhhdCBhbGwgaW1hZ2VzIGFyZSB0aGUgc2FtZSBzaXplIChsdWNraWx5IHdlIGRpZCB0aGlzISkgYW5kIGl0IGNhdXNlcyBSIHRvIG9ubHkgc3RvcmUgdGhlIGRpZmZlcmVuY2VzIGJldHdlZW4gZnJhbWVzLgoKYGBge3J9CmVkdWNhdGlvbmFsX2dpZiA8LSAKICBpbWFnZV9tb3JwaChpbWcsIGZyYW1lcyA9IDQpICU+JQogIGltYWdlX2FuaW1hdGUoZGVsYXkgPSA3MCwKICAgICAgICAgICAgICAgIG9wdGltaXplID0gVFJVRSkKYGBgCgpOb3cgdG8gc2F2ZSBvdXIgZ2lmIHdlIGNhbiB1c2UgdGhlIGBpbWFnZV93cml0ZSgpYCBmdW5jdGlvbiBvZiB0aGUgYG1hZ2lja2AgcGFja2FnZSBhbmQgdGhlIGBoZXJlKClgIGZ1bmN0aW9uIG9mIHRoZSBgaGVyZWAgcGFja2FnZSB0byBlYXNpbHkgc2F2ZSBpdCBpbiBhIGRpcmVjdG9yeSBjYWxsZWQgYGltZ2Agd2l0aGluIHRoZSBkaXJlY3RvcnkgdGhhdCBjb250YWlucyBvdXIgLlJwcm9qIGZpbGUuIFdlIHdpbGwgbmFtZSB0aGUgZmlsZSBlZHVjYXRpb25hbC5naWYuCgpgYGB7ciwgZXZhbCA9IEZBTFNFfQppbWFnZV93cml0ZShlZHVjYXRpb25hbF9naWYsCiAgICAgIGhlcmU6OmhlcmUoImltZyIsICJlZHVjYXRpb25hbC5naWYiKSkKYGBgCgoKPC9kZXRhaWxzPgoKCgpgYGB7ciwgZWNobyA9IEZBTFNFfQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCJlZHVjYXRpb25hbC5naWYiKSkKYGBgCgoKKioqCgpOb3cgbGV0J3MgZ28gdGhyb3VnaCBlYWNoIHN0ZXAgdG9nZXRoZXI6CgojIyMjIDEpIElkZW50aWZ5IGxvY2F0aW9uIG9mIGRhdGEgdGhhdCB3aWxsIGJlIHNjcmFwZWQKCkZpcnN0LCBsZXQncyBnbyB0byB0aGUgW3dlYiBwYWdlXShodHRwczovL3d3dy5zYW1oc2EuZ292L2RhdGEvc2l0ZXMvZGVmYXVsdC9maWxlcy9jYmhzcS1yZXBvcnRzL05TRFVIRGV0YWlsZWRUYWJzMjAxOFIyL05TRFVIRGV0VGFic1NlY3QxMXBlMjAxOC5odG0pe3RhcmdldD0iX2JsYW5rIn0gd2l0aCBhbGwgdGhlIHRhYmxlcyB3ZSBhcmUgaW50ZXJlc3RlZCBpbiBzY3JhcGluZwoKYGBge3IsIHN0ZXAxLCBlY2hvPUZBTFNFfQpzdGVwMQpgYGAKCk9uY2Ugb24gdGhlIHdlYnBhZ2UsIHRoZXJlIGFyZSBub3QgYW55IHZpc2libGUgb3B0aW9ucyB0byBkb3dubG9hZCB0aGUgZGF0YS4gCgpSaWdodC1jbGljayBhbmQgc2VsZWN0ICJJbnNwZWN0Ii4KCmBgYHtyLCBzdGVwMiwgZWNobz1GQUxTRX0Kc3RlcDIKYGBgCgpBIHdpbmRvdyBvcGVucy4gCgpUaGlzIHdpbmRvdyBhbGxvd3MgdXMgdG8gZ2xhbmNlIGF0IHRoZSBpbnRlcm5hbCBtZWNoYW5pY3Mgb2YgdGhlIHdlYnBhZ2UuIFRvIHNjcmFwZSB0aGUgZGF0YSBmcm9tIHRoZSB3ZWJwYWdlLCB3ZSBuZWVkIHRvIGZpcnN0IGxlYXJuIGEgbGl0dGxlIGJpdCBhYm91dCB0aGUgY29tcG9uZW50cyB0aGF0IG1ha2UgaXQgdGhlIHdlYiBwYWdlIGl0IGlzLiAKCkhvdmVyaW5nIG91ciBtb3VzZSBvdmVyIHRoZSBlbGVtZW50cyBvZiB0aGUgd2VicGFnZSBoaWdobGlnaHRzIHRoZSByZXNwZWN0aXZlIHNlY3Rpb24gb2YgdGhlIHdlYnBhZ2UgaXQgcmVwcmVzZW50cy4KQnkgaG92ZXJpbmcgb3ZlciBzZXZlcmFsIGVsZW1lbnRz4oCUYW5kIGNsaWNraW5nIG9uIHRoZSBlbGVtZW50cyBvbiB0aGUgcmlnaHQgc2lkZSBvZiB0aGUgc2NyZWVu4oCUd2UgY2FuIGlkZW50aWZ5IHRoZSBlbGVtZW50IHRoYXQgY29udGFpbnMgdGhlIGRhdGEgd2UgYXJlIGxvb2tpbmcgZm9yLiAKQW5vdGhlciBvcHRpb24gZm9yIGlkZW50aWZ5aW5nIFhQYXRocyBpcyB0byB1c2UgdGhlIFtzZWxlY3RvcmdhZGdldCB0b29sXShodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvcnZlc3QvdmlnbmV0dGVzL3NlbGVjdG9yZ2FkZ2V0Lmh0bWwpe3RhcmdldD0iX2JsYW5rIn0uICAKCmBgYHtyLHN0ZXAzLCBlY2hvPUZBTFNFfQpzdGVwMyAKYGBgCgpSaWdodCBjbGljayBvbiB0aGUgZWxlbWVudCBhbmQgY29weSB0aGUgWFBhdGguIFdlIHdpbGwgbmVlZCB0aGlzIFhQYXRoIGZvciB0aGUgbmV4dCBzdGVwLgoKYGBge3IsIHN0ZXA0LCBlY2hvPUZBTFNFfQpzdGVwNApgYGAKCk5vdyB3ZSBjYW4gcmV0dXJuIHRvIHRoZSBgUmAgcHJvZ3JhbW1pbmcgZW52aXJvbm1lbnQuCgpgYGB7ciwgc3RlcDUsIGVjaG89RkFMU0V9CnN0ZXA1CmBgYAoKKioqCgojIyMjIDIpIFNhdmUgd2VicGFnZSBlbGVtZW50IHRvIGFuIG9iamVjdCBpbiBSIAoKRm9yIHRoZSBmaXJzdCB0YWJsZSB3ZSB3YW50IHRvIHNjcmFwZSwgdGhlIFhQYXRoIGlzIGAvaHRtbC9ib2R5L2Rpdls0XS9kaXZbMV0vdGFibGVgLiBXZSB1c2UgdGhpcyBYUGF0aCB3aXRoIGZ1bmN0aW9ucyBmcm9tIHRoZSBgcnZlc3RgIHBhY2thZ2UgdG8gc2NyYXBlIHRoZSBkYXRhIGZyb20gdGhpcyB0YWJsZS4KCgpgYGB7cixzdGVwNV96b29tLCBlY2hvPUZBTFNFfQpzdGVwNV96b29tCmBgYAoKCkxldCdzIGV4cGxvcmUgdGhpcyBzdGVwIGluIGdyZWF0ZXIgZGV0YWlsOgoKV2UgbmVlZCB0bzoKCisgaW1wb3J0IGh0bWwgY29kZSBmb3IgdGhlIHdlYnBhZ2UKKyBleHRyYWN0IHBpZWNlcyAodGFibGUpIG91dCBvZiBIVE1MIGRvY3VtZW50cyAod2VicGFnZSkgdXNpbmcgWFBhdGgKKyBwYXJzZSB0aGUgaHRtbCB0YWJsZSBpbnRvIGEgZGF0YSBmcmFtZQoKVG8gZG8gdGhpczoKCisgV2UgaW1wb3J0IHRoZSBodG1sIGNvZGUgdXNpbmcgdGhlIGByZWFkX2h0bWwoKWAgZnVuY3Rpb24gb2YgdGhlIGBydmVzdGAgcGFja2FnZQorIFdlIGV4dHJhY3Qgc3BlY2lmaWMgY29tcG9uZW50cyBvZiB0aGUgd2VicGFnZSB1c2luZyB0aGUgYGh0bWxfbm9kZXMoKWAgZnVuY3Rpb24gb2YgdGhlIGBydmVzdGAgcGFja2FnZQorIFdlIGNvbnZlcnQgdGhpcyBodG1sIHRhYmxlIGludG8gYSBkYXRhZnJhbWUgdXNpbmcgdGhlIGBodG1sX3RhYmxlKClgZnVuY3Rpb24gb2YgdGhlIGBydmVzdGAgcGFja2FnZQoKKipUaGUgYHJ2ZXN0YCBwYWNrYWdlIHByb3ZpZGVzIHdyYXBwZXJzIGZvciB0aGUgYHhtbDJgIGFuZCBgaHR0cmAgcGFja2FnZXMsIHRodXMgd2UgY2FuIGp1c3QgaW5zdGFsbCBhbmQgbG9hZCB0aGUgYHJ2ZXN0YCBwYWNrYWdlIGFuZCBpdCB3aWxsIGluc3RhbGwgYW5kIGxvYWQgZGVwZW5kZW5jeSBwYWNrYWdlcyBsaWtlIGB4bWwyYCBhbmQgYGh0dHJgIGFuZCBhbGxvdyB1cyB0byB1c2UgZnVuY3Rpb25zIGZyb20gIGJvdGggb2YgdGhlc2UgcGFja2FnZXMuKioKCkluIGZhY3QsIHdoZW4gd2UgbG9hZCBgcnZlc3RgIHRoZSBmaXJzdCB0aW1lIHdlIHNlZToKCmBgYHtyLCBvdXQud2lkdGg9ICI2MCUiLCBlY2hvPUZBTFNFfQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCAicnZlc3QucG5nIikpCmBgYAoKSW4gdGhpcyBjYXNlLCB3ZSBhcmUgc2NyYXBpbmcgVGFibGUgMTEuMUEgZnJvbSB0aGUgd2Vic2l0ZS4gCkZpcnN0LCB3ZSBhc3NpZ24gdGhlIFVSTCB0byBhIGNoYXJhY3RlciBzdHJpbmcgdG8gdXNlIHdpdGhpbiB0aGUgYHJlYWRfaHRtbCgpYCBmdW5jdGlvbiBpbiB0aGUgYHhtbDJgIHBhY2thZ2UuIAoKYGBge3J9Ck5TRFVIX3VybCA8LSAiaHR0cHM6Ly93d3cuc2FtaHNhLmdvdi9kYXRhL3NpdGVzL2RlZmF1bHQvZmlsZXMvY2Joc3EtcmVwb3J0cy9OU0RVSERldGFpbGVkVGFiczIwMThSMi9OU0RVSERldFRhYnNTZWN0MTFwZTIwMTguaHRtIgpgYGAKCk9uZSBjb3VsZCBhbHNvIGRpcmVjdGx5IHVzZSB0aGUgVVJMIGJ1dCB0aGlzIGlzIGxlc3MgY29udmVuaWVudCBmb3IgcGlwaW5nLiAgCgoqKioKPGRldGFpbHM+IDxzdW1tYXJ5PkNsaWNrIGhlcmUgaWYgeW91IGFyZSB1bmZhbWlsaWFyIHdpdGggcGlwaW5nIGluIFIsIHdoaWNoIHVzZXMgdGhpcyBgJT4lYCBvcGVyYXRvcjwvc3VtbWFyeT4gIAoKCkJ5IFtwaXBpbmddKGh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9tYWdyaXR0ci92aWduZXR0ZXMvbWFncml0dHIuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSB3ZSBtZWFuIHVzaW5nIHRoZSBgJT4lYCBwaXBlIG9wZXJhdG9yIHdoaWNoIGlzIGFjY2Vzc2libGUgYWZ0ZXIgbG9hZGluZyB0aGUgYHRpZHl2ZXJzZWAgb3Igc2V2ZXJhbCBvZiB0aGUgcGFja2FnZXMgd2l0aGluIHRoZSB0aWR5dmVyc2UgbGlrZSBgZHBseXJgIGJlY2F1c2UgdGhleSBsb2FkIHRoZSBbYG1hZ3JpdHRyYCBwYWNrYWdlXShodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvbWFncml0dHIvdmlnbmV0dGVzL21hZ3JpdHRyLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0uIApUaGlzIGFsbG93cyB1cyB0byBwZXJmb3JtIG11bHRpcGxlIHNlcXVlbnRpYWwgc3RlcHMgb24gb25lIGRhdGEgaW5wdXQuIAoKCjwvZGV0YWlscz4gCgoKKioqCiAgClRoZW4sIHRoZSBgcmVhZF9odG1sKClgIGZ1bmN0aW9uIGFsbG93cyB1cyB0byBzYXZlIHRoZSBodG1sIGRvY3VtZW50IGZvciB0aGUgd2VicGFnZSBpbnNpZGUgUi4gCgpgYGB7cn0Kd2VicGFnZSA8LSAKICBOU0RVSF91cmwgJT4lCiAgeG1sMjo6cmVhZF9odG1sKCkgCndlYnBhZ2UKYGBgCgpUaGVuLCB3ZSB1c2UgdGhlIGBodG1sX25vZGVzKClgIGZ1bmN0aW9uIG9mIHRoZSBgcnZlc3RgIHBhY2thZ2UgdG8gc2VsZWN0IGp1c3QgdGhlIFRhYmxlIDExLjFBIGVsZW1lbnQgb2YgdGhlIHdlYnBhZ2UuCgpTZWUgdGhpcyBbdHV0b3JpYWxdKGh0dHA6Ly9mbHVrZW91dC5naXRodWIuaW8vIyl7dGFyZ2V0PSJfYmxhbmsifSAoYW5kIHRoZSBbYW5zd2Vyc10oaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vY2hyaXNtYW4vZmNiMGE4ODQ1OWNkOTgyMzlkYmU2ZDJkMjAwYjAyZDEpe3RhcmdldD0iX2JsYW5rIn0gaW4gY2FzZSB5b3UgZ2V0IHN0dWNrKSBvbiBDU1Mgc2VsZWN0b3JzIHRvIHVuZGVyc3RhbmQgbW9yZSBhYm91dCBob3cgdGhpcyBmdW5jdGlvbiB3b3JrcyB0byB1c2UgdGhlIGB4cGF0aGAgdG8gc2VsZWN0IHRoZSBlbGVtZW50cyBvZiBpbnRlcmVzdCBmcm9tIHRoZSB3ZWJwYWdlLgoKYGBge3J9CndlYnBhZ2VfZWxlbWVudCA8LQogIHdlYnBhZ2UgJT4lCiAgcnZlc3Q6Omh0bWxfbm9kZXMoeHBhdGg9Jy9odG1sL2JvZHkvZGl2WzRdL2RpdlsxXS90YWJsZScpCndlYnBhZ2VfZWxlbWVudCAKYGBgCgpGaW5hbGx5LCB0aGUgYGh0bWxfdGFibGUoKWAgZnVuY3Rpb24gb2YgdGhlIGBydmVzdGAgcGFja2FnZSBwYXJzZXMgdGhlIGh0bWwgb2JqZWN0IGludG8gYSBkYXRhIGZyYW1lLgoKYGBge3J9CnRhYmxlMTEuMWEgPC0gCiAgd2VicGFnZV9lbGVtZW50ICU+JQogIHJ2ZXN0OjpodG1sX3RhYmxlKCkKCnByaW50KHRhYmxlMTEuMWEsIG1heCA9IDIpCmdsaW1wc2UodGFibGUxMS4xYSkKYGBgCgpXZSBjYW4gc2VlIHRoYXQgdGhlIG91dHB1dCBpcyBhIGxpc3Qgd2l0aCBvbmUgZWxlbWVudCwgdG8gZXh0cmFjdCB0aGUgZGF0YSBmcm9tIHRoZSBsaXN0IHdlIHdpbGwgdXNlIGJyYWNrZXRzIGBbW11dYCB0byBzZWxlY3QgdGhlIGZpcnN0IGVsZW1lbnQgb2YgdGhlIGxpc3QuCgpgYGB7cn0KdGFibGUxMS4xYSA8LSB0YWJsZTExLjFhW1sxXV0KYGBgCgoKUHV0dGluZyB0aGlzIGFsbCBvZiB0aGlzIHRvZ2V0aGVyIHdlIGNhbiBkbyB0aGUgZW50aXJlIHByb2Nlc3MgbGlrZSB0aGlzIHdpdGggb3VyIHBpcGUgb3BlcmF0b3IgYCU+JWAuCgpgYGB7cn0KdGFibGUxMS4xYSA8LSAKICBOU0RVSF91cmwgJT4lCiAgeG1sMjo6cmVhZF9odG1sKCkgJT4lCiAgcnZlc3Q6Omh0bWxfbm9kZXMoeHBhdGg9Jy9odG1sL2JvZHkvZGl2WzRdL2RpdlsxXS90YWJsZScpICU+JQogIHJ2ZXN0OjpodG1sX3RhYmxlKCkKdGFibGUxMS4xYSA8LSB0YWJsZTExLjFhW1sxXV0KYGBgCgoKTm93LCB3ZSBuZWVkIHRvIHJlcGVhdCB0aGUgYWJvdmUgcHJvY2VzcyBmb3IgdGhlIG90aGVyIHRhYmxlcyB3ZSBhcmUgaW50ZXJlc3RlZCBpbi4gCgojIyMgV3JpdGluZyBhIGZ1bmN0aW9uIHRvIHNjcmFwZSBtdWx0aXBsZSB0YWJsZXMKCk9uZSBvcHRpb24gaXMgdG8gY29weSBhbmQgcGFzdGUgY29kZSB3ZSB3cm90ZSBhYm92ZS4gCkhvd2V2ZXIsIHRoaXMgaXMgbm90IHZlcnkgZWZmaWNpZW50IGFuZCBpcyBlcnJvciBwcm9uZS4KQWx0ZXJuYXRpdmVseSwgd2UgY2FuIGNyZWF0ZSBhIFIgZnVuY3Rpb24gdG8gYWNjb21wbGlzaCB0aGlzIHN1Y2NpbmN0bHkuIApGdW5jdGlvbnMgYWxsb3cgdXMgdG8gcGVyZm9ybSB0aGUgc2FtZSBwcm9jZXNzIG9uIG11bHRpcGxlIGRhdGEgaW5wdXRzLiAKU2VlIFt0aGlzIG90aGVyIGNhc2Ugc3R1ZHldKGh0dHBzOi8vb3BlbmNhc2VzdHVkaWVzLmdpdGh1Yi5pby9vY3MtYmxvb21iZXJnLXZhcGluZy1jYXNlLXN0dWR5Lyl7dGFyZ2V0PSJfYmxhbmsifSBmb3IgbW9yZSBkZXRhaWxzIGFib3V0IGhvdyB0byB3cml0ZSBhIGZ1bmN0aW9uLgoKSW4gZ2VuZXJhbCwgdGhlIHByb2Nlc3Mgb2Ygd3JpdGluZyBmdW5jdGlvbnMgaW52b2x2ZXMgZmlyc3Qgc3BlY2lmeWluZyBhbiBpbnB1dCB0aGF0IGlzIHVzZWQgd2l0aGluIHRoZSBmdW5jdGlvbiB0byBjcmVhdGUgYW4gb3V0cHV0LiBJbiB0aGlzIGNhc2UsIHRoZSBkYXRhIGlucHV0IGlzIGBYUEFUSGAsIHdoaWNoIHdpbGwgYmUgcmVwbGFjZWQgYnkgYW4gYWN0dWFsIFhQYXRoIGFuZCB0aGVuIHVzZWQgaW4gdGhlIHN1YnNlcXVlbnQgc3RlcHMgdG8gc2NyYXBlIHRoZSBkYXRhIGZyb20gZWFjaCB0YWJsZSB0aGF0IGFuIFhQYXRoIGlzIHN1cHBsaWVkIGZvci4KCldlIHdpbGwgY2FsbCB0aGlzIGZ1bmN0aW9uIGBzY3JhcGVyYC4KCmBgYHtyfQpzY3JhcGVyIDwtIGZ1bmN0aW9uKFhQQVRIKXsKICBOU0RVSF91cmwgPC0gImh0dHBzOi8vd3d3LnNhbWhzYS5nb3YvZGF0YS9zaXRlcy9kZWZhdWx0L2ZpbGVzL2NiaHNxLXJlcG9ydHMvTlNEVUhEZXRhaWxlZFRhYnMyMDE4UjIvTlNEVUhEZXRUYWJzU2VjdDExcGUyMDE4Lmh0bSIKICB0YWJsZSA8LSBOU0RVSF91cmwgJT4lCiAgcmVhZF9odG1sKCkgJT4lCiAgaHRtbF9ub2Rlcyh4cGF0aD1YUEFUSCkgJT4lCiAgaHRtbF90YWJsZSgpCiAgb3V0cHV0IDwtIHRhYmxlW1sxXV0KICBvdXRwdXQKfQpgYGAKCk5vdyB3ZSBjYW4gYXBwbHkgdGhlIGZ1bmN0aW9uIHdlIGNyZWF0ZWQgdG8gZWFjaCBvZiB0aGUgWFBhdGhzIGZvciBlYWNoIG9mIHRoZSB0YWJsZXMgb24gdGhlIHdlYnNpdGUgdGhhdCB3ZSB3b3VsZCBsaWtlIHRvIHVzZSBpbiBvdXIgZGF0YSBhbmFseXNpcy4KCmBgYHtyfQp0YWJsZTExLjFiIDwtIHNjcmFwZXIoWFBBVEggPSAiL2h0bWwvYm9keS9kaXZbNF0vZGl2WzJdL3RhYmxlIikKdGFibGUxMS4yYSA8LSBzY3JhcGVyKFhQQVRIID0gJy9odG1sL2JvZHkvZGl2WzRdL2RpdlszXS90YWJsZScpCnRhYmxlMTEuMmIgPC0gc2NyYXBlcihYUEFUSCA9ICcvaHRtbC9ib2R5L2Rpdls0XS9kaXZbNF0vdGFibGUnKQp0YWJsZTExLjNhIDwtIHNjcmFwZXIoWFBBVEggPSAnL2h0bWwvYm9keS9kaXZbNF0vZGl2WzVdL3RhYmxlJykKdGFibGUxMS4zYiA8LSBzY3JhcGVyKFhQQVRIID0gJy9odG1sL2JvZHkvZGl2WzRdL2Rpdls2XS90YWJsZScpCnRhYmxlMTEuNGEgPC0gc2NyYXBlcihYUEFUSCA9ICcvaHRtbC9ib2R5L2Rpdls0XS9kaXZbN10vdGFibGUnKQp0YWJsZTExLjRiIDwtIHNjcmFwZXIoWFBBVEggPSAnL2h0bWwvYm9keS9kaXZbNF0vZGl2WzhdL3RhYmxlJykKYGBgCgoKR3JlYXQhIFdlIGhhdmUgc3VjY2Vzc2Z1bGx5IHNjcmFwZWQgdGhlIGRhdGEgZnJvbSB0aGUgd2ViIGludG8gUiEKCk5leHQsIHdlIG5lZWQgdG8gd3JhbmdsZSB0aGUgZGF0YS4KCgojIyAqKkRhdGEgV3JhbmdsaW5nKioKKioqIAoKTm93IHRoYXQgd2UgaGF2ZSBpbXBvcnRlZCB0aGUgZGF0YSwgbGV0J3Mgc2VlIGlmIHdlIGNhbiB3cmFuZ2xlIGEgdGFibGUuIApTaW5jZSB0aGUgZGF0YSBhcHBlYXIgdG8gYmUgZm9ybWF0dGVkIGluIGEgc2ltaWxhciB3YXkgaW4gZWFjaCBvZiB0aGUgdGFibGVzLCBpdCBpcyBsaWtlbHkgdGhhdCB3aGF0ZXZlciBzdGVwcyB3ZSB0YWtlIHRvIHdyYW5nbGUgdGhpcyBmaXJzdCB0YWJsZSB3aWxsIGFsc28gYmUgbmVjZXNzYXJ5IGluIHRoZSB3cmFuZ2xpbmcgb2Ygc3Vic2VxdWVudCB0YWJsZXMuIApUaGlzIGlzIGJlY2F1c2Ugd2VsbC1tYWludGFpbmVkIGRhdGEgc291cmNlcyBvZnRlbiBmb3JtYXQgZGlmZmVyZW50IGRhdGFzZXRzIHNpbWlsYXJseS4gCldlIGNhbiB0YWtlIGFkdmFudGFnZSBvZiB0aGlzIHNpbWlsYXJpdHkgdG8gc3BlZWQgdXAgdGhlIHdyYW5nbGluZyBwcm9jZXNzLiAKCgojIyMgKipUYWJsZTExLjFhKioKCkZpcnN0LCB3ZSB3YW50IHRvIHJlbW92ZSB0aGUgbGFzdCByb3cgb2Ygb3VyIGRhdGEgZnJhbWUsIHdoaWNoIGhhcHBlbnMgdG8gYmUgdGhlIGxlZ2VuZCBvZiBvdXIgdGFibGUuIApSZWNhbGwgZnJvbSBsb29raW5nIGF0IHRoZSB3ZWJzaXRlIHRoYXQgdGhlcmUgaXMgYSBsZWdlbmQgZm9yIHRoaXMgdGFibGUuCgpgYGB7ciwgZWNobyA9IEZBTFNFfQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCAidGFibGUxMS4xYS5wbmciKSkKYGBgCgpXZSBjYW4gdGFrZSBhIGxvb2sgYXQgdGhlIGxhc3Qgcm93IHVzaW5nIHRoZSBgdGFpbGAgZnVuY3Rpb24gb2YgdGhlIGBkcGx5cmAgcGFja2FnZS4gV2UgY2FuIHNwZWNpZnkgdGhhdCB3ZSBvbmx5IHdhbnQgdG8gc2VlIHRoZSBsYXN0IHJvdyBieSB1c2luZyB0aGUgYG4gPSAxYCBhcmd1bWVudC4KCmBgYHtyfQp0YWJsZTExLjFhICU+JQogIGRwbHlyOjphc190aWJibGUoKSAlPiUKICB0YWlsKG4gPSAxKQpgYGAKCldlIGNhbiBzZWUgdGhhdCB0aGUgbGVnZW5kIGlzIHJlcGVhdGVkIGZvciBldmVyeSBjb2x1bW4uIApMZXQncyB0YWtlIGEgbG9vayBhdCB0aGUgeWVhciAyMDA0IGNvbHVtbi4KYGBge3J9CnRhYmxlMTEuMWEgJT4lCiAgZHBseXI6OmFzX3RpYmJsZSgpICU+JSAgCiAgc2VsZWN0KGAyMDA0YCkgJT4lCiAgdGFpbChuID0gMSkKYGBgCgpMZXQncyBzYXZlIHRoaXMgc28gdGhhdCB3ZSBjYW4gcmVmZXIgYmFjayB0byBpdCBsYXRlcjoKYGBge3J9CmxlZ2VuZCA8LSB0YWJsZTExLjFhICU+JQogIGFzX3RpYmJsZSgpICU+JSAgCiAgc2VsZWN0KGAyMDA0YCkgJT4lCiAgdGFpbChuID0gMSkKYGBgCgpBbm90aGVyIHdheSB0byBsb29rIGF0IHRoZSBsYXN0IHJvdyBpcyB0byB1c2UgdGhlIGBuKClgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UuIApUaGlzIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIGluc2lkZSBvdGhlciBgZHBseXJgIGZ1bmN0aW9ucyBhbmQgaXQgY291bnRzIHRoZSB0b3RhbCBudW1iZXIgb2Ygb2JzZXJ2YXRpb25zIG9mIGEgZ3JvdXAuIApXaXRoaW4gdGhlIFtgc2xpY2UoKWAgZnVuY3Rpb25dKGh0dHBzOi8vZHBseXIudGlkeXZlcnNlLm9yZy9yZWZlcmVuY2Uvc2xpY2UuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlLCBpdCBhbGxvd3MgeW91IHRvIHJlZmVyIHRoZSBmdWxsIGxlbmd0aCBvZiB0aGUgb2JqZWN0LgoKYGBge3J9CnRhYmxlMTEuMWEgJT4lCiAgZHBseXI6OmFzX3RpYmJsZSgpICU+JQogIHNsaWNlKG4oKSkgCmBgYApXZSBjYW4gdXNlIHRoZSBgc2xpY2UoKWAgZnVuY3Rpb24gb2YgdGhlIGBkcGx5cmAgcGFja2FnZSB0byByZW1vdmUgdGhpcyByb3csIGJ5IHVzaW5nIHRoZSBgc2xpY2VgZnVuY3Rpb24gdG8gc2VsZWN0IGZyb20gdGhlIGZpcnN0IHJvdyB1c2luZyBgMTpgIHRvIHRoZSBzZWNvbmQgdG8gbGFzdCByb3cgdXNpbmcgYG4oKS0xYC4KCldlIGFyZSBhbHNvIGdvaW5nIHRvIHVzZSBhIHNwZWNpYWwgcGlwZSBvcGVyYXRvciBmcm9tIHRoZSBbYG1hZ3JpdHRyYCBwYWNrYWdlXShodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvbWFncml0dHIvdmlnbmV0dGVzL21hZ3JpdHRyLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gY2FsbGVkIHRoZSBjb21wb3VuZCBhc3NpZ25tZW50IHBpcGUtb3BlcmF0b3Igb3Igc29tZXRpbWVzIHRoZSBkb3VibGUgcGlwZSBvcGVyYXRvci4gClRoaXMgYWxsb3dzIHVzIHRvIHVzZSB0aGUgYHRhYmxlMTEuMWFgIGFzIG91ciBpbnB1dCBhbmQgcmVhc3NpZ24gaXQgYXQgdGhlIGVuZCBhZnRlciBhbGwgdGhlIHN0ZXBzIGhhdmUgYmVlbiBwZXJmb3JtZWQuCgpXZSB3aWxsIGFsc28gZmlyc3QgY2hhbmdlIHRoZSBkYXRhIHRvIGJlIGEgW3RpYmJsZV0oaHR0cHM6Ly90aWJibGUudGlkeXZlcnNlLm9yZy8jOn46dGV4dD1BJTIwdGliYmxlJTJDJTIwb3IlMjB0YmxfZGYlMjAlMkMlMjBpcyxtb2Rlcm4lMjByZWltYWdpbmluZyUyMG9mJTIwdGhlJTIwZGF0YS4mdGV4dD1UaWJibGVzJTIwYXJlJTIwZGF0YS4sYSUyMHZhcmlhYmxlJTIwZG9lcyUyMG5vdCUyMGV4aXN0KS4pLCB3aGljaCBpcyB0aGUgYHRpZHl2ZXJzZWAgdmVyc2lvbiBvZiBhIGRhdGEgZnJhbWUgdXNpbmcgdGhlIGBhc190aWJibGUoKWAgZnVuY3Rpb24gb2YgdGhlIGBkcGx5cmAgcGFja2FnZSBhbmQgdGhlIGB0aWJibGVgIHBhY2thZ2UuCgpgYGB7cn0KdGFibGUxMS4xYSAlPD4lCiAgZHBseXI6OmFzX3RpYmJsZSgpICU+JQogIHNsaWNlKDE6KG4oKS0xKSkKYGBgCgpOb3cgbGV0J3MgdGFrZSBhIGxvb2sgYXQgZGF0YToKYGBge3J9CmhlYWQodGFibGUxMS4xYSkKYGBgCgpHcmVhdCEgV2UgY2FuIHNlZSB0aGUgdGhlIGxlZ2VuZCBpcyBubyBsb25nZXIgcGFydCBvZiB0aGUgZGF0YS4KCk5vdyBsZXQncyB1c2UgdGhlIGxlZ2VuZCB0byByZWNvZGUgdGhlIGRhdGEuIApUaGVyZSBhcmUgbWFueSBkaWZmZXJlbnQgdmFsdWVzIGZvciBtaXNzaW5nIGRhdGEsIHRoYXQgd2Ugd291bGQgbGlrZSB0byByZXBsYWNlIHdpdGggYE5BYCBpbnN0ZWFkLgpXZSBjYW4gdXNlIHRoZSBgcHVsbCgpYCBmdW5jdGlvbiBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlIHRvIHRha2UgYSBsb29rIGF0IHRoZSBsZWdlbmQgZGF0YToKCmBgYHtyfQpwdWxsKGxlZ2VuZCwgYDIwMDRgKQpgYGAKCkxvb2tzIGxpa2Ugd2Ugd2FudCB0byByZXBsYWNlIHZhbHVlcyB0aGF0IGFyZTogYCpgLCBgLS1gLCBgZGFgLCBgbmNgLCBhbmQgYG5yYC4gCldlIGNhbiB1c2UgdGhlIGBuYV9pZigpYCBmdW5jdGlvbiB0byByZWNvZGUgdGhlc2UgdmFsdWVzIHRvIGBOQWAuCgoKCmBgYHtyfQp0YWJsZTExLjFhICU8PiUKICBkcGx5cjo6bmFfaWYoIm5jIikgJT4lCiAgZHBseXI6Om5hX2lmKCItLSIpICU+JQogIGRwbHlyOjpuYV9pZigiIikgJT4lCiAgZHBseXI6Om5hX2lmKCIqIikKCmhlYWQodGFibGUxMS4xYSkKYGBgCkxldCdzIGxvb2sgYXQgdGhlIGNvbHVtbiBuYW1lcyBpbiBvdXIgdGFibGU6IApgYGB7cn0KY29sbmFtZXModGFibGUxMS4xYSkKYGBgCgpMZXQncyByZW5hbWUgdGhlIGZpcnN0IGNvbHVtbiB1c2luZyB0aGUgYHJlbmFtZSgpYCBmdW5jdGlvbiBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlLiAKVGhpcyByZXF1aXJlcyBsaXN0aW5nIHRoZSBuZXcgbmFtZSBmaXJzdCBsaWtlIHNvOiBgbmV3X25hbWUgPSBvbGRfbmFtZWAuCgpgYGB7cn0KdGFibGUxMS4xYSAlPD4lCiAgZHBseXI6OnJlbmFtZShNSFNfc2V0dGluZyA9IGBTZXR0aW5nIFdoZXJlIE1lbnRhbCBIZWFsdGggU2VydmljZVdhcyBSZWNlaXZlZGApCgpoZWFkKHRhYmxlMTEuMWEpCmBgYAoKTmljZSEKCk5vdyB5b3UgbWF5IG5vdGljZSB0aGF0IHRoZSBpbmRpdmlkdWFsIHZhbHVlcyBoYXZlIGFuIGAiYSJgIGFmdGVyIHRoZSBudW1lcmljIHZhbHVlLgoKQWNjb3JkaW5nIHRvIHRoZSBsZWdlbmQgdGhpcyBpbmRpY2F0ZXMgaWYgInRoZSBkaWZmZXJlbmNlIGJldHdlZW4gdGhpcyBlc3RpbWF0ZSBhbmQgdGhlIDIwMTggZXN0aW1hdGUgaXMgc2lnbmlmaWNhbnQgYXQgdGhlICRcYWxwaGEkPS4wNSBsZXZlbC4iCgpXaGlsZSB0aGlzIGlzIHVzZWZ1bCBpbmZvcm1hdGlvbiwgaXQgbWFrZXMgaXQgZGlmZmljdWx0IHRvIHdvcmsgd2l0aCBvdXIgbnVtZXJpYyB2YWx1ZXMsIHNvIHdlIHdhbnQgdG8gcmVtb3ZlIHRoZW0uCgpTaW5jZSBsb3dlciBjYXNlICJhIiB2YWx1ZXMgb2NjdXIgaW4gdGhlIGZpcnN0IGNvbHVtbiB2YWx1ZXMsIHdlIHdhbnQgdG8gbWFrZXMgc3VyZSB3ZSBkb24ndCByZW1vdmUgdGhlc2UuCgpTbyBob3cgY2FuIHdlIGRvIHRoaXM/IFdlIGNhbiB1c2UgdGhlIGBzdHJpbmdyYCBwYWNrYWdlIHRvIG1vZGlmeSBjaGFyYWN0ZXIgc3RyaW5ncy4gCkFsc28sIHdlIGNhbiB1c2UgdGhlIGBkcGx5cmAgZnVuY3Rpb25zIGBtdXRhdGUoKWAsIGBzZWxlY3QoKWAgYW5kIGBhY3Jvc3MoKWAgdG8gc3BlY2lmeSB3YW50IGNvbHVtbnMgd2Ugd2FudCB0byBjaGFuZ2UuCgpDdXJyZW50bHkgYWxsIG9mIG91ciBkYXRhIGFyZSBjaGFyYWN0ZXIgc3RyaW5ncyBhcyBpbmRpY2F0ZWQgYnkgdGhlIGA8Y2hyPmAgdW5kZXIgdGhlIGNvbHVtbiBuYW1lcy4gCgoqKioKPGRldGFpbHM+IDxzdW1tYXJ5PiBDbGljayBoZXJlIGZvciBhbiBleHBsYW5hdGlvbiBvZiB3aGF0IGEgY2hhcmFjdGVyIHN0cmluZyBpcyA8L3N1bW1hcnk+CgpUaGVyZSBhcmUgc2V2ZXJhbCBjbGFzc2VzIG9mIGRhdGEgaW4gUiBwcm9ncmFtbWluZy4gCkNoYXJhY3RlciBpcyBvbmUgb2YgdGhlc2UgY2xhc3Nlcy4gCkEgY2hhcmFjdGVyIHN0cmluZyBpcyBhbiBpbmRpdmlkdWFsIGRhdGEgdmFsdWUgbWFkZSB1cCBvZiBjaGFyYWN0ZXJzLiAKVGhpcyBjYW4gYmUgYSBwYXJhZ3JhcGgsIGxpa2UgdGhlIGxlZ2VuZCBmb3IgdGhlIHRhYmxlLCBvciBpdCBjYW4gYmUgYSBzaW5nbGUgbGV0dGVyIG9yIG51bWJlciBsaWtlIHRoZSBsZXR0ZXIgYCJhImAgb3IgdGhlIG51bWJlciBgIjMiYC4gCklmIGRhdGEgYXJlIG9mIGNsYXNzIGNoYXJhY3RlciwgdGhhbiB0aGUgbnVtZXJpYyB2YWx1ZXMgd2lsbCBub3QgYmUgcHJvY2Vzc2VkIGxpa2UgYSBudW1lcmljIHZhbHVlIGluIGEgbWF0aGVtYXRpY2FsIHNlbnNlLiAKSWYgeW91IHdhbnQgeW91ciBudW1lcmljIHZhbHVlcyB0byBiZSBpbnRlcnByZXRlZCB0aGF0IHdheSwgdGhleSBuZWVkIHRvIGJlIGNvbnZlcnRlZCB0byBhIG51bWVyaWMgY2xhc3MuIApUaGUgb3B0aW9ucyB0eXBpY2FsbHkgdXNlZCBhcmUgaW50ZWdlciAod2hpY2ggaGFzIG5vIGRlY2ltYWwgcGxhY2UpIGFuZCBkb3VibGUgcHJlY2lzaW9uICh3aGljaCBoYXMgYSBkZWNpbWFsIHBsYWNlKS4gCgo8L2RldGFpbHM+CgoKKioqCiAgClRoZSBgc3RyaW5ncmAgcGFja2FnZSBoYXMgZnVuY3Rpb25zIHRoYXQgYWxsb3cgdXMgdG8gcmVwbGFjZSAodXNpbmcgdGhlIGBzdHJfcmVwbGFjZSgpYCBmdW5jdGlvbikgb3IgcmVtb3ZlICh1c2luZyB0aGUgYHN0cl9yZW1vdmUoKWAgZnVuY3Rpb24pIGNoYXJhY3RlcnMuIAoKVG8gdXNlIHRoZXNlLCB3ZSBuZWVkIHRvIGJlIGFibGUgdG8gc3BlY2lmeSB3aGF0IHdlIHdhbnQgdG8gcmVtb3ZlIGFuZCByZXBsYWNlLiAKCkhlcmUgaXMgYSBwYXJ0IG9mIGEgW2NoZWF0c2hlZXRdKGh0dHBzOi8vcnN0dWRpby5jb20vcmVzb3VyY2VzL2NoZWF0c2hlZXRzLyl7dGFyZ2V0PSJfYmxhbmsifSBhYm91dCBzdHJpbmcgbWFuaXB1bGF0aW9uIGZyb20gUlN0dWRpby4KCmBgYHtyLCBlY2hvPUZBTFNFfQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCAicmVnZXgucG5nIikpCmBgYAoKV2UgY2FuIHNlZSB0aGF0IHdlIGNhbiByZWZlciB0byBhbnkgZGlnaXQgKHN1Y2ggYXMgMSwgMiwgMyBldGMuKSBhcyBgWzpkaWdpdDpdYC4KV2UgY2FuIGFsc28gc2VlIHRoYXQgd2UgY2FuIHJlZmVyIHRvIGFueSBwdW5jdHVhdGlvbiBtYXJrIGFzIGBbOnB1bmN0Ol1gLgpGaW5hbGx5LCB3ZSBzZWUgdGhhdCBzcGFjZXMgYW5kIHRhYnMgY2FuIGJlIHJlZmVycmVkIHRvIGFzIGBbOmJsYW5rOl1gLgoKSWYgd2UgdGFrZSBhIGNsb3NlciBsb29rIGF0IHRoZSBmaXJzdCBjb2x1bW4gb2Ygb3VyIHRhYmxlICh1c2luZyB0aGUgYHB1bGwoKWAgZnVuY3Rpb24gb2YgdGhlIGBkcGx5cmAgcGFja2FnZSksIHdlIGNhbiBzZWUgdGhhdCBiZXNpZGVzIHRoZSBgImEiYCB2YWx1ZXMgdGhhdCB3ZSBzZWUgYWRqYWNlbnQgdG8gb3VyIG51bWVyaWMgdmFsdWVzIGluIHRoZSBib2R5IG9mIHRoZSB0YWJsZSwgd2UgYWxzbyBoYXZlIHNvbWUgbGFyZ2Ugd2hpdGUgc3BhY2VzLCBzb21lIG51bWVyaWMgdmFsdWVzLCBpbnN0YW5jZXMgb2YgYFxyXG5gLCBhcyB3ZWxsIGFzIHNvbWUgY29tbWFzIGFuZCBvdGhlciBwdW5jdHVhdGlvbiBtYXJrcy4gCgpgYGB7cn0KdGFibGUxMS4xYSAlPiUgCiAgcHVsbChNSFNfc2V0dGluZykKYGBgCgoKV2UgY2FuIHVzZSB0aGUgYHN0cl9yZW1vdmVfYWxsKClgIGZ1bmN0aW9uLCB3aGljaCBpcyBhIHZhcmlhbnQgb2YgdGhlIGBzdHJfcmVtb3ZlKClgIGZ1bmN0aW9uIG9mIHRoZSBgc3RyaW5ncmAgcGFja2FnZS4gClRoaXMgYWxsb3dzIHVzIHRvIHJlbW92ZSBhbGwgb2NjdXJyZW5jZXMgb2Ygc3BlY2lmaWVkIGNoYXJhY3RlcnMgaW4gZWFjaCByb3cgcmF0aGVyIHRoYW4ganVzdCB0aGUgZmlyc3Qgb2NjdXJyZW5jZSAod2hpY2ggaXMgd2hhdCBgc3RyX3JlbW92ZSgpYCBkb2VzKSB0byByZW1vdmUgdGhlIGRpZ2l0IHZhbHVlcywgdGhlIGBcclxuYCBjaGFyYWN0ZXJzIGFuZCB0aGUgcHVuY3R1YXRpb24gbWFya3MgZnJvbSB0aGUgY29sdW1uIGNhbGxlZCBgTUhTX3NldHRpbmdgLgoKVXNpbmcgdGhlIGBtdXRhdGUoKWAgZnVuY3Rpb24sIHdlIHNwZWNpZnkgdGhhdCB3ZSB3YW50IHRvIGNoYW5nZSB0aGlzIHBhcnRpY3VsYXIgY29sdW1uIGFuZCByZXBsYWNlIGl0IHdpdGggYSB2ZXJzaW9uIG9mIHRoaXMgY29sdW1uIHRoYXQgaGFzIHJlbW92ZWQgY2hhcmFjdGVycyB0aGF0IG1hdGNoIGRpZ2l0cywgYHJcbmAgb3IgcHVuY3R1YXRpb24gbWFya3MuCgpXZSBuZWVkIHRvIHNwZWNpZnkgdGhhdCB0aGUgY2hhcmFjdGVyIHN0cmluZ3MgdGhhdCBzaG91bGQgYmUgdXNlZCBjYW4gYmUgZm91bmQgaW4gdGhlIGBNSFNfc2V0dGluZ2AgY29sdW1uIGJ5IHVzaW5nIHRoZSBgc3RyaW5nID1gIGFyZ3VtZW50IGFuZCB0aGUgcGF0dGVybnMgdG8gZmluZCBhbmQgcmVtb3ZlIGFyZSBzcGVjaWZpZWQgdXNpbmcgdGhlIGBwYXR0ZXJuID1gIGFyZ3VtZW50LgoKVG8gYWxsb3cgdXMgdG8gbG9vayBmb3IgYWxsIHRocmVlIG9mIHRoZXNlIHBhdHRlcm5zIGF0IHRoZSBzYW1lIHRpbWUsIHdlIGNhbiB1c2UgdGhlIGB8YCBzeW1ib2wgYmV0d2VlbiBlYWNoIHBhdHRlcm4uCgpgYGB7cn0KdGFibGUxMS4xYSAlPD4lCm11dGF0ZShNSFNfc2V0dGluZyA9IAogICAgICAgICBzdHJfcmVtb3ZlX2FsbChzdHJpbmcgPSBNSFNfc2V0dGluZywgCiAgICAgICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSAiWzpkaWdpdDpdfFxyXG58WzpwdW5jdDpdfCIpKQoKaGVhZCh0YWJsZTExLjFhKQpgYGAKCldlIGFsc28gd2FudCB0byByZXBsYWNlIHRoZSBzcGFjZXMgd2l0aCBhIHNpbmdsZSBzcGFjZS4gCldlIGNhbiBzZWUgdGhhdCBzb21ldGltZXMgdGhlcmUgYXBwZWFycyB0byBiZSBtb3JlIHRoYW4gb25lIHNwYWNlLiAKV2UgY2FuIHNwZWNpZnkgdGhhdCB3ZSB3YW50IGFueSBvY2N1cnJlbmNlIG9mIDEgb3IgbW9yZSB0byBiZSByZXBsYWNlZCBieSB1c2luZyB0aGUgYHsxLH1gIG5vdGF0aW9uLgoKU2VlIGhlcmUgZm9yIGFuIGV4cGxhbmF0aW9uIG9mIHRoaXMgb24gdGhlIGNoZWF0IHNoZWV0OgoKYGBge3IsIGVjaG89RkFMU0V9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsICJxdWFudGlmaWVycy5wbmciKSkKYGBgCgpTbywgd2Ugd2lsbCB1c2UgdGhlIGBzdHJfcmVwbGFjZV9hbGwoKWAgZnVuY3Rpb24gb2YgdGhlIGBzdHJpbmdyYCBwYWNrYWdlLgpJbiB0aGlzIGNhc2UsIHdlIGFsc28gbmVlZCB0byBzcGVjaWZ5IGEgcmVwbGFjZW1lbnQgd2l0aCB0aGUgYHJlcGxhY2VtZW50ID0gYCBhcmd1bWVudC4KCmBgYHtyfSAKdGFibGUxMS4xYSAlPD4lCm11dGF0ZShNSFNfc2V0dGluZyA9IAogICAgICAgICBzdHJfcmVwbGFjZV9hbGwoc3RyaW5nID0gTUhTX3NldHRpbmcsCiAgICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuID0gIls6Ymxhbms6XXsxLH0iLCAKICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VtZW50ID0gIiAiKSkKCmhlYWQodGFibGUxMS4xYSkKYGBgCgpOZXh0LCB3ZSB3aWxsIHJlbW92ZSB0aGUgImEiIHZhbHVlcyBhbmQgdGhlIGNvbW1hcyBmcm9tIHRoZSBib2R5IG9mIHRoZSB0YWJsZSB1c2luZyB0aGUgYHN0cl9yZW1vdmVfYWxsKClgIGZ1bmN0aW9uIHlldCBhZ2Fpbi4KSG93ZXZlciwgdGhpcyB0aW1lIHRvIHNwZWNpZnkgdGhhdCB3ZSB3YW50IGFsbCBjb2x1bW5zIGV4Y2VwdCB0aGUgZmlyc3QgY29sdW1uIGNhbGxlZCBgTUhTX3NldHRpbmdgLCB3ZSBjYW4gdXNlIHRoZSBgYWNyb3NzKClgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UuIApUaGlzIGFsbG93cyB1cyB0byBzcGVjaWZ5IHdoYXQgY29sdW1ucyB3ZSB3YW50IHRvIG11dGF0ZSBieSB1c2luZyB0aGUgYC5jb2xzID0gYCBhcmd1bWVudC4gCldlIGNhbiBzZWxlY3QgYWxsIGNvbHVtbnMgZXhjZXB0IHRoZSBmaXJzdCBjb2x1bW4gY2FsbGVkIGBNSFNfc2V0dGluZ2AgYnkgdXNpbmcgYSBtaW51cyBzaWduIGAtYCBpbiBmcm9udCBvZiB0aGUgY29sdW1uIG5hbWUuCgpgYGB7cn0KdGFibGUxMS4xYSAlPD4lCiAgbXV0YXRlKGRwbHlyOjphY3Jvc3MoLmNvbHMgPSAtTUhTX3NldHRpbmcsCiAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5ncjo6c3RyX3JlbW92ZV9hbGwsICJhfCwiKSkKCmhlYWQodGFibGUxMS4xYSkKYGBgCgpPdXIgdGFibGUgaXMgbG9va2luZyBtdWNoIGJldHRlciEKCldlIGFsc28gd2FudCB0byBjaGFuZ2Ugb3VyIHZhbHVlcyB0byBiZSBudW1lcmljIGFzIG9wcG9zZWQgdG8gY2hhcmFjdGVyIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIG1hdGhlbWF0aWNhbCBmdW5jdGlvbnMuIApXZSBjYW4gdXNlIHRoZSBiYXNlIGBhcy5udW1lcmljKClgIGZ1bmN0aW9uLiAKQWdhaW4gd2Ugd2lsbCB1c2UgdGhlIGBhY3Jvc3MoKWAgZnVuY3Rpb24gdG8gaW5kaWNhdGUgd2hhdCB2YXJpYWJsZXMgd2Ugd2lzaCB0byBtdXRhdGUuCgpgYGB7cn0KdGFibGUxMS4xYSAlPD4lCiAgbXV0YXRlKGFjcm9zcyguY29scyA9LU1IU19zZXR0aW5nLCBhcy5udW1lcmljKSkKCmhlYWQodGFibGUxMS4xYSkKYGBgCgpXZSB3b3VsZCBhbHNvIGxpa2UgdG8gYWRkIGEgYHR5cGVgIGFuZCBgc3VidHlwZWAgdmFyaWFibGUsIHRoYXQgc3BlY2lmaWVzIHRoZSBnZW5lcmFsIGNhdGVnb3JpZXMgb2Ygc2V0dGluZ3Mgd2hlcmUgc2VydmljZXMgd2VyZSByZWNlaXZlZCwgYXMgd2VsbCBhcyByZW1vdmUgYSBjb3VwbGUgb2Ygcm93cyB0aGF0IGFyZSBjb21wbGV0ZWx5IGVtcHR5LiAKVGhlc2UgYXJlIHRoZSByb3dzIHdoZXJlIHRoZSBmaXJzdCBjb2x1bW4gdmFsdWVzIGFyZSBgR2VuZXJhbCBNZWRpY2luZWAgYW5kIGBKdXZlbmlsZSBKdXN0aWNlYCwgYW5kIGBDaGlsZCBXZWxmYXJlYC4gSWYgd2UgbG9vayBhdCB0aGUgd2Vic2l0ZSwgd2UgY2FuIHNlZSB0aGF0IHRoZXNlIHdlcmUgbGVhZGluZyBsaW5lcyB3aXRoIG5vIGRhdGEuCgpgYGB7ciwgZWNobz1GQUxTRX0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgInRhYmxlMTEuMWEucG5nIikpCmBgYAoKRmlyc3QsIHdlIHdpbGwgYWRkIHRoZSBgdHlwZWAgYW5kIGBzdWJ0eXBlYCB2YXJpYWJsZXMgdXNpbmcgdGhlIGBtdXRhdGVgIGZ1bmN0aW9uLgoKYGBge3J9CnRhYmxlMTEuMWEgJTw+JQogIG11dGF0ZSh0eXBlID0gYyhyZXAoIlNwZWNpYWx0eSIsIDkpLCAKICAgICAgICAgICAgICAgICAgcmVwKCJOb25zcGVjaWFsdHkiLCAxMSkpKSAlPiUKICBtdXRhdGUoc3VidHlwZSA9IGMoIlNwZWNpYWx0eV90b3RhbCIsIAogICAgICAgICAgICAgICAgICAgICByZXAoIk91dHBhdGllbnQiLCA1KSwgCiAgICAgICAgICAgICAgICAgICAgIHJlcCgiSW5wYXRpZW50IiwgMyksIAogICAgICAgICAgICAgICAgICAgICAiTm9uc3BlY2lhbHR5X3RvdGFsIiwgCiAgICAgICAgICAgICAgICAgICAgIHJlcCgiRWR1Y2F0aW9uIiwgMyksIAogICAgICAgICAgICAgICAgICAgICByZXAoIkdlbmVyYWxfbWVkaWNpbmUiLCAyKSwKICAgICAgICAgICAgICAgICAgICAgcmVwKCJKdXZlbmlsZV9KdXN0aWNlIiwgMiksIAogICAgICAgICAgICAgICAgICAgICByZXAoIkNoaWxkX1dlbGZhcmUiLCAyKSwgCiAgICAgICAgICAgICAgICAgICAgICJjb21iaW5hdGlvbiIpKQpgYGAKCldlIGFsc28gd2FudCB0byBhZGQgYSB2YXJpYWJsZSB3aXRoIHNob3J0ZXIgbmFtZXMgZm9yIGxhYmVscyBpbiBwbG90cyBhbmQgc3RhdGlzdGljYWwgb3V0cHV0LgoKYGBge3J9CnRhYmxlMTEuMWEgJTw+JQogIG11dGF0ZShzaG9ydF9sYWJlbCA9IGMoIlNwZWNpYWx0eSB0b3RhbCIsIAogICAgICAgICAgICAgICAgICAgICAgICAgIk91dHBhdGllbnQgdG90YWwiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICJUaGVyYXBpc3QiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICJDbGluaWMiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICJEYXkgcHJvZ3JhbSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAiSW4taG9tZSBUaGVyYXBpc3QiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICJJbnBhdGllbnQgdG90YWwiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICJIb3NwaXRhbCIsIAogICAgICAgICAgICAgICAgICAgICAgICAgIlJlc2lkZW50aWFsIENlbnRlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAiTm9uc3BlY2lhbHR5IHRvdGFsIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAiU2Nob29sIHRvdGFsIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAiU2Nob29sIFRoZXJhcGlzdCIsIAogICAgICAgICAgICAgICAgICAgICAgICAgIlNjaG9vbCBQcm9ncmFtIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAiR2VuZXJhbCBNZWRpY2luZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAiRmFtaWx5IERyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICJKdXN0aWNlIFN5c3RlbSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAiSnVzdGljZSBTeXN0ZW0iLAogICAgICAgICAgICAgICAgICAgICAgICAgIldlbGZhcmUiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICJGb3N0ZXJjYXJlIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAiU3BlY2lhbHR5IENvbWJpbmF0aW9uIikpCmBgYAoKV2UgY2FuIHJlbW92ZSB0aGUgZW1wdHkgcm93cyB1c2luZyB0aGUgYGZpbHRlcigpYCBmdW5jdGlvbiBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlLiAKV2UgY2FuIHNwZWNpZnkgdGhhdCB3ZSBkb24ndCB3YW50IHRvIGtlZXAgdGhlc2Ugcm93cyBieSB1c2luZyB0aGUgYCE9YCBub3QgZXF1YWwgdG8gb3BlcmF0b3IuIAoKYGBge3J9CnRhYmxlMTEuMWEgJTw+JQogIGRwbHlyOjpmaWx0ZXIoTUhTX3NldHRpbmcgIT0gIkdlbmVyYWxfTWVkaWNpbmUiKSAlPiUKICBkcGx5cjo6ZmlsdGVyKE1IU19zZXR0aW5nICE9ICJKdXZlbmlsZV9KdXN0aWNlIikgJT4lCiAgZHBseXI6OmZpbHRlcihNSFNfc2V0dGluZyAhPSAiQ2hpbGRfV2VsZmFyZSIpCgpoZWFkKHRhYmxlMTEuMWEpCmBgYAoKRmluYWxseSwgd2Ugd291bGQgbGlrZSB0byBjaGFuZ2UgdGhlIHNoYXBlIG9mIG91ciB0YWJsZSBzbyB0aGF0IHdlIGhhdmUgYSBuZXcgY29sdW1uIHRoYXQgcmVwcmVzZW50cyB0aGUgeWVhciBhbmQgYSBuZXcgY29sdW1uIHRoYXQgcmVwcmVzZW50cyB0aGUgdmFsdWUgZm9yIHRoYXQgeWVhci4gClRvIGRvIHNvIHdlIHdpbGwgYmUgbWFraW5nIG91ciB0YWJsZSAibG9uZ2VyIiwgbWVhbmluZyB0aGF0IGl0IHdpbGwgaGF2ZSBmZXdlciBjb2x1bW5zIGFuZCBtb3JlIHJvd3MuIApTZWUgW2hlcmVdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1dpZGVfYW5kX25hcnJvd19kYXRhKXt0YXJnZXQ9Il9ibGFuayJ9IGZvciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IGRpZmZlcmVudCB0YWJsZSBmb3JtYXRzLCB0eXBpY2FsbHkgcmVmZXJyZWQgdG8gYXMgd2lkZSBhbmQgbG9uZyBvciBzb21ldGltZXMgbmFycm93LgoKV2Ugd2lsbCB1c2UgdGhlIGBwaXZvdF9sb25nZXIoKWAgZnVuY3Rpb24gb2YgdGhlIGB0aWR5cmAgcGFja2FnZSB0byBjaGFuZ2UgdGhlIHNoYXBlIG9mIG91ciB0YWJsZS4gCgpUaGVyZSBhcmUgMyBtYWluIGFyZ3VtZW50cyBpbiB0aGlzIGZ1bmN0aW9uOiAgIAoKMS4gYGNvbHNgIC0gd2hpY2ggc3BlY2lmaWVzIHdoYXQgY29sdW1ucyB0byBjb2xsYXBzZSAgCjIuIGBuYW1lc190b2AgLSB3aGljaCBzcGVjaWZpZXMgdGhlIG5hbWUgb2YgdGhlIG5ldyBjb2x1bW4gdGhhdCB3aWxsIGJlIGNyZWF0ZWQgdGhhdCB3aWxsIGNvbnRhaW4gdGhlIGNvbHVtbiBuYW1lcyBvZiB0aGUgY29sdW1ucyB5b3UgYXJlIGNvbGxhcHNpbmcgIAozLiBgdmFsdWVzX3RvYCAtIHdoaWNoIHNwZWNpZmllcyB0aGUgbmFtZSBvZiB0aGUgbmV3IGNvbHVtbiB0aGF0IHdpbGwgYmUgY3JlYXRlZCB0aGF0IHdpbGwgY29udGFpbiB0aGUgdmFsdWVzIGZyb20gdGhlIGNvbHVtbnMgeW91IGFyZSBjb2xsYXBzaW5nIAoKVG8gc3BlY2lmeSB0aGF0IHdlIHdhbnQgdG8gY29sbGFwc2UgYWxsIHRoZSBjb2x1bW5zIHRoYXQgaGF2ZSB5ZWFyIHZhbHVlcywgd2UgY2FuIGNob3NlIHRob3NlIHRoYXQgY29udGFpbiB0aGUgc3RyaW5nIGAiMjAiYCB1c2luZyB0aGUgYGNvbnRhaW5zKClgIGZ1bmN0aW9uIG9mIGBkcGx5cmAuIAoKRmluYWxseSwgd2Ugd2lsbCBtYWtlIHRoZSBgWWVhcmAgdmFyaWFibGUgbnVtZXJpYyBhcyB3ZWxsLgoKYGBge3J9CnRhYmxlMTEuMWEgJTw+JQogIHRpZHlyOjpwaXZvdF9sb25nZXIoY29scyA9IGNvbnRhaW5zKCIyMCIpLCAKICAgICAgICAgICAgICAgICAgICAgIG5hbWVzX3RvID0gIlllYXIiLAogICAgICAgICAgICAgICAgICAgICAgdmFsdWVzX3RvID0gIk51bWJlciIpICU+JQogIG11dGF0ZShZZWFyID0gYXMubnVtZXJpYyhZZWFyKSkKCmhlYWQodGFibGUxMS4xYSkKYGBgCgpXZSBjYW4gc2VlIHRoYXQgb3VyIHRhYmxlIGlzIG5vdyBtdWNoIGxvbmdlciAtIGFzIHdlIGhhdmUgYHIgZGltKHRhYmxlMTEuMWEpWzFdYCByb3dzIQoKIyMjIyB7LnF1ZXN0aW9uX2Jsb2NrfQo8Yj48dT4gUXVlc3Rpb24gT3Bwb3J0dW5pdHkgPC91PjwvYj4KCldoeSBkbyB3ZSBoYXZlIGByIGRpbSh0YWJsZTExLjFhKVsxXWAgcm93cyBub3c/CgojIyMjCgpOb3csIHdlIHNlZSB0aGF0IHRoZSBgWWVhcmAgYW5kIGBOdW1iZXJgIHZhcmlhYmxlcyBhcmUgb2YgY2xhc3MgZG91YmxlIGJlY2F1c2Ugb2YgdGhlIGA8ZGJsPmAgdW5kZXIgdGhlIGNvbHVtbiBuYW1lLgoKTGV0J3MgcmVtaW5kIG91cnNlbHZlcyB3aGF0IHRoZSByZXN0IG9mIHRoZSB0YWJsZXMgY29udGFpbjoKCgpUYWJsZSAgIHwgRGV0YWlscyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKLS0tfC0tLS0tLS0tLS0tLS0KVGFibGUgMTEuMUEgICAgICAgfCBTZXR0aW5ncyBXaGVyZSBNZW50YWwgSGVhbHRoIFNlcnZpY2VzIFdlcmUgUmVjZWl2ZWQgaW4gUGFzdCBZZWFyIGFtb25nIFBlcnNvbnMgQWdlZCAxMiB0byAxNzogTnVtYmVycyBpbiBUaG91c2FuZHMsIDIwMDItMjAxOCAgIApUYWJsZSAxMS4xQiAgICAgICB8IFNldHRpbmdzIFdoZXJlIE1lbnRhbCBIZWFsdGggU2VydmljZXMgV2VyZSBSZWNlaXZlZCBpbiBQYXN0IFllYXIgYW1vbmcgUGVyc29ucyBBZ2VkIDEyIHRvIDE3OiBQZXJjZW50YWdlcywgMjAwMi0yMDE4ICAKVGFibGUgMTEuMkEgICAgICAgfCAgTWFqb3IgRGVwcmVzc2l2ZSBFcGlzb2RlIGluIFBhc3QgWWVhciBhbW9uZyBQZXJzb25zIEFnZWQgMTIgdG8gMTcsIGJ5IERlbW9ncmFwaGljIENoYXJhY3RlcmlzdGljczogTnVtYmVycyBpbiBUaG91c2FuZHMsIDIwMDQtMjAxOApUYWJsZSAxMS4yQiAgICAgICB8IE1ham9yIERlcHJlc3NpdmUgRXBpc29kZSBpbiBQYXN0IFllYXIgYW1vbmcgUGVyc29ucyBBZ2VkIDEyIHRvIDE3LCBieSBEZW1vZ3JhcGhpYyBDaGFyYWN0ZXJpc3RpY3M6IFBlcmNlbnRhZ2VzLCAyMDA0LTIwMTgKVGFibGUgMTEuM0EgICAgICAgfCBNYWpvciBEZXByZXNzaXZlIEVwaXNvZGUgd2l0aCBTZXZlcmUgSW1wYWlybWVudCBpbiBQYXN0IFllYXIgYW1vbmcgUGVyc29ucyBBZ2VkIDEyIHRvIDE3LCBieSBEZW1vZ3JhcGhpYyBDaGFyYWN0ZXJpc3RpY3M6IE51bWJlcnMgaW4gVGhvdXNhbmRzLCAyMDA2LTIwMTgKVGFibGUgMTEuM0IgICAgICAgfCBNYWpvciBEZXByZXNzaXZlIEVwaXNvZGUgd2l0aCBTZXZlcmUgSW1wYWlybWVudCBpbiBQYXN0IFllYXIgYW1vbmcgUGVyc29ucyBBZ2VkIDEyIHRvIDE3LCBieSBEZW1vZ3JhcGhpYyBDaGFyYWN0ZXJpc3RpY3M6IFBlcmNlbnRhZ2VzLCAyMDA2LTIwMTgKVGFibGUgMTEuNEEgICAgICAgfCBSZWNlaXB0IG9mIFRyZWF0bWVudCBmb3IgRGVwcmVzc2lvbiBpbiBQYXN0IFllYXIgYW1vbmcgUGVyc29ucyBBZ2VkIDEyIHRvIDE3IHdpdGggTWFqb3IgRGVwcmVzc2l2ZSBFcGlzb2RlIGluIFBhc3QgWWVhciwgYnkgRGVtb2dyYXBoaWMgQ2hhcmFjdGVyaXN0aWNzOiBOdW1iZXJzIGluIFRob3VzYW5kcywgMjAwNC0yMDE4ClRhYmxlIDExLjRCICAgICAgIHwgUmVjZWlwdCBvZiBUcmVhdG1lbnQgZm9yIERlcHJlc3Npb24gaW4gUGFzdCBZZWFyIGFtb25nIFBlcnNvbnMgQWdlZCAxMiB0byAxNyB3aXRoIE1ham9yIERlcHJlc3NpdmUgRXBpc29kZSBpbiBQYXN0IFllYXIsIGJ5IERlbW9ncmFwaGljIENoYXJhY3RlcmlzdGljczogUGVyY2VudGFnZXMsIDIwMDQtMjAxOAoKT0ssIHNvIHRoZSBuZXh0IHRhYmxlIChUYWJsZTExLjFCKSBpcyB2ZXJ5IHNpbWlsYXIgdG8gVGFibGUxMS4xQSwgd2hpbGUgdGhlIHJlbWFpbmluZyB0YWJsZXMgaGF2ZSBpbmZvcm1hdGlvbiBhYm91dCBkZW1vZ3JhcGhpY3MuCgpBcyBhIHJlbWluZGVyIGhlcmUgYXJlIGFsbCBvZiB0aGUgc3RlcHMgdGhhdCB3ZSBwZXJmb3JtZWQgdG8gd3JhbmdsZSBgdGFibGUxMS4xYWA6CgpgYGB7ciwgZXZhbCA9IEZBTFNFfQp0YWJsZTExLjFhICU8PiUKICBkcGx5cjo6YXNfdGliYmxlKCkgJT4lCiAgc2xpY2UoMToobigpLTEpKSU+JQogIGRwbHlyOjpuYV9pZigibmMiKSAlPiUKICBkcGx5cjo6bmFfaWYoIi0tIikgJT4lCiAgZHBseXI6Om5hX2lmKCIiKSAlPiUKICBkcGx5cjo6bmFfaWYoIioiKSU+JQogIGRwbHlyOjpyZW5hbWUoTUhTX3NldHRpbmcgPSAKICAgICAgICAgICAgICAgICAgYFNldHRpbmcgV2hlcmUgTWVudGFsIEhlYWx0aCBTZXJ2aWNlV2FzIFJlY2VpdmVkYCkgJT4lCiAgbXV0YXRlKE1IU19zZXR0aW5nID0gCiAgICAgICAgIHN0cl9yZW1vdmVfYWxsKHN0cmluZyA9IE1IU19zZXR0aW5nLCAKICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuID0gIls6ZGlnaXQ6XXxcclxufFs6cHVuY3Q6XXwiKSkgJT4lCiAgbXV0YXRlKE1IU19zZXR0aW5nID0gCiAgICAgICAgIHN0cl9yZXBsYWNlX2FsbChzdHJpbmcgPSBNSFNfc2V0dGluZywKICAgICAgICAgICAgICAgICAgICAgICAgcGF0dGVybiA9ICJbOmJsYW5rOl17MSx9IiwgCiAgICAgICAgICAgICAgICAgICAgcmVwbGFjZW1lbnQgPSAiICIpKSAlPiUKICBtdXRhdGUoZHBseXI6OmFjcm9zcyguY29scyA9IC1NSFNfc2V0dGluZywKICAgICAgICAgICAgICAgIHN0cmluZ3I6OnN0cl9yZW1vdmVfYWxsLCAiYXwsIikpICU+JQogIG11dGF0ZShhY3Jvc3MoLU1IU19zZXR0aW5nLCBhcy5udW1lcmljKSkgJT4lCiAgbXV0YXRlKHR5cGUgPSBjKHJlcCgiU3BlY2lhbHR5IiwgOSksIHJlcCgiTm9uc3BlY2lhbHR5IiwgMTEpKSkgJT4lCiAgbXV0YXRlKHN1YnR5cGUgPWMoIlNwZWNpYWx0eV90b3RhbCIsIAogICAgICAgICAgICAgICAgICAgIHJlcCgiT3V0cGF0aWVudCIsIDUpLCAKICAgICAgICAgICAgICAgICAgICByZXAoIklucGF0aWVudCIsIDMpLCAKICAgICAgICAgICAgICAgICAgICAiTm9uc3BlY2lhbHR5X3RvdGFsIiwgCiAgICAgICAgICAgICAgICAgICAgcmVwKCJFZHVjYXRpb24iLCAzKSwgCiAgICAgICAgICAgICAgICAgICAgcmVwKCJHZW5lcmFsX21lZGljaW5lIiwgMiksCiAgICAgICAgICAgICAgICAgICAgcmVwKCJKdXZlbmlsZV9KdXN0aWNlIiwgMiksCiAgICAgICAgICAgICAgICAgICAgcmVwKCJDaGlsZF9XZWxmYXJlIiwgMiksIAogICAgICAgICAgICAgICAgICAgICJjb21iaW5hdGlvbiIpKSAlPiUKICBtdXRhdGUoc2hvcnRfbGFiZWwgPSBjKCJTcGVjaWFsdHkgdG90YWwiLCAiT3V0cGF0aWVudCB0b3RhbCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAiVGhlcmFwaXN0IiwgIkNsaW5pYyIsICJEYXkgcHJvZ3JhbSIsIAogICAgICAgICAgICAgICAgICAgICAgICAgIkluLWhvbWUgVGhlcmFwaXN0IiwgIklucGF0aWVudCB0b3RhbCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAiSG9zcGl0YWwiLCAiUmVzaWRlbnRpYWwgQ2VudGVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICJOb25zcGVjaWFsdHkgdG90YWwiLCAiU2Nob29sIHRvdGFsIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAiU2Nob29sIFRoZXJhcGlzdCIsICJTY2hvb2wgUHJvZ3JhbSIsIAogICAgICAgICAgICAgICAgICAgICAgICAgIkdlbmVyYWwgTWVkaWNpbmUiLCAiRmFtaWx5IERyIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAiSnVzdGljZSBTeXN0ZW0iLCAiSnVzdGljZSBTeXN0ZW0iLAogICAgICAgICAgICAgICAgICAgICAgICAgIldlbGZhcmUiLCAiRm9zdGVyY2FyZSIsIAogICAgICAgICAgICAgICAgICAgICAgICAgIlNwZWNpYWx0eSBDb21iaW5hdGlvbiIpKSAlPiUKICBkcGx5cjo6ZmlsdGVyKE1IU19zZXR0aW5nICE9ICJHZW5lcmFsX01lZGljaW5lIikgJT4lCiAgZHBseXI6OmZpbHRlcihNSFNfc2V0dGluZyAhPSAiSnV2ZW5pbGVfSnVzdGljZSIpICU+JQogIGRwbHlyOjpmaWx0ZXIoTUhTX3NldHRpbmcgIT0gIkNoaWxkX1dlbGZhcmUiKSAlPiUKICAgIHRpZHlyOjpwaXZvdF9sb25nZXIoY29scyA9IGNvbnRhaW5zKCIyMCIpLCAKICAgICAgICAgICAgICAgICAgICBuYW1lc190byA9ICJZZWFyIiwKICAgICAgICAgICAgICAgICAgIHZhbHVlc190byA9ICJOdW1iZXIiKSAlPiUKICAgbXV0YXRlKFllYXIgPSBhcy5udW1lcmljKFllYXIpKQpgYGAKCk5vdyB3ZSB3YW50IHRvIHdyYW5nbGUgdGFibGUxMS4xQiB3aGljaCBpcyBmb3JtYXR0ZWQgdGhlIG1vc3Qgc2ltaWxhcmx5LiBUbyBkbyBzbyB3ZSBjYW4gc2ltcGx5IHJ1biB0aGVzZSBzdGVwcyBvbiB0aGUgdXNpbmcgdGhlIGB0YWJsZTExLjFCYCBhcyB0aGUgaW5wdXQuIEZvciB0aGUgc2FrZSBvZiBlZHVjYXRpb24gaG93ZXZlciwgd2Ugd2lsbCBzaG93IHlvdSBob3cgeW91IGNvdWxkIG1ha2UgYSBmdW5jdGlvbiBpZiB3ZSBoYWQgc2V2ZXJhbCBtb3JlIHNpbWlsYXIgdGFibGVzIHRvIHdyYW5nbGUuIFRoaXMgd2lsbCBhbHNvIG1ha2UgaXQgZWFzaWVyIHRvIHdyaXRlIGEgZnVuY3Rpb24gdG8gd3JhbmdsZSB0aGUgb3RoZXIgZGVtb2dyYXBoaWMgdGFibGVzLgoKTGFzdCB0aW1lIHdlIHdyb3RlIGEgZnVuY3Rpb24gaW4gdGhpcyBjYXNlIHN0dWR5LCB3ZSBvbmx5IGhhZCBvbmUgaW5wdXQgaW4gb3VyIGZ1bmN0aW9uLiBUaGlzIHRpbWUgd2Ugd2lsbCBoYXZlIHNldmVyYWwgaW5wdXRzLiBXZSB3aWxsIGhhdmUgdGhlIHRhYmxlIHRoYXQgd2Ugd2FudCB0byB3cmFuZ2xlIGFzIGBUQUJMRWAsIGEgbmV3IG5hbWUgZm9yIHRoZSBmaXJzdCBjb2x1bW4gY2FsbGVkIGBuZXdfY29sYCwgYW5kIGFuIGlucHV0IGNhbGxlZCBgcGl2b3RfY29sYCwgd2hpY2ggd2lsbCBiZSB0aGUgbmFtZSBvZiB0aGUgY29sdW1uIHRoYXQgd2lsbCBiZSBjcmVhdGVkIGFmdGVyIHBpdm90aW5nIHRoYXQgd2lsbCB0YWtlIHRoZSB2YWx1ZXMgZnJvbSBlYWNoIG9mIHRoZSB5ZWFycy4KCmBgYHtyLCBldmFsPUZBTFNFfQpmdW5jdGlvbihUQUJMRSwgbmV3X2NvbCwgcGl2b3RfY29sKXsKICAgIDxhZGQgY29kZSBoZXJlPiAKICB9CmBgYAoKV2Ugd2FudCB0byBtYWtlIG91ciBmdW5jdGlvbiBmbGV4aWJsZSBzbyB0aGF0IGl0IGNhbiB0YWtlIGFueSB2YWx1ZSBmb3IgdGhlIG5hbWUgb2YgdGhlIGZpcnN0IGNvbHVtbi4gVG8gc2VsZWN0IHRoZSBmaXJzdCBjb2x1bW4gd2Ugd2lsbCB1c2UgdGhpcyBmb2xsb3dpbmcgY29kZSwgd2hlcmUgdGhlIGJhc2UgYG5hbWVzKClgIGZ1bmN0aW9uIGdldHMgdGhlIGNvbHVtbiBuYW1lcyBvZiB0aGUgYFRBQkxFYCBpbnB1dCAsIHdoaWNoIGlzIGluZGljYXRlZCBieSB0aGUgYC5gIGFuZCB0aGVuIHRvIGdldCBqdXN0IHRoZSBmaXJzdCBuYW1lIHRoZSBgWzFdYCBpcyB1c2VkLgoKYGBge3IsIGV2YWwgPSBGQUxTRX0KZnVuY3Rpb24oVEFCTEUsIG5ld19jb2wsIHBpdm90X2NvbCl7CiAgZHBseXI6OmFzX3RpYmJsZShUQUJMRSkgJT4lCiAgI2FkZGl0aW9uYWwgc3RlcHMKICBuYW1lcyguKVsxXQogICNhZGRpdGlvbmFsIHN0ZXBzCn0KYGBgCgpBbmQgdG8gcmVuYW1lIHRoZSB3aXRoIHRoZSBgbmV3X2NvbGAgaW5wdXQgdG8gdGhlIGZ1bmN0aW9uIHdlIGNhbiBkbyB0aGlzOgoKYGBge3IsIGV2YWwgPSBGQUxTRX0KZnVuY3Rpb24oVEFCTEUsIG5ld19jb2wsIHBpdm90X2NvbCl7CiAgZHBseXI6OmFzX3RpYmJsZShUQUJMRSkgJT4lCiAgI2FkZGl0aW9uYWwgc3RlcHMKICByZW5hbWUoe3tuZXdfY29sfX0gOj0gbmFtZXMoLilbMV0pCiAgI2FkZGl0aW9uYWwgc3RlcHMKfQpgYGAKClRoZSBkb3VibGUgY3VybHkgYnJhY2tldHMgYHt7fX1gIGFsbG93IHVzIHRvIHVzZSB0aGUgaW5wdXQgdG8gdGhlIGZ1bmN0aW9uIGNhbGxlZCBgbmV3X2NvbGAgd2l0aGluIHRoZSBmdW5jdGlvbi4KClNlZSBbaGVyZV0oaHR0cHM6Ly9hZHYtci5oYWRsZXkubnovcXVhc2lxdW90YXRpb24uaHRtbCN0aWR5LWRvdHMpe3RhcmdldD0iX2JsYW5rIn0gZm9yIGluZm9ybWF0aW9uIGFib3V0IHRoZSBgOj1gIGNvbG9uLWVxdWFscyBvcGVyYXRvci4gClRoaXMgb3BlcmF0b3IgaXMgbW9yZSBmbGV4aWJsZSB0aGFuIHRoZSBub3JtYWwgYD1gLiBJdCBhbGxvd3MgZXhwcmVzc2lvbnMgb24gYm90aCBzaWRlcywgdGh1cyBpdCBhbGxvd3MgdXMgdG8gdXNlIGFuIGV4cHJlc3Npb24gKHRoZSB2YWx1ZXMgZm9yIGBuZXdfY29sYCkgYXMgdGhlIGlucHV0IHZhbHVlIHRvIHRoZSBleHByZXNzaW9ucyB0aGF0IGZvbGxvdyB0aGUgYDo9YCBvcGVyYXRvci4KCldlIHdpbGwgYWxzbyBhZGQgY29kZSB0byByZW1vdmUgYWxsIHJvd3MgdGhhdCBoYXZlIG9ubHkgYE5BYCB2YWx1ZXMgaW4gYSBtb3JlIGZsZXhpYmxlIHdheSwgc28gdGhhdCB3ZSBkb24ndCBuZWVkIHRvIGtub3cgd2hhdCByb3dzIGFoZWFkIG9mIHRpbWUuCgpUbyBkbyB0aGlzIHdlIHdpbGwgdXNlIHRoZSBgZmlsdGVyKClgIGFuZCBgc2VsZWN0KClgIGZ1bmN0aW9ucyBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlLiAKCldlIHdpbGwgY2FsY3VsYXRlIGEgc3VtIG9mIHRoZSBjb3VudCBvZiBgTkFgIHZhbHVlcyBhY3Jvc3MgdGhlIHJvd3MgZm9yIHRoZSBjb2x1bW5zIGZvciBlYWNoIHllYXIgdXNpbmcgdGhlIGJhc2UgYHJvd1N1bXMoKWAgZnVuY3Rpb24gbGlrZSBzbzoKCmBgYHtyLCBldmFsID0gRkFMU0V9CnJvd1N1bXMoaXMubmEoLikpCmBgYAoKSG93ZXZlciB0byBkbyB0aGlzIHdlIGZpcnN0IG5lZWQgdG8gc2VsZWN0IG9ubHkgdGhlIGNvbHVtbnMgdGhhdCBhcmUgbnVtZXJpYyB1c2luZzogYHNlbGVjdCguLCBpcy5udW1lcmljKWAsIHdoZXJlIHRoZSBgLmAgcmVmZXJzIHRvIHRoZSB0YWJsZSBhZnRlciBhbGwgdGhlIHByZXZpb3VzIHdyYW5nbGluZyBzdGVwcyBpbiBvdXIgZnVuY3Rpb24uIEltcG9ydGFudGx5IG9mIGNvdXJzZSwgdGhpcyBhbGwgbmVlZHMgdG8gaGFwcGVuIGFmdGVyIHdlIGNvbnZlcnQgdGhlIHZhbHVlcyBmb3IgZWFjaCB5ZWFyIHRvIG51bWVyaWMuCgpBbnl3YXksIGFsdG9nZXRoZXIgdGhpcyBsb29rcyBsaWtlIHRoaXM6IAoKYGBge3IsIGV2YWwgPSBGQUxTRX0Kcm93U3Vtcyhpcy5uYShzZWxlY3QoLiwgaXMubnVtZXJpYykpKWAuCmBgYAoKRmluYWxseSwgd2UgY29tcGFyZSB0aGlzIHRvIHRoZSBudW1iZXIgb2YgY29sdW1ucyB0aGF0IGFyZSBudW1lcmljIGJ5IHVzaW5nOiBgbGVuZ3RoKHNlbGVjdCguLCBpcy5udW1lcmljKSkpYCwgd2l0aCB0aGUgaWRlYSB0aGF0IGlmIHRoZSBudW1iZXIgb2YgYE5BYCB2YWx1ZXMgaXMgbGVzcyB0aGFuIHRoZSBudW1iZXIgb2YgY29sdW1ucyB0aGF0IGNvdWxkIGhhdmUgYE5BYCB2YWx1ZXMsIHRoZW4gd2Uga25vdyBpdCBpcyBub3QgYW4gZW1wdHkgcm93LgoKT3ZlcmFsbCwgdGhpcyB3b3VsZCBsb29rIHNvbWV0aGluZyBsaWtlIHRoaXMgYWZ0ZXIgd2UgcGVyZm9ybSBhIHN0ZXAgdG8gY29udmVydCB0aGUgY29sdW1ucyB0byBiZSBudW1lcmljIGxpa2Ugd2UgZGlkIGJlZm9yZToKCmBgYHtyLCBldmFsID0gRkFMU0V9CmZ1bmN0aW9uKFRBQkxFLCBuZXdfY29sLCBwaXZvdF9jb2wpewogICMgcHJldmlvdXMgc2ltaWxhciBzdGVwcyB0byBtb2RpZnkgYW5kIG1ha2UgdGFibGUgdmFsdWVzIG51bWVyaWMKICAgIGZpbHRlcihyb3dTdW1zKGlzLm5hKHNlbGVjdCguLCBpcy5udW1lcmljKSkpIDwgCiAgICAgICAgICAgICBsZW5ndGgoc2VsZWN0KC4sIGlzLm51bWVyaWMpKSkgCiAgfQogIApgYGAKCk5vdGUgdGhhdCBpZiB3ZSB3ZXJlIHVzaW5nIHRoZSBgc3VtbWFyaXNlKClgIG9yIGBtdXRhdGUoKWAgZnVuY3Rpb24gb3IgdGhlIGBkcGx5cmAgcGFja2FnZSwgdGhlbiB3ZSBjb3VsZCB1c2UgdGhlIGBhY3Jvc3MoKWAgZnVuY3Rpb24gb2YgdGhlIGBkcGx5cmAgcGFja2FnZSB0byBzZWxlY3Qgd2hhdCBjb2x1bW5zIHdlIHdhbnRlZCB0byB1c2UgaW4gb3VyIGNhbGN1bGF0aW9uLgoKCk9LLCBzbyBwdXR0aW5nIGV2ZXJ5dGhpbmcgdG9nZXRoZXIgZnJvbSB3aGF0IHdlIGRpZCBwcmV2aW91c2x5IGZvciBgdGFibGUxMS4xYWAgYW5kIHRoZXNlIG5ldyBmbGV4aWJsZSBzdGVwcyB3ZSBjYW4gY3JlYXRlIHRoaXMgZnVuY3Rpb246CgpgYGB7cn0KZGF0YV9wcmVwX3NldHRpbmdzIDwtIGZ1bmN0aW9uKFRBQkxFLCBuZXdfY29sLCBwaXZvdF9jb2wpewogIGRwbHlyOjphc190aWJibGUoVEFCTEUpICU+JQogIHNsaWNlKDE6KG4oKS0xKSkgJT4lCiAgbmFfaWYoIm5jIikgJT4lCiAgbmFfaWYoIi0tIikgJT4lCiAgbmFfaWYoIiIpICU+JQogIG5hX2lmKCIqIikgJT4lCiAgcmVuYW1lKHt7bmV3X2NvbH19IDo9IG5hbWVzKC4pWzFdKSAlPiUKICBtdXRhdGUoe3tuZXdfY29sfX0gOj0gCiAgICAgICAgIHN0cl9yZW1vdmVfYWxsKHN0cmluZyA9IHB1bGwoLiwge3tuZXdfY29sfX0pLCAKICAgICAgICAgICAgICAgICAgICAgICAgcGF0dGVybiA9ICJbOmRpZ2l0Ol18XHJcbnxbOnB1bmN0Ol18IikpICU+JQogIG11dGF0ZSh7e25ld19jb2x9fSA6PSAKICAgICAgICAgc3RyX3JlcGxhY2VfYWxsKHN0cmluZyA9cHVsbCguLCB7e25ld19jb2x9fSksCiAgICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuID0gIls6Ymxhbms6XXsxLH0iLCAKICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VtZW50ID0gIiAiKSkgJT4lCiAgbXV0YXRlKGRwbHlyOjphY3Jvc3MoLmNvbHMgPSAte3tuZXdfY29sfX0sCiAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5ncjo6c3RyX3JlbW92ZV9hbGwsICJhfCwiKSkgJT4lCiAgbXV0YXRlKGFjcm9zcygte3tuZXdfY29sfX0sIGFzLm51bWVyaWMpKSAlPiUKICBtdXRhdGUodHlwZSA9IGMocmVwKCJTcGVjaWFsdHkiLCA5KSwgcmVwKCJOb25zcGVjaWFsdHkiLCAxMSkpKSAlPiUKICBtdXRhdGUoc3VidHlwZSA9IGMoIlNwZWNpYWx0eV90b3RhbCIsCiAgICAgICAgICAgICAgICAgICAgcmVwKCJPdXRwYXRpZW50IiwgNSksCiAgICAgICAgICAgICAgICAgICAgcmVwKCJJbnBhdGllbnQiLCAzKSwgCiAgICAgICAgICAgICAgICAgICAgIk5vbnNwZWNpYWx0eV90b3RhbCIsIAogICAgICAgICAgICAgICAgICAgIHJlcCgiRWR1Y2F0aW9uIiwgMyksIAogICAgICAgICAgICAgICAgICAgIHJlcCgiR2VuZXJhbF9tZWRpY2luZSIsIDIpLAogICAgICAgICAgICAgICAgICAgIHJlcCgiSnV2ZW5pbGVfSnVzdGljZSIsIDIpLCAKICAgICAgICAgICAgICAgICAgICByZXAoIkNoaWxkX1dlbGZhcmUiLDIpLAogICAgICAgICAgICAgICAgICAgICJjb21iaW5hdGlvbiIpKSAlPiUKICBtdXRhdGUoc2hvcnRfbGFiZWwgPSBjKCJTcGVjaWFsdHkgdG90YWwiLCAiT3V0cGF0aWVudCB0b3RhbCIsICAKICAgICAgICAgICAgICAgICAgICAgICAgICJUaGVyYXBpc3QiLCAiQ2xpbmljIiwgIkRheSBwcm9ncmFtIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAiSW4taG9tZSBUaGVyYXBpc3QiLCAiSW5wYXRpZW50IHRvdGFsIiwKICAgICAgICAgICAgICAgICAgICAgICAgICJIb3NwaXRhbCIsICJSZXNpZGVudGlhbCBDZW50ZXIiLAogICAgICAgICAgICAgICAgICAgICAgICAgIk5vbnNwZWNpYWx0eSB0b3RhbCIsICJTY2hvb2wgdG90YWwiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICJTY2hvb2wgVGhlcmFwaXN0IiwgIlNjaG9vbCBQcm9ncmFtIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAiR2VuZXJhbCBNZWRpY2luZSIsICJGYW1pbHkgRHIiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICJKdXN0aWNlIFN5c3RlbSIsICJKdXN0aWNlIFN5c3RlbSIsIAogICAgICAgICAgICAgICAgICAgICAgICAgIldlbGZhcmUiLCAiRm9zdGVyY2FyZSIsIAogICAgICAgICAgICAgICAgICAgICAgICAgIlNwZWNpYWx0eSBDb21iaW5hdGlvbiIpKSAlPiUKICBmaWx0ZXIocm93U3Vtcyhpcy5uYShzZWxlY3QoLiwgaXMubnVtZXJpYykpKSA8IAogICAgICAgICAgIGxlbmd0aChzZWxlY3QoLiwgaXMubnVtZXJpYykpKSAlPiUKICBwaXZvdF9sb25nZXIoY29scyA9IGNvbnRhaW5zKCIyMCIpLCAKICAgICAgICAgICBuYW1lc190byA9ICJZZWFyIiwgCiAgICAgICAgICB2YWx1ZXNfdG8gPSBwaXZvdF9jb2wpJT4lCiAgbXV0YXRlKFllYXIgPSBhcy5udW1lcmljKFllYXIpKQp9CmBgYAoKTm93IHdlIGNhbiBhcHBseSB0aGUgZnVuY3Rpb24gdG8gYHRhYmxlMTEuMWJgLgoKIyMjICoqVGFibGUxMS4xYioqCgpgYGB7cn0KdGFibGUxMS4xYiA8LSAKICBkYXRhX3ByZXBfc2V0dGluZ3MoVEFCTEUgPSB0YWJsZTExLjFiLCAKICAgICAgICAgICAgICAgICAgICAgbmV3X2NvbCA9ICJNSFNfc2V0dGluZyIsCiAgICAgICAgICAgICAgICAgICAgIHBpdm90X2NvbCA9ICJQZXJjZW50IikKCmhlYWQodGFibGUxMS4xYikKYGBgCgpHcmVhdCEKCldoYXQgYWJvdXQgdGhlIHN1YnNlcXVlbnQgdGFibGVzPwoKCiMjIyAqKkRlbW9ncmFwaGljIFRhYmxlcyoqCgpBbGwgb2YgdGhlIHJlc3Qgb2YgdGhlIHRhYmxlcyBoYXZlIGRlbW9ncmFwaGljIGluZm9ybWF0aW9uIGFuZCBoYXZlIHRoaXMgZ2VuZXJhbCBzdHJ1Y3R1cmU6CgpgYGB7ciwgZWNobz1GQUxTRX0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgImRlbV90YWJsZS5wbmciKSkKYGBgCgpJbiB0aGVzZSB0YWJsZXMsIHdlIGhhdmUgYWdlIGdyb3VwcyBpbiBvdXIgZmlyc3QgY29sdW1uIHNvIHdlIGRvbid0IHdhbnQgdG8gcmVtb3ZlIGRpZ2l0cyBvciBwdW5jdHVhdGlvbiBtYXJrcyBhbnltb3JlIHNvIHdlIG5lZWQgdG8gbW9kaWZ5IG91ciBmdW5jdGlvbiBhIGJpdCB0byByZW1vdmUgdGhhdCBzdGVwLiAKCldlIGFsc28gd2FudCB0byBhZGQgdGhlIHdvcmQgYEFnZWAgYW5kIGFuIHVuZGVyc2NvcmUgaW4gZnJvbnQgb2YgdGhlIGFnZSBncm91cCBsaXN0ZWQgaW4gdGhlIHRhYmxlcy4KV2UgY2FuIHVzZSB0aGUgYHN0cl9yZXBsYWNlKClgIGZ1bmN0aW9uIG9mIHRoZSBgc3RyaW5ncmAgcGFja2FnZSwgYmVjYXVzZSBub3cgd2Ugd2FudCB0byBvbmx5IHJlcGxhY2UgdGhlIGZpcnN0IGluc3RhbmNlIG9mIGAxYCB3aXRoIGBBZ2VfMWAuCgpXZSB3aWxsIHJlcGxhY2UgdGhlIGZpcnN0IGNvbHVtbiBuYW1lIHdpdGggYERlbW9ncmFwaGljYCBmb3IgYWxsIG9mIHRoZSB0YWJsZXMuCgpXZSB3aWxsIGNyZWF0ZSBhIG5ldyB2YXJpYWJsZSB0aGF0IGxpc3QgdGhlIHN1Ymdyb3Vwcy4KCldlIHdpbGwgYWxzbyB3YW50IHRvIG9ubHkgd3JhbmdsZSB0aGUgZGF0YSB1cCB0byB0aGUgcG9pbnQgdGhhdCB3ZSBjaGFuZ2UgdGhlIHNoYXBlIG9mIHRoZSBkYXRhLCBzbyB0aGF0IHdlIGNhbiBjaGVjayBob3cgdGhlIGRhdGEgbG9va3MgZmlyc3QuCgpPSyBsZXQncyBwdXQgdGhpcyBhbGwgdG9nZXRoZXIgaW50byBhIGBkYXRhX2RlbV9zZXR0aW5ncygpYCBmdW5jdGlvbjogCgpgYGB7cn0KZGF0YV9kZW1fc2V0dGluZ3MgPC0gZnVuY3Rpb24oVEFCTEUpewogIGRwbHlyOjphc190aWJibGUoVEFCTEUpICU+JQogIHNsaWNlKDE6KG4oKS0xKSkgJT4lCiAgbmFfaWYoIm5jIikgJT4lCiAgbmFfaWYoIi0tIikgJT4lCiAgbmFfaWYoIiIpICU+JQogIG5hX2lmKCIqIikgJT4lCiAgcmVuYW1lKERlbW9ncmFwaGljIDo9IG5hbWVzKC4pWzFdKSAlPiUKICBtdXRhdGUoRGVtb2dyYXBoaWMgOj0gc3RyX3JlcGxhY2VfYWxsKHN0cmluZyA9IHB1bGwoLiwgRGVtb2dyYXBoaWMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0dGVybiA9ICJbOmJsYW5rOl17MSx9IiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlbWVudCA9ICIgIikpICU+JQogIG11dGF0ZShEZW1vZ3JhcGhpYyA9IHN0cl9yZXBsYWNlKHN0cmluZyA9IERlbW9ncmFwaGljLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuID0gIjEiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlbWVudCA9ICJBZ2VfMSIpKSAlPiUKICBtdXRhdGUoc3ViZ3JvdXAgPSBjKCJUb3RhbCIsIHJlcCgiQWdlIiwgNCksIAogICAgICAgICAgICAgICAgICAgIHJlcCgiU2V4IiwgMyksIHJlcCgiUmFjZS9FdGhuaWNpdHkiLCA5KSkpICU+JQogIG11dGF0ZShkcGx5cjo6YWNyb3NzKC5jb2xzID0gY29udGFpbnMoIjIwIiksCiAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5ncjo6c3RyX3JlbW92ZV9hbGwsICJhfCwiKSkgJT4lCiAgbXV0YXRlKGFjcm9zcyhjb250YWlucygiMjAiKSwgYXMubnVtZXJpYykpICU+JQogIGZpbHRlcihyb3dTdW1zKGlzLm5hKHNlbGVjdCguLCBpcy5udW1lcmljKSkpIDwgbGVuZ3RoKHNlbGVjdCguLCBpcy5udW1lcmljKSkpCiAgfQpgYGAKCgpOb3csIHdlIHVzZSB0aGUgYGRhdGFfZGVtX3NldHRpbmdzKClgIGZ1bmN0aW9uIHRvIHdyYW5nbGUgdGhlIG5leHQgc2V0IG9mIHRhYmxlcy4gCldlIHdpbGwgYWxzbyBhZGQgYSBjb2x1bW4gdG8gZGVzY3JpYmUgd2hhdCB0aGUgZGF0YSBhcmUgYWJvdXQgd2hpY2ggd2lsbCBiZSBoZWxwZnVsIGZvciBtZXJnaW5nIHRoZSBkYXRhIGxhdGVyLgoKYGBge3J9CnRhYmxlMTEuMmEgPC0gZGF0YV9kZW1fc2V0dGluZ3MoVEFCTEUgPSB0YWJsZTExLjJhKQp0YWJsZTExLjJhICU8PiUgbXV0YXRlKGRhdGFfdHlwZSA9ICJNYWpvcl9EZXByZXNzaXZlX0VwaXNvZGUiKQpoZWFkKHRhYmxlMTEuMmEpCgp0YWJsZTExLjJiIDwtIGRhdGFfZGVtX3NldHRpbmdzKFRBQkxFID0gdGFibGUxMS4yYikKdGFibGUxMS4yYiAlPD4lIG11dGF0ZShkYXRhX3R5cGUgPSAiTWFqb3JfRGVwcmVzc2l2ZV9FcGlzb2RlIikKaGVhZCh0YWJsZTExLjJiKQoKdGFibGUxMS4zYSA8LSBkYXRhX2RlbV9zZXR0aW5ncyhUQUJMRSA9IHRhYmxlMTEuM2EpCnRhYmxlMTEuM2EgJTw+JSBtdXRhdGUoZGF0YV90eXBlID0gIlNldmVyZV9NYWpvcl9EZXByZXNzaXZlX0VwaXNvZGUiKQpoZWFkKHRhYmxlMTEuM2EpCgp0YWJsZTExLjNiIDwtIGRhdGFfZGVtX3NldHRpbmdzKFRBQkxFID0gdGFibGUxMS4zYikKdGFibGUxMS4zYiAlPD4lIG11dGF0ZShkYXRhX3R5cGUgPSAiU2V2ZXJlX01ham9yX0RlcHJlc3NpdmVfRXBpc29kZSIpCmhlYWQodGFibGUxMS4zYikKCnRhYmxlMTEuNGEgPC0gZGF0YV9kZW1fc2V0dGluZ3MoVEFCTEUgPSB0YWJsZTExLjRhKQp0YWJsZTExLjRhICU8PiUgbXV0YXRlKGRhdGFfdHlwZSA9ICJ0cmVhdG1lbnQiKQpoZWFkKHRhYmxlMTEuNGEpCgp0YWJsZTExLjRiIDwtIGRhdGFfZGVtX3NldHRpbmdzKFRBQkxFID0gdGFibGUxMS40YikKdGFibGUxMS40YiAlPD4lIG11dGF0ZShkYXRhX3R5cGUgPSAidHJlYXRtZW50IikKaGVhZCh0YWJsZTExLjRiKQpgYGAKCkdyZWF0ISBBbGwgb2YgdGhlIGRlbW9ncmFwaGljIHRhYmxlcyBsb29rIGdvb2QuCgpOZXh0LCBsZXQncyBjb21iaW5lIHRoZSBjb3VudCBkYXRhICh0aGUgImEiIHRhYmxlcykgYW5kIHRoZSBwZXJjZW50IGRhdGEgKHRoZSAiYiIgdGFibGVzKSB1c2luZyB0aGUgYGJpbmRfcm93cygpYCBmdW5jdGlvbiBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlLCB3aGljaCB3aWxsIGFwcGVuZCBlYWNoIG9mIHRoZSBzdWJzZXF1ZW50IHRhYmxlcyB0b2dldGhlci4KCldlIGNhbiB1c2UgdGhlIGBkaXN0aW5jdCgpYCBmdW5jdGlvbiBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlIHRvIGNoZWNrIHRoYXQgd2UgaW5kZWVkIGhhdmUgYWxsIHRoZSBkYXRhIHR5cGVzIG5vdyBpbiB0aGVzZSBsYXJnZXIgdGliYmxlcy4KCmBgYHtyfQpjb3VudHMgPC0gYmluZF9yb3dzKHRhYmxlMTEuMmEsIHRhYmxlMTEuM2EsIHRhYmxlMTEuNGEpCnBlcmNlbnRzIDwtIGJpbmRfcm93cyh0YWJsZTExLjJiLCB0YWJsZTExLjNiLCB0YWJsZTExLjRiKQoKY291bnRzICU+JSBkaXN0aW5jdChkYXRhX3R5cGUpCnBlcmNlbnRzICU+JSBkaXN0aW5jdChkYXRhX3R5cGUpCmBgYApHcmVhdCEKCk5vdyB3ZSB3aWxsIHJlZm9ybWF0IGJvdGggdGhlIGBjb3VudHNgIGFuZCBgcGVyY2VudHNgIGRhdGEgdG8gYmUgaW4gdGhlIGxvbmcgZm9ybWF0IHVzaW5nIGBwaXZvdF9sb25nZXIoKWAgb25jZSBhZ2Fpbi4KCmBgYHtyfQpjb3VudHMgJTw+JQogIHBpdm90X2xvbmdlcihjb2xzID0gY29udGFpbnMoIjIwIiksIAogICAgICAgICAgICAgICBuYW1lc190byA9ICJZZWFyIiwgCiAgICAgICAgICAgICAgIHZhbHVlc190byA9ICJOdW1iZXIiKSAlPiUKICBtdXRhdGUoWWVhciA9IGFzLm51bWVyaWMoWWVhcikpCgpwZXJjZW50cyAlPD4lCiAgcGl2b3RfbG9uZ2VyKGNvbHMgPSBjb250YWlucygiMjAiKSwgCiAgICAgICAgICAgICAgIG5hbWVzX3RvID0gIlllYXIiLCAKICAgICAgICAgICAgICAgdmFsdWVzX3RvID0gIlBlcmNlbnQiKSAlPiUKICBtdXRhdGUoWWVhciA9IGFzLm51bWVyaWMoWWVhcikpCmBgYAoKV2UgZmluaXNoZWQgd3JhbmdsaW5nIHRoZSBkYXRhIGFuZCB3ZSBhcmUgcmVhZHkgdG8gcHJvY2VlZCB3aXRoIG91ciBhbmFseXNpcy4gCgpgYGB7ciwgZXZhbCA9IEZBTFNFLCBlY2hvID0gRkFMU0V9CnNhdmUocGVyY2VudHMsIGNvdW50cywgdGFibGUxMS4xYSwgdGFibGUxMS4xYiwgCiAgICAgZmlsZSA9IGhlcmU6OmhlcmUoImRhdGEiLCAid3JhbmdsZWRfZGF0YS5yZGEiKSkKYGBgCgoKIyMgKipEYXRhIFZpc3VhbGl6YXRpb24qKgoqKiogCgpgYGB7ciwgZWNobyA9IEZBTFNFfQpsb2FkKGZpbGUgPSBoZXJlOjpoZXJlKCJkYXRhIiwgIndyYW5nbGVkX2RhdGEucmRhIikpCmBgYAoKSW4gdGhpcyBzZWN0aW9uLCB3ZSB3aWxsIGNyZWF0ZSBzb21lIGRhdGEgdmlzdWFsaXphdGlvbnMgdG8gZXhwbG9yZSBvdXIgZGF0YSBhbmQgcXVlc3Rpb25zIG9mIGludGVyZXN0OiAKCiMjIyMgey5tYWluX3F1ZXN0aW9uX2Jsb2NrfQo8Yj48dT4gT3VyIG1haW4gcXVlc3Rpb25zOiA8L3U+PC9iPgoKMS4gSG93IGhhdmUgZGVwcmVzc2lvbiByYXRlcyBpbiBBbWVyaWNhbiB5b3V0aCBjaGFuZ2VkIHNpbmNlIDIwMDQsIGFjY29yZGluZyB0byB0aGUgTlNEVUggZGF0YT8gIEhvdyBoYXZlIHJhdGVzIGRpZmZlcmVkIGJldHdlZW4gZGlmZmVyZW50IHlvdXRoIHN1Ymdyb3VwcyAoYWdlLCBnZW5kZXIsIGV0aG5pY2l0eSk/CjIuIERvIG1lbnRhbCBoZWFsdGggc2VydmljZXMgYXBwZWFyIHRvIGJlIHJlYWNoaW5nIG1vcmUgeW91dGhzPyBBZ2FpbiwgaG93IGhhdmUgcmF0ZXMgZGlmZmVyZWQgYmV0d2VlbiBkaWZmZXJlbnQgeW91dGggc3ViZ3JvdXBzIChhZ2UsIGdlbmRlciwgZXRobmljaXR5KT8KCiMjIyMKCldlIGFyZSBnb2luZyB0byB1c2UgdGhlIGBnZ3Bsb3QyYCBwYWNrYWdlIHRvIGNyZWF0ZSBvdXIgcGxvdHMuCgoqKioKPGRldGFpbHM+PHN1bW1hcnk+IENsaWNrIGhlcmUgZm9yIGFuIGludHJvZHVjdGlvbiBhYm91dCB0aGlzIHBhY2thZ2UgaWYgeW91IGFyZSAgbmV3IHRvIHVzaW5nIGBnZ3Bsb3QyYCA8L3N1bW1hcnk+CgpUaGUgW2dncGxvdDIgcGFja2FnZV0oaHR0cDovL2dncGxvdDIudGlkeXZlcnNlLm9yZykgaXMgZ2VuZXJhbGx5IGludHVpdGl2ZSBmb3IgYmVnaW5uZXJzIGJlY2F1c2UgaXQgaXMgYmFzZWQgb24gYSAgW2dyYW1tYXIgb2YgZ3JhcGhpY3NdKGh0dHA6Ly92aXRhLmhhZC5jby5uei9wYXBlcnMvbGF5ZXJlZC1ncmFtbWFyLmh0bWwpIG9yIHRoZSBgZ2dgIGluIGBnZ3Bsb3QyYC4gClRoZSBpZGVhIGlzIHRoYXQgeW91IGNhbiBjb25zdHJ1Y3QgbWFueSBzZW50ZW5jZXMgYnkgbGVhcm5pbmcganVzdCBhIGZldyBub3VucywgYWRqZWN0aXZlcywgYW5kIHZlcmJzLiBUaGVyZSBhcmUgc3BlY2lmaWMg4oCcd29yZHPigJ0gdGhhdCB3ZSB3aWxsIG5lZWQgdG8gbGVhcm4gYW5kIG9uY2Ugd2UgZG8sIHlvdSB3aWxsIGJlIGFibGUgdG8gY3JlYXRlIChvciDigJx3cml0ZeKAnSkgaHVuZHJlZHMgb2YgZGlmZmVyZW50IHBsb3RzLgoKVGhlIGNyaXRpY2FsIHBhcnQgdG8gbWFraW5nIGdyYXBoaWNzIHVzaW5nIGBnZ3Bsb3QyYCBpcyB0aGUgZGF0YSBuZWVkcyB0byBiZSBpbiBhIF90aWR5XyBmb3JtYXQuIApHaXZlbiB0aGF0IHdlIGhhdmUganVzdCBzcGVudCB0aW1lIHB1dHRpbmcgb3VyIGRhdGEgaW4gX3RpZHlfIGZvcm1hdCwgd2UgYXJlIHByaW1lZCB0byB0YWtlIGFkdmFudGFnZSBvZiBhbGwgdGhhdCBgZ2dwbG90MmAgaGFzIHRvIG9mZmVyISAKCldlIHdpbGwgc2hvdyBob3cgaXQgaXMgZWFzeSB0byBwaXBlIF90aWR5XyBkYXRhIChvdXRwdXQpIGFzIGlucHV0IHRvIG90aGVyIGZ1bmN0aW9ucyB0aGF0IGNyZWF0ZSBwbG90cy4gClRoaXMgYWxsIHdvcmtzIGJlY2F1c2Ugd2UgYXJlIHdvcmtpbmcgCndpdGhpbiB0aGUgX3RpZHl2ZXJzZV8uIAoKKipXaGF0IGlzIHRoZSBgZ2dwbG90KClgIGZ1bmN0aW9uPyoqIApBcyBleHBsYWluZWQgYnkgSGFkbGV5IFdpY2toYW06Cgo+IFRoZSBncmFtbWFyIHRlbGxzIHVzIHRoYXQgYSBzdGF0aXN0aWNhbCBncmFwaGljIGlzIGEgbWFwcGluZyBmcm9tIGRhdGEgdG8gYWVzdGhldGljIGF0dHJpYnV0ZXMgKGNvbG91ciwgc2hhcGUsIHNpemUpIG9mIGdlb21ldHJpYyBvYmplY3RzIChwb2ludHMsIGxpbmVzLCBiYXJzKS4gVGhlIHBsb3QgbWF5IGFsc28gY29udGFpbiBzdGF0aXN0aWNhbCB0cmFuc2Zvcm1hdGlvbnMgb2YgdGhlIGRhdGEgYW5kIGlzIGRyYXduIG9uIGEgc3BlY2lmaWMgY29vcmRpbmF0ZXMgc3lzdGVtLgoKYGdncGxvdDJgIFRlcm1pbm9sb2d5OiAKCi0gKipnZ3Bsb3QqKiAtIHRoZSBtYWluIGZ1bmN0aW9uIHdoZXJlIHlvdSBzcGVjaWZ5IHRoZSBkYXRhc2V0IGFuZCB2YXJpYWJsZXMgdG8gcGxvdCAodGhpcyBpcyB3aGVyZSB3ZSBkZWZpbmUgdGhlIGB4YCBhbmQKYHlgIHZhcmlhYmxlIG5hbWVzKQotICoqZ2VvbXMqKiAtIGdlb21ldHJpYyBvYmplY3RzCiAgICAtIGUuZy4gYGdlb21fcG9pbnQoKWAsIGBnZW9tX2JhcigpYCwgYGdlb21fbGluZSgpYCwgYGdlb21faGlzdG9ncmFtKClgCi0gKiphZXMqKiAtIGFlc3RoZXRpY3MKICAgIC0gc2hhcGUsIHRyYW5zcGFyZW5jeSwgY29sb3IsIGZpbGwsIGxpbmUgdHlwZXMKLSAqKnNjYWxlcyoqIC0gZGVmaW5lIGhvdyB5b3VyIGRhdGEgd2lsbCBiZSBwbG90dGVkCiAgICAtIGNvbnRpbnVvdXMsIGRpc2NyZXRlLCBsb2csIGV0YwoKVGhlIGZ1bmN0aW9uIGBhZXMoKWAgaXMgYW4gYWVzdGhldGljIG1hcHBpbmcgZnVuY3Rpb24gaW5zaWRlIHRoZSBgZ2dwbG90KClgIG9iamVjdC4gCldlIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIHNwZWNpZnkgcGxvdCBhdHRyaWJ1dGVzIChlLmcuIGB4YCBhbmQgYHlgIHZhcmlhYmxlIG5hbWVzKSB0aGF0IHdpbGwgbm90IGNoYW5nZSBhcyB3ZSBhZGQgbW9yZSBsYXllcnMuICAKCkFueXRoaW5nIHRoYXQgZ29lcyBpbiB0aGUgYGdncGxvdCgpYCBvYmplY3QgYmVjb21lcyBhIGdsb2JhbCBzZXR0aW5nLiAKRnJvbSB0aGVyZSwgd2UgdXNlIHRoZSBgZ2VvbWAgb2JqZWN0cyB0byBhZGQgbW9yZSBsYXllcnMgdG8gdGhlIGJhc2UgYGdncGxvdCgpYCBvYmplY3QuIApUaGVzZSB3aWxsIGRlZmluZSB3aGF0IHdlIGFyZSBpbnRlcmVzdGVkIGluIGlsbHVzdHJhdGluZyB1c2luZyB0aGUgZGF0YS4KCjwvZGV0YWlscz4KCioqKgoKIyMjIE1ERSBhY3Jvc3MgdGltZQoKV2Ugd2lsbCBzdGFydCBieSB0YWtpbmcgYSBsb29rIGF0IHRoZSByYXRlIG9mIG1ham9yIGRlcHJlc3NpdmUgZXBpc29kZXMgKE1ERSkgYW1vbmcgeW91dGhzIGFjcm9zcyB0aW1lIGluIHZhcmlvdXMgZGVtb2dyYXBoaWMgZ3JvdXBzLgpGb3IgdGhpcyB3ZSB3aWxsIHVzZSB0aGUgYHBlcmNlbnRzYCBkYXRhc2V0IHRoYXQgd2Ugd3JhbmdsZWQgaW4gdGhlIHNlY3Rpb24gYWJvdmUuCgpPSywgd2Ugd2lsbCBzdGFydCBvdXQgYnkgdXNpbmcgdGhlIGBnZ3Bsb3QoKWAgZnVuY3Rpb24gdG8gc3BlY2lmeSB3aGF0IGRhdGEgd2Ugd291bGQgbGlrZSB0byBwbG90IG9uIGVhY2ggYXhpcy4gCldlIHdpbGwgYWxzbyBpbmRpY2F0ZSB0aGF0IHdvdWxkIGxpa2UgdG8gdXNlIHRoZSBgRGVtb2dyYXBoaWNgIHZhcmlhYmxlIGluIG91ciBkYXRhc2V0IHRvIGdyb3VwIG91ciBkYXRhIGFuZCB0byBjb2xvciBvdXIgZGF0YS4KVGhpcyBpcyBvdXIgZmlyc3QgbGF5ZXIgb2YgdGhlIHBsb3QsIHRodXMgZm9yIHN1YnNlcXVlbnQgbGF5ZXJzIHdlIG5lZWQgdG8gdXNlIGEgcGx1cyBzaWduIGArYC4gCgpOZXh0LCB3ZSB3aWxsIHVzZSB0aGUgYGdlb21fbGluZSgpYCBmdW5jdGlvbiBvZiB0aGUgYGdncGxvdDJgIHBhY2thZ2UgdG8gc3BlY2lmeSB0aGF0IHdlIHdvdWxkIGxpa2UgdG8gY3JlYXRlIGEgbGluZSBwbG90LiAKClRoZW4sIHdlIHdpbGwgYWRkIGxhYmVscyBmb3IgdGhlIHRpdGxlIGFuZCBzdWJ0aXRsZSB1c2luZyB0aGUgYGxhYnMoKWAgZnVuY3Rpb24gb2YgdGhlIGBnZ3Bsb3QyYCBwYWNrYWdlLiAKCkZpbmFsbHksIHdlIHdpbGwgbW92ZSBvdXIgbGVnZW5kIHRvIHRoZSBib3R0b20gb2YgdGhlIHBsb3QgdXNpbmcgdGhlIGB0aGVtZSgpYCBmdW5jdGlvbiB3aGljaCBoZWxwcyB1cyBjb250cm9sIHZhcmlvdXMgZGV0YWlscyBhYm91dCBvdXIgcGxvdC4gCgpgYGB7cn0KcGVyY2VudHMgJT4lCiAgZmlsdGVyKGRhdGFfdHlwZSA9PSAiTWFqb3JfRGVwcmVzc2l2ZV9FcGlzb2RlIikgJT4lCiAgZ2dwbG90Mjo6Z2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IFBlcmNlbnQsIAogICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSBEZW1vZ3JhcGhpYykpICsKICAgICAgZ2VvbV9saW5lKHNpemUgPSAxKSArCiAgICAgIGxhYnModGl0bGUgPSAiTWFqb3IgRGVwcmVzc2l2ZSBFcGlzb2RlIGFtb25nIFBlcnNvbnMgQWdlZCAxMiB0byAxNyIsCiAgICAgICAgICAgc3VidGl0bGUgPSAiQnkgRGVtb2dyYXBoaWMgQ2hhcmFjdGVyaXN0aWNzLCBQZXJjZW50YWdlcywgMjAwNC0yMDE4IikgKwogIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJib3R0b20iKQpgYGAKClRoaXMgcGxvdCBpcyB2ZXJ5IGRpZmZpY3VsdCB0byByZWFkIGJlY2F1c2UgdGhlcmUgYXJlIHNvIG1hbnkgZ3JvdXBzLiAKTm93IGxldCdzIGxvb2sgYXQganVzdCB0aGUgdG90YWwgYWNyb3NzIHRpbWUuIApXZSBjYW4gZG8gc28gYnkgZmlyc3QgZmlsdGVyaW5nIG91ciBkYXRhIGZvciBgVE9UQUxgIHZhbHVlcy4gCgpJdCB3b3VsZCBhbHNvIEJFIG5pY2UgdG8gaW5jbHVkZSBldmVyeSB5ZWFyIGluIHRoZSB4LWF4aXMuIApXZSBjYW4gZG8gc28gYnkgdXNpbmcgdGhlIGBzY2FsZV94X2NvbnRpbnVvdXMoKWAgZnVuY3Rpb24gd2hpY2ggZ2l2ZXMgdXMgZ3JlYXRlciBjb250cm9sIGFib3V0IGhvdyB0aGUgeC1heGlzIGlzIGRpc3BsYXllZC4KCkZpbmFsbHksIHdlIHdpbGwgZHJvcCB0aGUgbGVnZW5kIHNpbmNlIHdlIHdpbGwgb25seSBoYXZlIG9uZSBncm91cCB1c2luZyBgbGVnZW5kLnBvc2l0aW9uID0gIm5vbmUiYCBhbmQgd2UgY2FuIGNoYW5nZSB0aGUgYW5nbGUgb2YgdGhlIHgtYXhpcyB0ZXh0IHVzaW5nIGBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDkwKWAgd2l0aGluIHRoZSBgdGhlbWUoKWAgZnVuY3Rpb24uCgpXZSB3aWxsIGFsc28gbWFrZSB0aGUgbGluZSB0aGlja2VyIHVzaW5nIHRoZSBgc2l6ZSA9YCBhcmd1bWVudCBmb3IgdGhlIGBnZW9tX2xpbmUoKWAgZnVuY3Rpb24uCgpUaGUgYHRoZW1lX2xpbmVkcmF3KClgIGZ1bmN0aW9uIGNoYW5nZXMgdGhlIGFlc3RoZXRpY3Mgb2YgdGhlIHBsb3QuIFNlZSBbaGVyZV0oaHR0cHM6Ly9nZ3Bsb3QyLnRpZHl2ZXJzZS5vcmcvcmVmZXJlbmNlL2dndGhlbWUuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSBmb3IgYSBsaXN0IG9mIG9wdGlvbnMuCgpgYGB7cn0KTURFX3RvdGFsIDwtCiAgcGVyY2VudHMgJT4lCiAgZmlsdGVyKGRhdGFfdHlwZSA9PSAiTWFqb3JfRGVwcmVzc2l2ZV9FcGlzb2RlIiwgCiAgICAgICAgIERlbW9ncmFwaGljID09ICJUT1RBTCIpICU+JQogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBQZXJjZW50LCBjb2xvciA9IERlbW9ncmFwaGljKSkgKwogIGdlb21fbGluZShhZXMoY29sb3IgPSBEZW1vZ3JhcGhpYyksIHNpemUgPSAxLjUpICsKICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDIwMDQsIDIwMTgsIGJ5PTEpLAogICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBzZXEoMjAwNCwgMjAxOCwgYnk9MSksCiAgICAgICAgICAgICAgICAgICAgIGxpbWl0cyA9IGMoMjAwNCwgMjAxOCkpICsKICBsYWJzKHRpdGxlID0gIlBlcmNlbnQgb2YgUGVyc29ucyBBZ2VkIDEyIHRvIDE3IFJlcG9ydGluZyBIYXZpbmcgYSBcbiBNYWpvciBEZXByZXNzaXZlIEVwaXNvZGUgaW4gdGhlIFBhc3QgWWVhciAiKSsKICB0aGVtZV9saW5lZHJhdygpICsKICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDkwKSwKICAgICAgICBsZWdlbmQucG9zaXRpb24gPSAibm9uZSIpIAoKTURFX3RvdGFsCmBgYAoKV2UgY2FuIHNlZSB0aGF0IHRoZXJlIGlzIGEgc3RlZXAgaW5jcmVhc2UgYWZ0ZXIgYXJvdW5kIDIwMTEhIAoKTGV0J3MgYWRkIGEgZGlmZmVyZW50IGJhY2tncm91bmQgY29sb3IgZm9yIHRoZSB5ZWFycyBzaW5jZSAyMDExLgpXZSBjYW4gZG8gc28gYnkgYWRkaW5nIGEgYGdlb21fcmVjdCgpYCBsYXllciBiZWZvcmUgd2UgcGxvdCB0aGUgbGluZS4KV2UganVzdCBuZWVkIHRvIHNwZWNpZnkgdGhlIGxvY2F0aW9uIG9mIHRoZSByZWN0YW5nbGUgb24gb3VyIHBsb3QuCgpXZSBhbHNvIHVzZSB0aGUgYHRoZW1lX2NsYXNzaWMoKWAgdGhlbWUgYW5kIHdlIHdpbGwgYWRkIGEgZmFjZXQgdXNpbmcgdGhlIGBmYWNldF93cmFwKClgIGZ1bmN0aW9uIHRvIGFkZCBzdHJpcCBvZiB0ZXh0IHRvIHRoZSB0b3Agb2YgdGhlIHBsb3QgdG8gdGVsbCBtb3JlIGFib3V0IHdoYXQgaXMgY29udGFpbmVkIHdpdGhpbiB0aGUgcGxvdC4gVGhpcyBmdW5jdGlvbiBpcyB0eXBpY2FsbHkgdXNlZCB0byBjcmVhdGUgc3VicGxvdHMgd2hpY2ggd2Ugd2lsbCBkZW1vbnN0cmF0ZSBuZXh0LgoKV2Ugd2FudCB0byBjaGFuZ2UgdGhlIHZhbHVlIGBUT1RBTGAgb2YgdGhlIGBEZW1vZ3JhcGhpYyB2YXJhaWJsZWAgdG8gYCJQZXJjZW50IG9mIHJlc3BvbmRhbnRzIHdpdGggTURFImAgc28gdGhhdCB0aGUgdGV4dCBpbiB0aGUgc3RyaXAgYWJvdmUgdGhlIHBsb3Qgc2hvd3MgdGhpcyBpbnN0ZWFkLiBXZSBjYW4gZG8gc28gYnkgdXNpbmcgdGhlIGByZWNvZGUoKWAgZnVuY3Rpb24gb2YgdGhlIGBkcGx5cmAgcGFja2FnZS4gCgpXZSB3aWxsIGFsc28gY2hhbmdlIHRoZSBjb2xvciBvZiB0aGUgbGluZSB1c2luZyB0aGUgYHNjYWxlX2NvbG9yX21hbnVhbCgpYCBmdW5jdGlvbiBvZiB0aGUgYGdncGxvdDJgIHBhY2thZ2UuCgpgYGB7cn0KCk1ERV90b3RhbCA8LQogIHBlcmNlbnRzICU+JQogIGZpbHRlcihkYXRhX3R5cGUgPT0gIk1ham9yX0RlcHJlc3NpdmVfRXBpc29kZSIsIAogICAgICAgICBEZW1vZ3JhcGhpYyA9PSAiVE9UQUwiKSAlPiUKICBtdXRhdGUoRGVtb2dyYXBoaWMgPSByZWNvZGUoRGVtb2dyYXBoaWMsIAogICAgICAgICAgICAgIlRPVEFMIiA9ICJQZXJjZW50IG9mIHJlc3BvbmRlbnRzIHdpdGggTURFIikpJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IFBlcmNlbnQsIGdyb3VwID0gRGVtb2dyYXBoaWMpKSArCiAgZmFjZXRfd3JhcCh+RGVtb2dyYXBoaWMpKwogIGdlb21fcmVjdCh4bWluID0gMjAxMSwgeG1heCA9IEluZiwgIAogICAgICAgICAgICB5bWluID0gLUluZiwgeW1heCA9IEluZiwgIAogICAgICAgICAgICBmaWxsID0gImxpZ2h0IGdyYXkiKSArCiAgZ2VvbV9saW5lKGFlcyhjb2xvciA9IERlbW9ncmFwaGljKSwgc2l6ZSA9IDEuNSkgKwogIHNjYWxlX3hfY29udGludW91cyhicmVha3MgPSBzZXEoMjAwNCwgMjAxOCwgYnk9MSksCiAgICAgICAgICAgICAgICAgICAgIGxhYmVscyA9IHNlcSgyMDA0LCAyMDE4LCBieT0xKSwKICAgICAgICAgICAgICAgICAgICAgbGltaXRzID0gYygyMDA0LCAyMDE4KSkgKwogIGxhYnModGl0bGUgPSAiVGhlIFJhdGUgb2YgWW91dGhzIEFnZWQgMTIgdG8gMTcgUmVwb3J0aW5nIEhhdmluZyBhIFxuIE1ham9yIERlcHJlc3NpdmUgRXBpc29kZSAoTURFKSBpcyBJbmNyZWFzaW5nIikrCiAgdGhlbWVfY2xhc3NpYygpICsKICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDkwKSwKICAgICAgICBsZWdlbmQucG9zaXRpb24gPSAibm9uZSIsCiAgICAgICBzdHJpcC5iYWNrZ3JvdW5kID0gZWxlbWVudF9yZWN0KGZpbGwgPSJibGFjayIpLAogICAgICAgICAgICAgc3RyaXAudGV4dCA9IGVsZW1lbnRfdGV4dChmYWNlID0gImJvbGQiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZSA9IDE0LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvciA9ICJ3aGl0ZSIpKSArCiAgc2NhbGVfY29sb3JfbWFudWFsKHZhbHVlcyA9IGMoInJlZCIpKQoKTURFX3RvdGFsCmBgYAoKCiMjIyMgey5xdWVzdGlvbl9ibG9ja30KPGI+PHU+IFF1ZXN0aW9uIE9wcG9ydHVuaXR5IDwvdT48L2I+CgpXaGF0IGRvIHlvdSBleHBlY3Qgd2lsbCBoYXBwZW4gd2hlbiBpZiB3ZSBoYWQgdXNlZCB0aGUgYCtgIHN5bWJvbCB0byBhZGQgdGhlIGBnZW9tX3JlY3QoKWAgZnVuY3Rpb24gd2l0aCBgTURFX3RvdGFsYCBsaWtlIHNvPyAKSXMgdGhhdCB3aGF0IHlvdSBhbnRpY2lwYXRlZD8gV2h5IG9yIHdoeSBub3Q/IAoKYGBge3IsIGV2YWw9RkFMU0V9Ck1ERV90b3RhbCArIAogIGdlb21fcmVjdCh4bWluID0gMjAxMSwgeG1heCA9IEluZiwgIAogICAgICAgICAgICB5bWluID0gLUluZiwgeW1heCA9IEluZiwgIAogICAgICAgICAgICBmaWxsID0gImxpZ2h0IGdyYXkiKQpgYGAKCiMjIyMKCldlIGNhbiBjcmVhdGUgYSB0aGVtZSBmb3Igb3VyIGZ1dHVyZSBzaW1pbGFyIGdncGxvdHMgbGlrZSBzbzoKCmBgYHtyfQpvdmVydmlld190aGVtZSA8LWZ1bmN0aW9uKCkgewogIHRoZW1lX2NsYXNzaWMoKSArCiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA5MCksCiAgICAgICAgbGVnZW5kLnBvc2l0aW9uID0gIm5vbmUiLAogICAgICAgc3RyaXAuYmFja2dyb3VuZCA9IGVsZW1lbnRfcmVjdChmaWxsID0iYmxhY2siKSwKICAgICAgICAgICAgIHN0cmlwLnRleHQgPSBlbGVtZW50X3RleHQoZmFjZSA9ICJib2xkIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemUgPSAxNCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSAid2hpdGUiKSkKICB9CmBgYAoKCk5vdyBsZXQncyBsb29rIGF0IGdyb3VwIGRpZmZlcmVuY2VzLiAgCgpUbyBtYWtlIHN1cmUgb3VyIHBsb3QgaXMgbm90IHRvbyBvdmVyd2hlbG1pbmcsIGxldCdzIGxpbWl0IHRvIG9ubHkgYWdlIGFuZCBzZXggc3ViZ3JvdXBzLiAKVGh1cywgd2Ugd2lsbCBmaWx0ZXIgb3V0IHRoZSBkYXRhIGFib3V0IHRvdGFscyBhbmQgZGlmZmVyZW50IHJhY2lhbC9ldGhuaWMgZ3JvdXBzIGZvciBub3cuIApXZSB3aWxsIGFsc28gdXNlIHRoZSBgZmFjZXRfd3JhcCgpYCBmdW5jdGlvbiB0byBtYWtlIHN1YnBsb3RzIGJhc2VkIG9uIHRoZSBkZW1vZ3JhcGhpYyBjYXRlZ29yaWVzLCB3aGljaCB3ZSBwdXQgaW4gYSB2YXJpYWJsZSBjYWxsZWQgYHN1Ymdyb3Vwc2AgZWFybGllciB3aGVuIHdlIHdyYW5nbGVkIHRoZSBkYXRhLgoKYGBge3J9Ck1ERV9hZ2Vfc2V4IDwtcGVyY2VudHMgJT4lCiAgZmlsdGVyKGRhdGFfdHlwZSA9PSAiTWFqb3JfRGVwcmVzc2l2ZV9FcGlzb2RlIiwgCiAgICAgICAgIHN1Ymdyb3VwICE9ICJSYWNlL0V0aG5pY2l0eSIsIAogICAgICAgICBEZW1vZ3JhcGhpYyAhPSAiVE9UQUwiKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSBZZWFyLCB5ID0gUGVyY2VudCwgY29sb3IgPSBEZW1vZ3JhcGhpYykpICsKICBnZW9tX2xpbmUoYWVzKGNvbG9yID0gRGVtb2dyYXBoaWMpLCBzaXplID0xKSArCiAgc2NhbGVfeF9jb250aW51b3VzKGJyZWFrcyA9IHNlcSgyMDA0LCAyMDE4LCBieT0xKSwKICAgICAgICAgICAgICAgICAgICAgbGFiZWxzID0gc2VxKDIwMDQsIDIwMTgsIGJ5PTEpLAogICAgICAgICAgICAgICAgICAgICBsaW1pdHMgPSBjKDIwMDQsIDIwMTgpKSArCiAgbGFicyh0aXRsZSA9ICJNYWpvciBEZXByZXNzaXZlIEVwaXNvZGVcbmFtb25nIFBlcnNvbnMgQWdlZCAxMiB0byAxNyIsCiAgICAgICBzdWJ0aXRsZSA9ICJCeSBEZW1vZ3JhcGhpYyBDaGFyYWN0ZXJpc3RpY3MsIFBlcmNlbnRhZ2VzLCAyMDA0LTIwMTgiKSArCiAgZmFjZXRfd3JhcCh+IHN1Ymdyb3VwKSsKICB0aGVtZV9saW5lZHJhdygpICsKICB0aGVtZShzdHJpcC50ZXh0ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxNCwgZmFjZSA9ICJib2xkIiksCiAgICAgICAgYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA5MCkpIAoKTURFX2FnZV9zZXgKYGBgCgpOaWNlISBOb3cgaXQgaXMgbXVjaCBlYXNpZXIgdG8gdGVsbCBob3cgZWFjaCBncm91cCBoYXMgY2hhbmdlZCBvdmVyIHRpbWUuCgpXZSBjYW4gYWxzbyBhZGQgbGFiZWxzIGRpcmVjdGx5IHRvIHRoZSBsaW5lcyB1c2luZyB0aGUgYGRpcmVjdGxhYmVsc2AgcGFja2FnZS4gClRoZXJlIGFyZSBzZXZlcmFsIG1ldGhvZHMgdG8gZG8gc28uIApTZWUgW2hlcmVdKGh0dHA6Ly9kaXJlY3RsYWJlbHMuci1mb3JnZS5yLXByb2plY3Qub3JnL2RvY3MvaW5kZXguaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSBmb3IgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgb3B0aW9ucyBmb3IgYWRkaW5nIGxhYmVscyB3aXRoIHRoaXMgcGFja2FnZS4gIApXZSB1c2UgdGhlIGAiZmFyLmZyb20ub3RoZXJzLmJvcmRlcnMiYCBtZXRob2Qgc28gdGhhdCBvdXIgbGFiZWxzIGRvIG5vdCBvdmVybGFwIG9uZSBhbm90aGVyLiAKV2UgYWxzbyB1c2UgYGRsLnRyYW5zKClgIG9mIHRoZSBgZGlyZWN0bGFiZWxzYCBwYWNrYWdlIHRvIG1vdmUgdGhlIGxhYmVscyBzbGlnaHRseSB1cHdhcmQgKGB5ID0geSArMC4zNWApIGFuZCB0byB0aGUgbGVmdCAoYHggPSB4IC0wLjFgKS4gClRoZSBgZGwubW92ZSgpYCBmdW5jdGlvbiBvZiB0aGUgYGRpcmVjdGxhYmVsc2AgcGFja2FnZSBpcyB1c2VkIHRvIG1vdmUgb25lIG9mIHRoZSBsYWJlbHMgdG8gYSBwYXJ0aWN1bGFyIGxvY2F0aW9uLiAKCk5vdGU6IHRoZSBkbC5tb3ZlIGZ1bmN0aW9ucyBhcmUgc2V0IHVwIGZvciB0aGUgcmVuZGVyaW5nIHRoZSBybWFya2Rvd24gLSBzbyBpZiB5b3UgYXJlIHZpZXdpbmcgdGhlIGNhc2Ugc3R1ZHkgZnJvbSBSU3R1ZGlvIHRoZSBsYWJlbHMgd2lsbCBvdmVybGFwLgoKCmBgYHtyfQpkaXJlY3RsYWJlbHM6OmRpcmVjdC5sYWJlbCgKICBNREVfYWdlX3NleCwgCiAgbGlzdChkbC50cmFucyh5ID0geSArIDAuMzgsIHggPSB4IC0wLjEpLCAKICAgICAgICJmYXIuZnJvbS5vdGhlcnMuYm9yZGVycyIsCiAgICAgICBjZXggPSAuOCwgCiAgICAgICBkbC5tb3ZlKCJBZ2VfMTQtMTUiLCB4ID0gMjAwOCwgeSA9IDEwKSkKICApCmBgYAoKVGhpcyBsb29rcyB2ZXJ5IGNsZWFyIG5vdyEKCldlIGNhbiBzZWUgdGhhdCB0aGUgbWFqb3JpdHkgb2YgaW5kaXZpZHVhbHMgdGhhdCByZXBvcnRlZCBleHBlcmllbmNpbmcgYSBtYWpvciBkZXByZXNzaXZlIGVwaXNvZGUgaW4gdGhlIHBhc3QgeWVhciB3ZXJlIGluIGFuIG9sZGVyIGFnZSBicmFja2V0ICgxNi0xNyBjb21wYXJlZCB0byAxMi0xMykuIApXZSBjYW4gYWxzbyBzZWUgdGhhdCB0aGUgdHJlbmQgaGFzIGJlZW4gaW5jcmVhc2luZyBmb3IgYWxsIHRocmVlIGFnZSBicmFja2V0cyBzaW5jZSByb3VnaGx5IDIwMTEuCgpXZSBjYW4gYWxzbyBzZWUgYW4gaW5jcmVhc2UgZm9yIGJvdGggc2V4ZXMgc2luY2UgYWJvdXQgMjAxMSwgYnV0IHRoZXJlIGlzIGEgc3RlZXBlciBpbmNyZWFzZSBmb3IgZmVtYWxlcy4gCkZ1cnRoZXJtb3JlLCBmZW1hbGVzIGhhdmUgYSBtdWNoIGhpZ2hlciByYXRlIHRoYW4gbWFsZXMgYWNyb3NzIGFsbCB5ZWFycy4KCkxldCdzIG1ha2UgdGhlIHNhbWUgcGxvdCB3aXRoIGEgZGlmZmVyZW50IHNoYWRlZCBiYWNrZ3JvdW5kIGZvciB0aGUgeWVhcnMgb2YgdGhlIGluY3JlYXNlIGxpa2Ugd2UgZGlkIGZvciB0aGUgdG90YWwgcGxvdC4KCmBgYHtyfQpNREVfYWdlX3NleCA8LQogIHBlcmNlbnRzICU+JQogIGZpbHRlcihkYXRhX3R5cGUgPT0gIk1ham9yX0RlcHJlc3NpdmVfRXBpc29kZSIsIAogICAgICAgICBzdWJncm91cCAhPSAiUmFjZS9FdGhuaWNpdHkiLCAKICAgICAgICAgRGVtb2dyYXBoaWMgIT0gIlRPVEFMIikgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IFBlcmNlbnQsIGdyb3VwID0gRGVtb2dyYXBoaWMpKSArCiAgZ2VvbV9yZWN0KHhtaW4gPSAyMDExLCB4bWF4ID0gSW5mLCAgCiAgICAgICAgICAgIHltaW4gPSAtSW5mLCB5bWF4ID0gSW5mLCAgCiAgICAgICAgICAgIGZpbGwgPSAibGlnaHQgZ3JheSIpKwogIGdlb21fbGluZShhZXMoY29sb3IgPSBEZW1vZ3JhcGhpYyksIHNpemUgPTEpICsKICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDIwMDQsIDIwMTgsIGJ5PTEpLAogICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBzZXEoMjAwNCwgMjAxOCwgYnk9MSksCiAgICAgICAgICAgICAgICAgICAgIGxpbWl0cyA9IGMoMjAwNCwgMjAxOCkpICsKICBsYWJzKHRpdGxlID0gIk1ham9yIERlcHJlc3NpdmUgRXBpc29kZVxuYW1vbmcgUGVyc29ucyBBZ2VkIDEyIHRvIDE3IiwKICAgICAgIHN1YnRpdGxlID0gIkJ5IERlbW9ncmFwaGljIENoYXJhY3RlcmlzdGljcywgUGVyY2VudGFnZXMsIDIwMDQtMjAxOCIpICsKICBmYWNldF93cmFwKH4gc3ViZ3JvdXApICsKICB0aGVtZV9saW5lZHJhdygpICsKICB0aGVtZShzdHJpcC50ZXh0ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxNCwgZmFjZSA9ICJib2xkIiksCiAgICAgICAgYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA5MCkpIAoKTURFX2FnZV9zZXggPC0gZGlyZWN0LmxhYmVsKAogIE1ERV9hZ2Vfc2V4LCAKICBsaXN0KGRsLnRyYW5zKHkgPSB5ICswLjM4LCB4ID0geCAtMC4yKSwgCiAgICAgICAiZmFyLmZyb20ub3RoZXJzLmJvcmRlcnMiLCAKICAgICAgIGNleCA9IC44LAogICAgICAgZGwubW92ZSgiQWdlXzE0LTE1IiwgeCA9IDIwMDgsIHkgPTEwKSkKICApCk1ERV9hZ2Vfc2V4CmBgYAoKSW4gdGhlIG5leHQgc2VjdGlvbiwgd2Ugd2lsbCBmb3JtYWxseSB0ZXN0IHdoZXRoZXIgYFNleGAgaXMgaW5kZXBlbmRlbnQgb2YgdGhlIGRpZmZlcmVuY2VzIGluIHJhdGVzIG9mIE1ERSBhY3Jvc3MgdGltZS4gCgp3aGV0aGVyIHRoZXJlIGlzIGEgc3RhdGlzdGljYWxseSBzaWduaWZpY2FudCBkaWZmZXJlbmNlIGJldHdlZW4gdGhlIGV4cGVjdGVkIGZyZXF1ZW5jaWVzIGFuZCB0aGUgb2JzZXJ2ZWQgZnJlcXVlbmNpZXMgaW4gb25lIG9yIG1vcmUgY2F0ZWdvcmllcyBvZiBhIGNvbnRpbmdlbmN5IHRhYmxlLgoKV2hpbGUsIGl0IGlzIHZlcnkgaW50cmlndWluZyB0aGF0IHRoZXJlIGlzIGFuIGluY3JlYXNlIGFyb3VuZCAyMDExLCB3ZSBkbyBub3QgZ28gaW50byBkZXRhaWxzIGhlcmUgYXMgdG8gd2h5IHRoYXQgbWlnaHQgYmUgaGFwcGVuaW5nLiAKSG93ZXZlciwgd2Ugc3VtbWFyaXplIGEgZmV3IGFydGljbGVzIHRoYXQgZGlkIGludmVzdGlnYXRlIGluY3JlYXNlZCBkZXByZXNzaW9uIHJhdGVzLiAKCioqKgoKPGRldGFpbHM+IDxzdW1tYXJ5PiBDbGljayBoZXJlIGZvciBhIHN1bW1hcnkgb24gYSBmZXcgYXJ0aWNsZXMgaW52ZXN0aWdhdGluZyBpbmNyZWFzZWQgZGVwcmVzc2lvbiByYXRlcy4gPC9zdW1tYXJ5PgoKClRoaXMgY3Jvc3MtY3VsdHVyYWwgW3JldmlldyBhcnRpY2xlXShodHRwczovL3d3dy5uY2JpLm5sbS5uaWguZ292L3BtYy9hcnRpY2xlcy9QTUMzMzMwMTYxLyl7dGFyZ2V0PSJfYmxhbmsifSBwdWJsaXNoZWQgaW4gMjAxMiBzdWdnZXN0cyB0aGF0IGFzcGVjdHMgcmVsYXRlZCB0byBsaWZlLXN0eWxlIGR1ZSB0byBtb2Rlcm5pdHkgbWF5IGJlIGNhdXNpbmcgaW5jcmVhc2VkIGRlcHJlc3Npb24gcmF0ZXM6IAoKPiBNb2Rlcm4gcG9wdWxhdGlvbnMgYXJlIGluY3JlYXNpbmdseSBvdmVyZmVkLCBtYWxub3VyaXNoZWQsIHNlZGVudGFyeSwgc3VubGlnaHQtZGVmaWNpZW50LCBzbGVlcC1kZXByaXZlZCwgYW5kIHNvY2lhbGx5LWlzb2xhdGVkLiBUaGVzZSBjaGFuZ2VzIGluIGxpZmVzdHlsZSBlYWNoIGNvbnRyaWJ1dGUgdG8gcG9vciBwaHlzaWNhbCBoZWFsdGggYW5kIGFmZmVjdCB0aGUgaW5jaWRlbmNlIGFuZCB0cmVhdG1lbnQgb2YgZGVwcmVzc2lvbi4KCkFuZCBhbHRob3VnaCB0aGlzIG1heSBiZSB0cnVlIGdsb2JhbGx5LCB0aGUgVVMgaGFzIGJlZW4gYXJndWFibHkgZXhwZXJpZW5jaW5nIHRoZXNlIG1vZGVybiBsaWZlc3R5bGUgY2hhbmdlcyBmb3IgeWVhcnMgcHJpb3IgdG8gdGhpcyBzdGVlcCBpbmNyZWFzZSBpbiAyMDExLgoKU28gd2hhdCBtaWdodCBoYXZlIGhhcHBlbmVkIGluIHRoZSBVUyBhcm91bmQgdGhpcyB0aW1lPwoKVGhlcmUgaXMgbGFyZ2UgYW1vdW50IG9mIGxpdGVyYXR1cmUgYWJvdXQgaG93IHRoZSB1c2Ugb2Ygc21hcnQgcGhvbmUgYW5kIHNvY2lhbCBtZWRpYSBtYXkgaGF2ZSBsZWFkIHRvIGluY3JlYXNlZCBkZXByZXNzaW9uIHJhdGVzLiBTZWUgdGhpcyBbYXJ0aWNsZV0oaHR0cHM6Ly9jaGlsZG1pbmQub3JnL2FydGljbGUvaXMtc29jaWFsLW1lZGlhLXVzZS1jYXVzaW5nLWRlcHJlc3Npb24vKXt0YXJnZXQ9Il9ibGFuayJ9IHdoaWNoIGxpbmtzIHRvIG1hbnkgc2NpZW50aWZpYyBhcnRpY2xlcyBvbiB0aGUgc3ViamVjdC4gCgpUaGlzIGhhcyBiZWVuIGEgY29udHJvdmVyc2lhbCB0b3BpYyBkdWUgdG8gY29uZmxpY3RpbmcgZmluZGluZ3MsIGxpa2VseSBkdWUgdG8gZm9jdXMgb24gZGlmZmVyZW50IHNpdGVzIGFuZCBhc3BlY3RzIG9mIHNvY2lhbCBtZWRpYSBhY3Jvc3MgZGlmZmVyZW50IHN0dWRpZXMuIAoKVGhlIGFydGljbGUgcG9pbnRzIG91dCB0aGF0IHRoZSB0cnVlIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIHNvY2lhbCBtZWRpYSB1c2UgYW5kIGRlcHJlc3Npb24gbWF5IGJlIG51YW5jZWQuIFNvbWUgaW5kaXZpZHVhbHMgd2hvIGhhdmUgaGlnaCBmYWNlLXRvLWZhY2UgbGV2ZWxzIG9mIGludGVyYWN0aW9uIG9yIGxhY2sgb2YgdGhlIG9wcG9ydHVuaXR5IHRvIGludGVyYWN0IHdpdGggb3RoZXJzIGZhY2UtdG8tZmFjZSAoZHVlIHRvIHZhcmlvdXMgYmFycmllcnMgbGlrZSBnZW9ncmFwaHkpLCBtYXkgYWN0dWFsbHkgZXhwZXJpZW5jZSBsb3dlciByaXNrIGZvciBkZXByZXNzaW9uIHdpdGggbW9yZSBzb2NpYWwgbWVkaWEgdXNlLiAKCkZ1cnRoZXJtb3JlLCBkaWZmZXJlbnQgc29jaWFsIG1lZGlhIHBsYXRmb3JtcyBtYXkgdmFyeSBmb3IgdGhlaXIgaW5mbHVlbmNlIG9uIGRlcHJlc3Npb24uCgpJbnN0YWdyYW0gd2FzIHJlbGVhc2VkIGluIDIwMTAgKHdoaWNoIGlzIGFyb3VuZCB3aGVuIG91ciBwbG90IHN0YXJ0cyB0byBzaG93IHRoZSB1cHdhcmQgaW5jcmVhc2UgaW4gbWFqb3IgZGVwcmVzc2l2ZSBlcGlzb2RlcywgcGFydGljdWxhcmx5IGluIGZlbWFsZXMpIGFuZCBhY2NvcmRpbmcgdG8gdGhlIGFydGljbGU6Cgo+IEltYWdlLWRyaXZlbiBJbnN0YWdyYW0gc2hvd3MgdXAgaW4gc3VydmV5cyBhcyB0aGUgcGxhdGZvcm0gdGhhdCBtb3N0IGxlYWRzIHlvdW5nIHBlb3BsZSB0byByZXBvcnQgZmVlbGluZyBhbnhpZXR5LCBkZXByZXNzaW9uIGFuZCB3b3JyaWVzIGFib3V0IGJvZHkgaW1hZ2UuCgpGdXJ0aGVybW9yZSwgaXQgbWF5IGJlIHNlY29uZGFyeSBlZmZlY3RzIG9mIHNvY2lhbCBtZWRpYSB1c2UsIGxpa2UgbGVzcyBwaHlzaWNhbCBhY3Rpdml0eSBvciBsZXNzIHNsZWVwIHRoYXQgbWF5IGluY3JlYXNlIHRoZSByaXNrIGZvciBkZXByZXNzaW9uLiAKCjwvZGV0YWlscz4KCioqKgoKTmV4dCwgbGV0J3MgdGFrZSBhIGxvb2sgYXQgaG93IHRoZSByYXRlIG9mIG1ham9yIGRlcHJlc3NpdmUgZXBpc29kZXMgaGFzIGNoYW5nZWQgYWNyb3NzIHRpbWUgZm9yIGRpZmZlcmVudCByYWNpYWwvZXRobmljIGdyb3Vwcy4KClNpbmNlIHdlIGhhdmUgc28gbWFueSBncm91cHMsIHdlIHByb2JhYmx5IGRvbid0IHdhbnQgdG8gZGlyZWN0bHkgbGFiZWwgdGhlIGxpbmVzIHRoaXMgdGltZS4gCkluc3RlYWQsIHdlIHdpbGwgcmVseSBvbiB0aGUgbGVnZW5kIHRoYXQgd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGNyZWF0ZWQuCgpXZSB3aWxsIHVzZSB0aGUgdGhlIGBmY3RfcmVvcmRlcigpYCBmdW5jdGlvbiBvZiB0aGUgYGZvcmNhdHNgIHBhY2thZ2UgdG8gb3JkZXIgdGhlIHJhY2lhbC9ldGhuaWMgZ3JvdXBzIGluIHRoZSBsZWdlbmQgYmFzZWQgb24gdGhlIGxhc3QgdmFsdWUgKHVzaW5nIGB0YWlsKClgKSBvZiB0aGUgYFBlcmNlbnRgIHZhcmlhYmxlLgoKV2Ugd2lsbCBhbHNvIG1hbnVhbGx5IGNvbG9yIG91ciBsaW5lcyBiYXNlZCBvbiBhIGNvbG9yIHBhbGV0dGUgY2FsbGVkIFt2aXJpZGlzXShodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvdmlyaWRpcy92aWduZXR0ZXMvaW50cm8tdG8tdmlyaWRpcy5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9LCB3aGljaCBpcyBtb3JlIGRpc2Nlcm5pYmxlIGZvciBpbmRpdmlkdWFscyB3aXRoIGNvbG9yLWJsaW5kbmVzcy4gVG8gZG8gc28gd2Ugd2lsbCB1c2UgdGhlIGBzY2FsZV9jb2xvcl92aXJpZGlzX2QoKWAgZnVuY3Rpb24gb2YgdGhlIGBnZ3Bsb3QyYCBwYWNrYWdlLCB3aGljaCBpcyBpbnRlbmRlZCBmb3IgY29sb3JpbmcgZGlzY3JldGUgdmFsdWVzLgoKYGBge3J9Ck1ERV9yYWNlIDwtCiAgcGVyY2VudHMgJT4lCiAgZmlsdGVyKGRhdGFfdHlwZSA9PSAiTWFqb3JfRGVwcmVzc2l2ZV9FcGlzb2RlIiwgCiAgICAgICAgIHN1Ymdyb3VwID09ICJSYWNlL0V0aG5pY2l0eSIpICU+JQogIG11dGF0ZShEZW1vZ3JhcGhpYyA9IAogICAgICAgICAgIGZjdF9yZW9yZGVyKERlbW9ncmFwaGljLCBQZXJjZW50LCAKICAgICAgICAgICAgICAgICAgICAgICB0YWlsLCBuID0gMSwgLmRlc2MgPSBUUlVFKSkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IFBlcmNlbnQsIGdyb3VwID0gRGVtb2dyYXBoaWMpKSArCiAgICBnZW9tX3JlY3QoeG1pbiA9IDIwMTEsIHhtYXggPSBJbmYsICAgCiAgICAgICAgICAgICAgeW1pbiA9IC1JbmYsIHltYXggPSBJbmYsICAgCiAgICAgICAgICAgICAgZmlsbCA9ICJsaWdodCBncmF5IikgKwogIGdlb21fbGluZShhZXMoY29sb3IgPSBEZW1vZ3JhcGhpYyksIHNpemUgPTEpICsKICBmYWNldF93cmFwKH4gc3ViZ3JvdXApICsKICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDIwMDQsIDIwMTgsIGJ5PTEpLAogICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBzZXEoMjAwNCwgMjAxOCwgYnk9MSksCiAgICAgICAgICAgICAgICAgICAgIGxpbWl0cyA9IGMoMjAwNCwgMjAxOCkpICsKICBzY2FsZV9jb2xvcl92aXJpZGlzX2QoKSArCiAgbGFicyh0aXRsZSA9ICJNYWpvciBEZXByZXNzaXZlIEVwaXNvZGVcbmFtb25nIFBlcnNvbnMgQWdlZCAxMiB0byAxNyIsCiAgICAgICBzdWJ0aXRsZSA9ICJCeSBEZW1vZ3JhcGhpYyBDaGFyYWN0ZXJpc3RpY3MsIFBlcmNlbnRhZ2VzLCAyMDA0LTIwMTgiKSArCiAgdGhlbWVfbGluZWRyYXcoKSArCiAgdGhlbWUoc3RyaXAudGV4dCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTQsIGZhY2UgPSAiYm9sZCIpLAogICAgICAgIGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gOTApKSAKCk1ERV9yYWNlCmBgYAoKVXNpbmcgdGhlIGRlZmluaXRpb25zIGZyb20gdGhlIFtDZW5zdXMgQnVyZWF1XShodHRwczovL3d3dy5jZW5zdXMuZ292L3Byb2dyYW1zLXN1cnZleXMvY3BzL2RhdGEvZGF0YS10b29scy9jcHMtdGFibGUtY3JlYXRvci1oZWxwL3JhY2UtZGVmaW5pdGlvbnMuaHRtbCM6fjp0ZXh0PU5IT1BJJTIwQWxvbmUlMjAlRTIlODAlOTMlMjBOSE9QSSUyMGFsb25lJTIwcmVmZXJzLG5vdCUyMHJlcG9ydCUyMGFueSUyMG90aGVyJTIwcmFjZS4pe3RhcmdldD0iX2JsYW5rIn06IAoKMS4gKipBSUFOKiogc3RhbmRzIGZvciBBbWVyaWNhbiBJbmRpYW4gYW5kIEFsYXNrYSBOYXRpdmUgIAoyLiAqKk5IT1BJKiogc3RhbmRzIGZvciBOYXRpdmUgSGF3YWlpYW4gb3IgT3RoZXIgUGFjaWZpYyBJc2xhbmRlciAgCgpVbmZvcnR1bmF0ZWx5LCB0aGVyZSBpcyBvbmx5IG9uZSB2YWx1ZSBmb3IgYE5IT1BJYCBncm91cCwgdGh1cyBzaW5jZSB0aGlzIGlzIGEgbGluZSBwbG90LCB3ZSBkbyBub3QgaGF2ZSBlbm91Z2ggcG9pbnRzICgyIGF0IG1pbmltdW0pIHRvIGNyZWF0ZSBhIGxpbmUsIHNvIGxldHMgcmVtb3ZlIHRoaXMgZ3JvdXAgZnJvbSB0aGUgcGxvdCB0byByZW1vdmUgdGhlIGdyb3VwIGZyb20gdGhlIGxlZ2VuZC4KCiMjIyMgey5xdWVzdGlvbl9ibG9ja30KPGI+PHU+IFF1ZXN0aW9uIE9wcG9ydHVuaXR5IDwvdT48L2I+CgpIb3cgbWlnaHQgd2UgcmVtb3ZlIHRoZSBgTkhPUElgIGdyb3VwIGZyb20gdGhlIGxlZ2VuZD8KCiMjIyMKCgo8ZGV0YWlscz4gPHN1bW1hcnk+IENsaWNrIGhlcmUgdG8gcmV2ZWFsIHRoZSBjb2RlLiA8L3N1bW1hcnk+CgpgYGB7cn0KTURFX3JhY2UgPC0KICBwZXJjZW50cyAlPiUKICBmaWx0ZXIoZGF0YV90eXBlID09ICJNYWpvcl9EZXByZXNzaXZlX0VwaXNvZGUiLCAKICAgICAgICAgc3ViZ3JvdXAgPT0gIlJhY2UvRXRobmljaXR5IiwgCiAgICAgICAgIERlbW9ncmFwaGljICE9ICJOSE9QSSIpICU+JQogIG11dGF0ZShEZW1vZ3JhcGhpYyA9IAogICAgICAgICAgIGZjdF9yZW9yZGVyKERlbW9ncmFwaGljLCBQZXJjZW50LCAKICAgICAgICAgICAgICAgICAgICAgICB0YWlsLCBuID0gMSwgLmRlc2MgPSBUUlVFKSkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IFBlcmNlbnQsIGdyb3VwID0gRGVtb2dyYXBoaWMpKSArCiAgICBnZW9tX3JlY3QoeG1pbiA9IDIwMTEsIHhtYXggPSBJbmYsICAgCiAgICAgICAgICAgICAgeW1pbiA9IC1JbmYsIHltYXggPSBJbmYsICAgCiAgICAgICAgICAgICAgZmlsbCA9ICJsaWdodCBncmF5IikgKwogIGdlb21fbGluZShhZXMoY29sb3IgPSBEZW1vZ3JhcGhpYyksIHNpemUgPTEpICsKICBmYWNldF93cmFwKH4gc3ViZ3JvdXApICsKICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDIwMDQsIDIwMTgsIGJ5PTEpLAogICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBzZXEoMjAwNCwgMjAxOCwgYnk9MSksCiAgICAgICAgICAgICAgICAgICAgIGxpbWl0cyA9IGMoMjAwNCwgMjAxOCkpICsKICBzY2FsZV9jb2xvcl92aXJpZGlzX2QoKSArCiAgbGFicyh0aXRsZSA9ICJNYWpvciBEZXByZXNzaXZlIEVwaXNvZGVcbmFtb25nIFBlcnNvbnMgQWdlZCAxMiB0byAxNyIsCiAgICAgICBzdWJ0aXRsZSA9ICJCeSBEZW1vZ3JhcGhpYyBDaGFyYWN0ZXJpc3RpY3MsIFBlcmNlbnRhZ2VzLCAyMDA0LTIwMTgiKSArCiAgdGhlbWVfbGluZWRyYXcoKSArCiAgdGhlbWUoc3RyaXAudGV4dCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTQsIGZhY2UgPSAiYm9sZCIpLAogICAgICAgIGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gOTApKSAKYGBgCjwvZGV0YWlscz4KCgpgYGB7ciwgZWNobz1GQUxTRX0KTURFX3JhY2UKYGBgCgpXZSBjYW4gc2VlIHRoYXQgdGhlIGdyb3VwIG9mIGluZGl2aWR1YWxzIHdobyByZXBvcnRlZCBhcyBiZWluZyB0d28gb3IgbW9yZSByYWNlcywgaGFkIHRoZSBoaWdoZXN0IHBlcmNlbnRhZ2VzIG9mIGhhdmluZyBhIG1ham9yIGRlcHJlc3NpdmUgZXBpc29kZSBpbiB0aGUgcGFzdCB5ZWFyLiAKVGhvc2UgZ3JvdXAgd2hvIHJlcG9ydGVkIGFzIEJsYWNrIG9yIEFmcmljYW4gQW1lcmljYW4gaGFkIHRoZSBsb3dlc3QgcGVyY2VudGFnZXMuIApIb3dldmVyLCB3ZSBjYW4gc2VlIHRoYXQgbW9zdCBvZiB0aGUgcmFjaWFsL2V0aG5pYyBncm91cHMgYXJlIGZhaXJseSBzaW1pbGFyIGFuZCB3ZSBzZWUgYW4gaW5jcmVhc2luZyBmb3IgbW9zdCBncm91cHMgc2luY2UgYXJvdW5kIDIwMTEuIApLZWVwIGluIG1pbmQgdGhlIGxpbWl0YXRpb25zIGxpc3RlZCBpbiB0aGUgWyoqTGltaXRhdGlvbnMqKl0gc2VjdGlvbiBhcyB5b3UgdmlldyB0aGVzZSBmaW5kaW5ncy4gCkl0IGlzIHBvc3NpYmxlIHRoYXQgdGhpcyBncm91cCBtYXkgYmUgbGVzcyBsaWtlbHkgdG8gcmVwb3J0IGV4cGVyaWVuY2luZyBzeW1wdG9tcyBvZiBkZXByZXNzaW9uLgoKIyMjIE1ERSB3aXRoIFNldmVyZSBJbXBhaXJtZW50CgpOb3cgbGV0J3MgdGFrZSBhIGxvb2sgYXQgaG93IHRoZSByYXRlIG9mIHlvdXRocyByZXBvcnRpbmcgaGF2aW5nIGEgbWFqb3IgZGVwcmVzc2l2ZSBlcGlzb2RlIChNREUpICoqd2l0aCBzZXZlcmUgaW1wYWlybWVudCoqIGhhcyBjaGFuZ2VkIG92ZXIgdGltZS4gU2VlIHRoZSBbKipXaGF0IGFyZSB0aGUgZGF0YT8qKl0gc2VjdGlvbiBhYm91dCBob3cgc2V2ZXJlIGltcGFpcm1lbnQgd2FzIGRlZmluZWQuIAoKIyMjIyB7LnF1ZXN0aW9uX2Jsb2NrfQo8Yj48dT4gUXVlc3Rpb24gT3Bwb3J0dW5pdHkgPC91PjwvYj4KClRyeSB0byBjb21lIHVwIHdpdGggdGhlIGNvZGUgZm9yIHRoZSBmb2xsb3dpbmcgdHdvIHBsb3RzIG9uIHlvdXIgb3duIGJlZm9yZSB5b3UgcmV2ZWFsIGl0LiBUaGlzIHRpbWUgd2Ugd2lsbCB1c2UgdGhlIGBvdmVydmlld190aGVtZSgpYCBmdW5jdGlvbiB0aGF0IHdlIGNyZWF0ZWQuCgojIyMjCgo8ZGV0YWlscz4gPHN1bW1hcnk+IENsaWNrIGhlcmUgdG8gcmV2ZWFsIHRoZSBjb2RlLiA8L3N1bW1hcnk+CmBgYHtyfQpNREVTX3RvdGFsIDwtCiAgcGVyY2VudHMgJT4lCiAgZmlsdGVyKGRhdGFfdHlwZSA9PSAiU2V2ZXJlX01ham9yX0RlcHJlc3NpdmVfRXBpc29kZSIsIAogICAgICAgICBEZW1vZ3JhcGhpYyA9PSAiVE9UQUwiKSAlPiUKICBtdXRhdGUoRGVtb2dyYXBoaWMgPSByZWNvZGUoRGVtb2dyYXBoaWMsIAogICAgICAgICAgICAgIlRPVEFMIiA9ICJQZXJjZW50IG9mIHJlc3BvbmRlbnRzIHdpdGggU2V2ZXJlIE1ERSIpKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSBZZWFyLCB5ID0gUGVyY2VudCwgZ3JvdXAgPSBEZW1vZ3JhcGhpYykpICsKICAgIGdlb21fcmVjdCh4bWluID0gMjAxMSwgeG1heCA9IEluZiwgIAogICAgICAgICAgICAgIHltaW4gPSAtSW5mLCB5bWF4ID0gSW5mLCAgCiAgICAgICAgICAgICAgZmlsbCA9ICJsaWdodCBncmF5IikgKwogICAgZ2VvbV9saW5lKGFlcyhjb2xvciA9IERlbW9ncmFwaGljKSwgc2l6ZSA9MSkrCiAgICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDIwMDYsIDIwMTgsIGJ5PTEpLAogICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBzZXEoMjAwNiwgMjAxOCwgYnk9MSksCiAgICAgICAgICAgICAgICAgICAgIGxpbWl0cyA9IGMoMjAwNiwgMjAxOCkpICsKICAgIGxhYnModGl0bGUgPSAiTWFqb3IgRGVwcmVzc2l2ZSBFcGlzb2RlIHdpdGggU2V2ZXJlIEltcGFpcm1lbnRcbmFtb25nIFBlcnNvbnMgQWdlZCAxMiB0byAxNyIsCiAgICAgICAgIHN1YnRpdGxlID0gIkJ5IERlbW9ncmFwaGljIENoYXJhY3RlcmlzdGljcywgUGVyY2VudGFnZXMsIDIwMDQtMjAxOCIpICsKICAgIGZhY2V0X3dyYXAofiBEZW1vZ3JhcGhpYykgKwogICAgb3ZlcnZpZXdfdGhlbWUoKSsKICAgIHNjYWxlX2NvbG9yX21hbnVhbCh2YWx1ZXMgPSBjKCJyZWQiKSkKYGBgCgo8L2RldGFpbHM+CgoKYGBge3J9Ck1ERVNfdG90YWwKYGBgCgpOZXh0IGxldCdzIGxvb2sgYXQgYWdlIGdyb3VwcyBhbmQgc2V4IGRpZmZlcmVuY2VzOgoKCjxkZXRhaWxzPiA8c3VtbWFyeT4gQ2xpY2sgaGVyZSB0byByZXZlYWwgdGhlIGNvZGUuIDwvc3VtbWFyeT4KYGBge3J9Ck1ERVNfYWdlX3NleCA8LQogIHBlcmNlbnRzICU+JQogIGZpbHRlcihkYXRhX3R5cGUgPT0gIlNldmVyZV9NYWpvcl9EZXByZXNzaXZlX0VwaXNvZGUiLCAKICAgICAgICAgc3ViZ3JvdXAgIT0gIlJhY2UvRXRobmljaXR5IiwgCiAgICAgICAgIERlbW9ncmFwaGljICE9ICJUT1RBTCIpICU+JQogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBQZXJjZW50LCBncm91cCA9IERlbW9ncmFwaGljKSkgKwogICAgZ2VvbV9yZWN0KHhtaW4gPSAyMDExLCB4bWF4ID0gSW5mLCAgCiAgICAgICAgICAgICAgeW1pbiA9IC1JbmYsIHltYXggPSBJbmYsICAKICAgICAgICAgICAgICBmaWxsID0gImxpZ2h0IGdyYXkiKSArCiAgICBnZW9tX2xpbmUoYWVzKGNvbG9yID0gRGVtb2dyYXBoaWMpLCBzaXplID0xKSsKICAgIHNjYWxlX3hfY29udGludW91cyhicmVha3MgPSBzZXEoMjAwNiwgMjAxOCwgYnk9MSksCiAgICAgICAgICAgICAgICAgICAgIGxhYmVscyA9IHNlcSgyMDA2LCAyMDE4LCBieT0xKSwKICAgICAgICAgICAgICAgICAgICAgbGltaXRzID0gYygyMDA2LCAyMDE4KSkgKwogICAgbGFicyh0aXRsZSA9ICJNYWpvciBEZXByZXNzaXZlIEVwaXNvZGUgd2l0aCBTZXZlcmUgSW1wYWlybWVudFxuYW1vbmcgUGVyc29ucyBBZ2VkIDEyIHRvIDE3IiwKICAgICAgICAgc3VidGl0bGUgPSAiQnkgRGVtb2dyYXBoaWMgQ2hhcmFjdGVyaXN0aWNzLCBQZXJjZW50YWdlcywgMjAwNC0yMDE4IikgKwogICAgZmFjZXRfd3JhcCh+IHN1Ymdyb3VwKSArCiAgICB0aGVtZV9saW5lZHJhdygpICsKICAgIHRoZW1lKHN0cmlwLnRleHQgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDE0LCBmYWNlID0gImJvbGQiKSwKICAgICAgICAgIGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gOTApKSAKCk1ERVNfYWdlX3NleCAgPC0gZGlyZWN0LmxhYmVsKAogIE1ERVNfYWdlX3NleCwgCiAgbGlzdChkbC50cmFucyh5ID0geSArMC4zOSwgeCA9IHggLTAuMSksIAogICAgICAgImZhci5mcm9tLm90aGVycy5ib3JkZXJzIiwKICAgICAgIGNleCA9IC44LCAKICAgICAgIGRsLm1vdmUoIkFnZV8xNC0xNSIsIHg9IDIwMTYuNSwgeSA9IDExKSkKICApCmBgYAoKPC9kZXRhaWxzPgoKYGBge3IsIGVjaG89RkFMU0V9Ck1ERVNfYWdlX3NleApgYGAKCldlIGNhbiBzZWUgdGhhdCB0aGUgbWFqb3JpdHkgb2YgaW5kaXZpZHVhbHMgdGhhdCByZXBvcnRlZCBleHBlcmllbmNpbmcgYSBtYWpvciBkZXByZXNzaXZlIGVwaXNvZGUgd2l0aCBzZXZlcmUgaW1wYWlybWVudCB3ZXJlIGluIGFuIG9sZGVyIGFnZSBicmFja2V0LiAKSG93ZXZlciB0aGVyZSBhcHBlYXJzIHRvIGJlIGEgbW9yZSBkcmFtYXRpYyBjaGFuZ2UgaW4gdGhlIG1pZGRsZSBhZ2UgZ3JvdXAgZnJvbSAyMDExLTIwMTIuIApXZSBjYW4gc2VlIGEgdmVyeSBzdGVlcCBpbmNyZWFzZSBpbiB0aGUgZGF0YSBmb3IgdGhlIGZlbWFsZXMgYWZ0ZXIgMjAxMSwgYWdhaW4gdGhpcyBpcyBtdWNoIG1vcmUgc3RlZXAgdGhhbiB0aGUgaW5jcmVhc2Ugc2VlbiBmb3IgbWFsZXMgb3ZlciB0aW1lLgoKTm93IGxldCdzIGxvb2sgYXQgZGlmZmVyZW50IHJhY2lhbC9ldGhuaWMgZ3JvdXBzLgoKIyMjIyB7LnF1ZXN0aW9uX2Jsb2NrfQo8Yj48dT4gUXVlc3Rpb24gT3Bwb3J0dW5pdHkgPC91PjwvYj4KClRyeSB0byBjb21lIHVwIHdpdGggdGhlIGNvZGUgZm9yIHRoaXMgcGxvdCBvbiB5b3VyIG93biBiZWZvcmUgeW91IHJldmVhbCBpdC4KCiMjIyMKCjxkZXRhaWxzPiA8c3VtbWFyeT4gQ2xpY2sgaGVyZSB0byByZXZlYWwgdGhlIGNvZGUuIDwvc3VtbWFyeT4KCmBgYHtyfQpSYWNlX01ERVMgPC0KICBwZXJjZW50cyAlPiUKICBmaWx0ZXIoZGF0YV90eXBlID09ICJTZXZlcmVfTWFqb3JfRGVwcmVzc2l2ZV9FcGlzb2RlIiwgCiAgICAgICAgIHN1Ymdyb3VwID09ICJSYWNlL0V0aG5pY2l0eSIpICU+JQogIG11dGF0ZShEZW1vZ3JhcGhpYyA9IAogICAgICAgICAgIGZjdF9yZW9yZGVyKERlbW9ncmFwaGljLCBQZXJjZW50LCAKICAgICAgICAgICAgICAgICAgICAgICB0YWlsLCBuID0gMSwgLmRlc2MgPSBUUlVFKSkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IFBlcmNlbnQsIGdyb3VwID0gRGVtb2dyYXBoaWMpKSArCiAgICBnZW9tX3JlY3QoeG1pbiA9IDIwMTEsIHhtYXggPSBJbmYsICAKICAgICAgICAgICAgICB5bWluID0gLUluZiwgeW1heCA9IEluZiwgIAogICAgICAgICAgICAgIGZpbGwgPSAibGlnaHQgZ3JheSIpKwogICAgZ2VvbV9saW5lKGFlcyhjb2xvciA9IERlbW9ncmFwaGljKSwgc2l6ZSA9MSkrCiAgICBmYWNldF93cmFwKH4gc3ViZ3JvdXApICsKICAgIHNjYWxlX3hfY29udGludW91cyhicmVha3MgPSBzZXEoMjAwNiwgMjAxOCwgYnk9MSksCiAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxzID0gc2VxKDIwMDYsIDIwMTgsIGJ5PTEpLAogICAgICAgICAgICAgICAgICAgICAgIGxpbWl0cyA9IGMoMjAwNiwgMjAxOCkpICsKICAgIGxhYnModGl0bGUgPSAiTWFqb3IgRGVwcmVzc2l2ZSBFcGlzb2RlIHdpdGggU2V2ZXJlIEltcGFpcm1lbnRcbmFtb25nIFBlcnNvbnMgQWdlZCAxMiB0byAxNyIsCiAgICAgICAgIHN1YnRpdGxlID0gIkJ5IERlbW9ncmFwaGljIENoYXJhY3RlcmlzdGljczogUGVyY2VudGFnZXMsIDIwMDYtMjAxOCIpICsKICAgIHRoZW1lX2xpbmVkcmF3KCkgKwogICAgdGhlbWUoc3RyaXAudGV4dCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTQsIGZhY2UgPSAiYm9sZCIpLAogICAgICAgICAgYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA5MCkpICsKICAgIHNjYWxlX2NvbG9yX3ZpcmlkaXNfZCgpCmBgYAo8L2RldGFpbHM+CgpgYGB7ciwgZWNobz1GQUxTRX0KUmFjZV9NREVTCmBgYAoKV2Ugc2VlIHNpbWlsYXIgdHJlbmRzIGFzIHdlIHNhdyBmb3IgdGhlIHByZXZpb3VzIHJhY2lhbC9ldGhuaWMgZ3JvdXAgcGxvdC4gClRoZSByYXRlIGlzIGhpZ2hlc3QgZm9yIHRob3NlIHdobyBhcmUgdHdvIGFyZSBtb3JlIHJhY2VzIGFuZCBsb3dlc3QgZm9yIHRob3NlIHdobyBhcmUgQmxhY2sgb3IgQWZyaWNhbiBBbWVyaWNhbi4gClRoZSBkYXRhIGZvciB0aGUgQUlBTiBncm91cCBpcyBzcGFyc2UsIHNvIGl0IGlzIHVuY2xlYXIgaWYgdGhlaXIgbGV2ZWxzIHdvdWxkIGJlIGxvd2VzdCBvbiB0aGUgbGFzdCB5ZWFyLgoKIyMjIE1ERSBUcmVhdG1lbnQKCk5vdyB3ZSB3aWxsIHRha2UgYSBsb29rIGF0IHRob3NlIHdobyByZXBvcnRlZCBoYXZpbmcgYSBNREUgYW5kIHJlY2VpdmVkIHRyZWF0bWVudCBmb3IgZGVwcmVzc2lvbi4gCgpGaXJzdCwgbGV0J3MgbG9vayBvdmVyYWxsIHVzaW5nIHRoZSBgRGVtb2dyYXBoaWMgPT0gIlRPVEFMImAgZ3JvdXAuCgpgYGB7cn0KVHJlYXRfdG90YWwgPC0KICBwZXJjZW50cyAlPiUKICBmaWx0ZXIoZGF0YV90eXBlID09ICJ0cmVhdG1lbnQiLCAKICAgICAgICAgRGVtb2dyYXBoaWMgPT0gIlRPVEFMIikgJT4lCiAgbXV0YXRlKERlbW9ncmFwaGljID0gcmVjb2RlKERlbW9ncmFwaGljLCAKICAgICAgICAgICAgICJUT1RBTCIgPSAiUGVyY2VudCBvZiBNREUgcmVzcG9uZGVudHMgd2l0aCB0cmVhdG1lbnQiKSkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IFBlcmNlbnQsIGdyb3VwID0gRGVtb2dyYXBoaWMpKSArCiAgICBnZW9tX3JlY3QoeG1pbiA9IDIwMTEsIHhtYXggPSBJbmYsICAKICAgICAgICAgICAgICB5bWluID0gLUluZiwgeW1heCA9IEluZiwgICAKICAgICAgICAgICAgICBmaWxsID0gImxpZ2h0IGdyYXkiKSArCiAgICBnZW9tX2xpbmUoYWVzKGNvbG9yID0gRGVtb2dyYXBoaWMpLCBzaXplID0gMS41KSArCiAgICBmYWNldF93cmFwKH5EZW1vZ3JhcGhpYykrCiAgICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDIwMDQsIDIwMTgsIGJ5PTEpLAogICAgICAgICAgICAgICAgICAgICAgIGxhYmVscyA9IHNlcSgyMDA0LCAyMDE4LCBieT0xKSwKICAgICAgICAgICAgICAgICAgICAgICBsaW1pdHMgPSBjKDIwMDQsIDIwMTgpKSArCiAgICBsYWJzKHRpdGxlID0gIlRoZSBSYXRlIG9mIFlvdXRocyBBZ2VkIDEyIHRvIDE3IFJlY2VpdmluZyBUcmVhdG1lbnQgYWZ0ZXJcblJlcG9ydGluZyBIYXZpbmcgYSBNYWpvciBEZXByZXNzaXZlIEVwaXNvZGUgaXMgSW5jcmVhc2luZyIpKwogICAgb3ZlcnZpZXdfdGhlbWUoKSsKICAgIHNjYWxlX2NvbG9yX21hbnVhbCh2YWx1ZXMgPSBjKCJyZWQiKSkKClRyZWF0X3RvdGFsCmBgYAoKT3ZlcmFsbCwgcm91Z2hseSA0MCBwZXJjZW50IG9mIHlvdXRocyB3aG8gc2VsZi1yZXBvcnRlZCBleHBlcmllbmNpbmcgYSBtYWpvciBkZXByZXNzaXZlIGVwaXNvZGUsIGFsc28gcmVjZWl2ZWQgdHJlYXRtZW50IGZvciBkZXByZXNzaW9uLiBUaGlzIHJhdGUgY291bGQgZGVmaW5pdGVseSBiZSBpbXByb3ZlZC4KClRoaXMgcmF0ZSBpcyBpbmNyZWFzaW5nIG92ZXIgdGltZSBsaWtlIHRoZSB0cmVuZCBvZiB0aG9zZSB3aG8gaGFkIGEgbWFqb3IgZGVwcmVzc2l2ZSBlcGlzb2RlLCB5ZXQgdGhlIGRhdGEgYXJlIG11Y2ggbW9yZSB2YXJpYWJsZSBmcm9tIG9uZSB5ZWFyIHRvIHRoZSBuZXh0LiAKCk5leHQsIHdlIGNvbnNpZGVyIGRpZmZlcmVuY2VzIGJldHdlZW4gbWFsZXMgYW5kIGZlbWFsZXMgYW5kIGRpZmZlcmVudCBhZ2UgZ3JvdXBzLiAKCmBgYHtyfQp0cmVhdCA8LSAKICBwZXJjZW50cyAlPiUKICBmaWx0ZXIoZGF0YV90eXBlID09ICJ0cmVhdG1lbnQiLCAKICAgICAgICAgc3ViZ3JvdXAgIT0gIlJhY2UvRXRobmljaXR5IiwgCiAgICAgICAgIHN1Ymdyb3VwICE9ICJUb3RhbCIpICU+JQogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBQZXJjZW50LCBjb2xvciA9IERlbW9ncmFwaGljKSkgKwogICAgZ2VvbV9saW5lKHNpemUgPSAxKSArCiAgICBmYWNldF93cmFwKH5zdWJncm91cCkrCiAgICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDIwMDQsIDIwMTgsIGJ5PTEpLAogICAgICAgICAgICAgICAgICAgICAgIGxhYmVscyA9IHNlcSgyMDA0LCAyMDE4LCBieT0xKSwKICAgICAgICAgICAgICAgICAgICAgICBsaW1pdHMgPSBjKDIwMDQsIDIwMTgpKSArIAogICAgbGFicyh0aXRsZSA9ICJSZWNlaXB0IG9mIFRyZWF0bWVudCBmb3IgRGVwcmVzc2lvbiBhbW9uZ1xuUGVyc29ucyBBZ2VkIDEyIHRvIDE3IHdpdGggTWFqb3IgRGVwcmVzc2l2ZSBFcGlzb2RlIiwKICAgICAgICAgc3VidGl0bGUgPSAiQnkgRGVtb2dyYXBoaWMgQ2hhcmFjdGVyaXN0aWNzOiBQZXJjZW50YWdlcywgMjAwNC0yMDE4IikrCiAgICB0aGVtZV9saW5lZHJhdygpICsKICAgIHRoZW1lKHN0cmlwLnRleHQgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDE0LCBmYWNlID0gImJvbGQiKSwKICAgICAgICAgIGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gOTApKSAKCnRyZWF0IDwtIGRpcmVjdC5sYWJlbCgKICB0cmVhdCwgCiAgbGlzdChkbC50cmFucyh5ID0geSAtMS41LCB4ID0geCAtMC40KSwKICAgICAgICJmYXIuZnJvbS5vdGhlcnMuYm9yZGVycyIsIAogICAgICAgY2V4ID0gLjgsIAogICAgICAgZGwubW92ZSgiQWdlXzE2LTE3IiwgeCA9IDIwMTAsIHkgPSA0MiksCiAgICAgICBkbC5tb3ZlKCJBZ2VfMTQtMTUiLCB4ID0gMjAxNSwgeSA9IDM4KSkpCnRyZWF0CmBgYAoKVGhlcmUgc2VlbXMgdG8gYmUgYW4gdXB3YXJkIHRyZW5kLCBidXQgaXQgaXNuJ3QgbmVhcmx5IGFzIG11Y2ggYXMgdGhlIHRyZW5kIHdlIHNhdyBmb3IgdGhlIGluY3JlYXNlIG9mIG1ham9yIGRlcHJlc3NpdmUgZXBpc29kZXMuIEluIGdlbmVyYWwsIHRoZSBkYXRhIHNlZW1zIHRvIHZhcnkgbXVjaCBtb3JlIGFzIHdlbGwuCgoKIyMjIyB7LnF1ZXN0aW9uX2Jsb2NrfQo8Yj48dT4gUXVlc3Rpb24gT3Bwb3J0dW5pdHkgPC91PjwvYj4KCkNyZWF0ZSBhIHNpbWlsYXIgcGxvdCBvbiB5b3VyIG93biBmb3IgdGhlIGRpZmZlcmVudCByYWNlIC8gZXRobmljIGdyb3Vwcy4gCgojIyMjCgo8ZGV0YWlscz4gPHN1bW1hcnk+IENsaWNrIGhlcmUgdG8gcmV2ZWFsIHRoZSBjb2RlLiA8L3N1bW1hcnk+CgpgYGB7cn0KUmFjZV90cmVhdCA8LXBlcmNlbnRzICU+JQogIGZpbHRlcihkYXRhX3R5cGUgPT0gInRyZWF0bWVudCIpICU+JQogIGZpbHRlcihzdWJncm91cCA9PSAiUmFjZS9FdGhuaWNpdHkiKSAlPiUKICBtdXRhdGUoRGVtb2dyYXBoaWMgPSAKICAgICAgICAgICBmY3RfcmVvcmRlcihEZW1vZ3JhcGhpYywgUGVyY2VudCwgCiAgICAgICAgICAgICAgICAgICAgICAgdGFpbCwgbiA9IDEsIC5kZXNjID0gVFJVRSkpICU+JQogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBQZXJjZW50LCBjb2xvciA9IERlbW9ncmFwaGljKSkgKwogICAgZ2VvbV9saW5lKHNpemUgPTEpICsKICAgIGZhY2V0X3dyYXAofiBzdWJncm91cCkgKwogICAgc2NhbGVfeF9jb250aW51b3VzKGJyZWFrcyA9IHNlcSgyMDA5LCAyMDE4LCBieT0xKSwKICAgICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBzZXEoMjAwOSwgMjAxOCwgYnk9MSksCiAgICAgICAgICAgICAgICAgICAgICAgbGltaXRzID0gYygyMDA5LCAyMDE4KSkgKwogICAgbGFicyh0aXRsZSA9ICJSZWNlaXB0IG9mIFRyZWF0bWVudCBmb3IgRGVwcmVzc2lvbiBhbW9uZ1xuUGVyc29ucyBBZ2VkIDEyIHRvIDE3IHdpdGggTWFqb3IgRGVwcmVzc2l2ZSBFcGlzb2RlIiwKICAgICAgICAgc3VidGl0bGUgPSAiQnkgRGVtb2dyYXBoaWMgQ2hhcmFjdGVyaXN0aWNzOiBQZXJjZW50YWdlcywgMjAwNC0yMDE4IikrCiAgICB0aGVtZV9saW5lZHJhdygpICsKICAgIHRoZW1lKHN0cmlwLnRleHQgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDE0LCBmYWNlID0gImJvbGQiKSwKICAgICAgICAgIGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gOTApKSArCiAgICBzY2FsZV9jb2xvcl92aXJpZGlzX2QoKQpgYGAKPC9kZXRhaWxzPgoKYGBge3IsIGVjaG89RkFMU0V9ClJhY2VfdHJlYXQKYGBgCgpJdCBsb29rcyBhcyB0aG91Z2ggeW91dGhzIHdobyByZXBvcnQgYXMgYmVpbmcgd2hpdGUgcmVjZWl2ZWQgdGhlIG1vc3QgY2FyZSBmcm9tIG1lbnRhbCBoZWFsdGggc2VydmljZXMuCgoKIyMjIE1lbnRhbCBIZWFsdGggU2VydmljZXMKCldlIHdpbGwgYWxzbyB0YWtlIGEgbG9vayBhdCB3aGVyZSB5b3V0aHMgYXJlIHJlY2VpdmluZyB0cmVhdG1lbnQgYnkgdXNpbmcgdmFsdWVzIGZyb20gYHRhYmxlMTEuMWJgIHdoaWNoIGhhcyB0aGUgcGVyY2VudGFnZSB2YWx1ZXMgZm9yIGNvdW50cyBwcmVzZW50ZWQgaW4gYHRhYmxlMTEuMWFgLgoKV2UgY2FuIHVzZSB0aGUgYHN0cl9kZXRlY3QoKWAgZnVuY3Rpb24gb2YgdGhlIGBzdHJpbmdyYCBwYWNrYWdlIHRvIGZpbHRlciBmb3IgdGhlIHZhbHVlcyBvZiB0aGUgYHNob3J0X2xhYmVsYCB2YXJpYWJsZSB0aGF0IGhhcyB0aGUgd29yZCBgdG90YWxgIGluIGl0LiAKCmBgYHtyfQpwbG90TUhTIDwtIAogIHRhYmxlMTEuMWIgJT4lCiAgZmlsdGVyKHN0cmluZ3I6OnN0cl9kZXRlY3Qoc2hvcnRfbGFiZWwsICJ0b3RhbCIpICkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IFBlcmNlbnQsIAogICAgICAgICAgICAgZ3JvdXAgPSBNSFNfc2V0dGluZywgY29sb3IgPSBzaG9ydF9sYWJlbCkpICsKICAgIGdlb21fbGluZShzaXplID0gMSkgKwogICAgZmFjZXRfd3JhcCh+IHR5cGUpICsKICAgIHNjYWxlX3hfY29udGludW91cyhicmVha3MgPSBzZXEoMjAwOSwgMjAxOCwgYnk9MSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxzID0gc2VxKDIwMDksIDIwMTgsIGJ5PTEpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbWl0cyA9IGMoMjAwOSwgMjAxOCkpICsKICAgIGxhYnModGl0bGUgPSAiU2V0dGluZ3MgV2hlcmUgTWVudGFsIEhlYWx0aCBTZXJ2aWNlcyBXZXJlIFJlY2VpdmVkXG5hbW9uZyBQZXJzb25zIEFnZWQgMTIgdG8gMTciLAogICAgICAgICBzdWJ0aXRsZSA9ICJQZXJjZW50YWdlcywgMjAwMi0yMDE4IikgKwogICAgdGhlbWVfbGluZWRyYXcoKSArCiAgICB0aGVtZShzdHJpcC50ZXh0ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxNCwgZmFjZSA9ICJib2xkIiksCiAgICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDkwKSkgCgpwbG90TUhTIDwtIGRpcmVjdC5sYWJlbCgKICBwbG90TUhTLCAKICBsaXN0KGRsLnRyYW5zKHkgPSB5ICswLjM1LCB4ID0geCAtMC4xKSwKICAgICAgICJmYXIuZnJvbS5vdGhlcnMuYm9yZGVycyIsIAogICAgICAgY2V4ID0gLjgsIAogICAgICAgZGwubW92ZSgiT3V0cGF0aWVudCB0b3RhbCIsIHggPSAyMDE1LCB5ID0xMSkpCiAgKQpwbG90TUhTCmBgYAoKV2UgY2FuIHNlZSB0aGF0IHlvdXRocyBhcHBlYXIgdG8gYmUgcmVjZWl2aW5nIGNhcmUgaW4gbm9uc3BlY2lhbHR5IGZhY2lsaXRpZXMgYXQgYSBzbGlnaHRseSBoaWdoZXIgcmF0ZSB0aGFuIHRoYXQgb2Ygc3BlY2lhbHR5IGZhY2lsaXRpZXMuIApIb3dldmVyLCB0aGUgcmF0ZXMgYXBwZWFyIHRvIGJlIHZlcnkgc2ltaWxhciBhbmQgdGhlIHJlbGF0aXZlIGRpZmZlcmVuY2VzIGFwcGVhciB0byBiZSBjb25zaXN0ZW50IGFjcm9zcyB0aW1lLgoKTGV0J3MgdGFrZSBhIGxvb2sgYXQgc3ViY2F0ZWdvcmllcyBvZiBtZW50YWwgaGVhbHRoIHNlcnZpY2VzLgpUbyBkbyB0aGlzLCB3ZSB3aWxsIGZpbHRlciBmb3IgdmFsdWVzIHdpdGhpbiB0aGUgYHNob3J0X2xhYmVsYCB2YXJpYWJsZSB0aGF0IGRvIG5vdCBjb250YWluIHRoZSB3b3JkICJ0b3RhbCIgYnkgdXNpbmcgYSBgIWAgaW4gZnJvbnQgb2YgdGhlIGBzdHJfZGVjdGVjdGAgc3RhdGVtZW50LgoKYGBge3J9CnBsb3RNSFNTIDwtIAogIHRhYmxlMTEuMWIgJT4lCiAgZmlsdGVyKCFzdHJfZGV0ZWN0KHNob3J0X2xhYmVsLCAidG90YWwiKSkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IFBlcmNlbnQsIAogICAgICAgICBncm91cCA9IE1IU19zZXR0aW5nLCBjb2xvciA9IHNob3J0X2xhYmVsKSkgKwogICAgZ2VvbV9saW5lKHNpemUgPSAxKSArCiAgICBmYWNldF93cmFwKH4gdHlwZSkgKwogICAgc2NhbGVfeF9jb250aW51b3VzKGJyZWFrcyA9IHNlcSgyMDAyLCAyMDE5LCBieT0xKSwKICAgICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBzZXEoMjAwMiwgMjAxOSwgYnk9MSksCiAgICAgICAgICAgICAgICAgICAgICAgbGltaXRzID0gYygyMDAyLCAyMDE5KSkgKwogICAgbGFicyh0aXRsZSA9ICJTZXR0aW5ncyBXaGVyZSBNZW50YWwgSGVhbHRoIFNlcnZpY2VzIFdlcmUgUmVjZWl2ZWRcbmFtb25nIFBlcnNvbnMgQWdlZCAxMiB0byAxNyIsCiAgICAgICAgIHN1YnRpdGxlID0gIlBlcmNlbnRhZ2VzLCAyMDAyLTIwMTgiKSsKICAgIHRoZW1lX2xpbmVkcmF3KCkgKwogICAgdGhlbWUoc3RyaXAudGV4dCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTQsIGZhY2UgPSAiYm9sZCIpLAogICAgICAgICAgYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA5MCkpIAoKcGxvdE1IU1MgPC0gZGlyZWN0LmxhYmVsKAogIHBsb3RNSFNTLCAKICBsaXN0KGRsLnRyYW5zKHkgPSB5ICswLjMpLAogICAgICAgImZhci5mcm9tLm90aGVycy5ib3JkZXJzIiwgCiAgICAgICBkbC5tb3ZlKCJTY2hvb2wgVGhlcmFwaXN0IiwgMjAxMCwgMTApLCAKICAgICAgIGRsLm1vdmUoIkZvc3RlcmNhcmUiLCAyMDEwLCAxKSwgCiAgICAgICBkbC5tb3ZlKCJUaGVyYXBpc3QiLCB4PTIwMDksIHkgPSAxMC41KSkKICApCnBsb3RNSFNTCmBgYApJdCBsb29rcyBsaWtlIG1vc3QgeW91dGhzIGFyZSByZWNlaXZpbmcgY2FyZSBmcm9tIGVpdGhlciBhIHRoZXJhcGlzdCBvciBhIHNjaG9vbCB0aGVyYXBpc3QuCgpPSywgc28gbm93IHdlIGtub3cgaG93IHRoZSByYXRlcyBvZiBkaWZmZXJlbnQgc3ViZ3JvdXBzIGNvbXBhcmUgZm9yIGhhdmluZyBhIE1ERSBpbiB0aGUgcGFzdCB5ZWFyLCBoYXZpbmcgYSBNREUgd2l0aCBzZXZlcmUgaW1wYWlybWVudCwgYW5kIHJlY2VpdmluZyB0cmVhdG1lbnQgYWZ0ZXIgYSBNREUuIApXZSBhbHNvIGtub3cgd2hlcmUgeW91dGhzIGFyZSB0eXBpY2FsbHkgZ2V0dGluZyB0cmVhdG1lbnQuIApCdXQsIGhvdyBkbyB0aGUgcmF0ZXMgb2YgaGF2aW5nIGEgTURFIGluIHRoZSBwYXN0IHllYXIsIGhhdmluZyBhIE1ERSB3aXRoIHNldmVyZSBpbXBhaXJtZW50LCBhbmQgcmVjZWl2aW5nIHRyZWF0bWVudCBjb21wYXJlIHdpdGhpbiBlYWNoIHN1Ymdyb3VwIChlLmcuIGp1c3QgZmVtYWxlcyk/CgpUaGlzIGlzIHdoYXQgd2UgdGFja2xlIGluIHRoZSBuZXh0IHNlY3Rpb24uIAoKIyMjIE92ZXJhbGwgb3V0Y29tZXMgYnkgZ3JvdXAKCkluIHRoZSBuZXh0IHBsb3QsIHdlIGZpcnN0IGZpbHRlciBmb3IgYE1hbGVgLCBgRmVtYWxlYCBhbmQgYFRvdGFsYCBhbmQgdGhlbiBmYWNldCBieSB0aGUgYERlbW9ncmFwaGljYCB2YXJpYWJsZS4gCgpgYGB7cn0Kc2V4X291dGNvbWVzIDwtIAogIHBlcmNlbnRzICU+JQogIGZpbHRlcihEZW1vZ3JhcGhpYyAlaW4lIGMoIk1hbGUiLCAiRmVtYWxlIiwgIlRPVEFMIikpICU+JQogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBQZXJjZW50LCBjb2xvciA9IERlbW9ncmFwaGljKSkgKwogICAgZ2VvbV9saW5lKGFlcyhsaW5ldHlwZSA9IGRhdGFfdHlwZSksIHNpemUgPSAxKSArCiAgICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDIwMDQsIDIwMTgsIGJ5PTEpLAogICAgICAgICAgICAgICAgICAgICAgIGxhYmVscyA9IHNlcSgyMDA0LCAyMDE4LCBieT0xKSwKICAgICAgICAgICAgICAgICAgICAgICBsaW1pdHMgPSBjKDIwMDQsIDIwMTgpKSArCiAgICBsYWJzKHRpdGxlID0gIk1ham9yIERlcHJlc3NpdmUgRXBpc29kZSBhbW9uZyBQZXJzb25zIEFnZWQgMTIgdG8gMTciLAogICAgICAgICBzdWJ0aXRsZSA9ICJCeSBEZW1vZ3JhcGhpYyBDaGFyYWN0ZXJpc3RpY3MsIFBlcmNlbnRhZ2VzLCAyMDA0LTIwMTgiKSArCiAgICBmYWNldF93cmFwKH4gRGVtb2dyYXBoaWMsIHN0cmlwLnBvc2l0aW9uID0gInRvcCIpICsKICAgIHRoZW1lX2xpbmVkcmF3KCkgKwogICAgdGhlbWUoc3RyaXAudGV4dCA9IGVsZW1lbnRfdGV4dChzaXplID0gOCwgZmFjZSA9ICJib2xkIiksCiAgICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDkwKSwKICAgICAgICAgIGxlZ2VuZC50aXRsZSA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICAgIGxlZ2VuZC5wb3NpdGlvbiA9ICJib3R0b20iKSArCiAgICBndWlkZXMoY29sb3IgPSBGQUxTRSkKCnNleF9vdXRjb21lcyAKYGBgCgpXZSBjYW4gc2VlIHRoYXQgYSBsYXJnZSBwb3J0aW9uIG9mIGluZGl2aWR1YWxzIGV4cGVyaWVuY2luZyBhIG1ham9yIGRlcHJlc3NpdmUgZXBpc29kZSBoYXZlIGFuIGVwaXNvZGUgd2l0aCBzZXZlcmUgaW1wYWlybWVudCBmb3IgZWFjaCBncm91cC4gCkZlbWFsZXMgaGF2ZSBhIGhpZ2hlciByYXRlIG9mIGJvdGggdHlwZXMgb2YgZXBpc29kZSBhbmQgb2YgdHJlYXRtZW50LiAKQWx0aG91Z2ggZmVtYWxlcyBoYXZlIG1vcmUgdGhhbiBkb3VibGUgdGhlIHJhdGUgb2YgcmVwb3J0ZWQgZXBpc29kZXMsIHRoZXkgcmVjZWl2ZSBhIHJlbGF0aXZlbHkgc2ltaWxhciByYXRlIG9mIHRyZWF0bWVudCBhcyBtYWxlcyBmb3IgZGVwcmVzc2lvbi4gClRoaXMgc3VnZ2VzdHMgdGhhdCBmZW1hbGVzIGFyZSBlaXRoZXIgbW9yZSBsaWtlbHkgdGhhbiBtYWxlcyB0byBzZWxmLXJlcG9ydCBkZXByZXNzaW9uIHN5bXB0b21zIGluIHN1cnZleXMsIG9yIGZlbWFsZXMgbWF5IG5vdCBiZSByZWNlaXZpbmcgYXMgbXVjaCBjYXJlIGRlc3BpdGUgdGhlIGxhcmdlciBuZWVkLiAKCiMjIyMgey5xdWVzdGlvbl9ibG9ja30KPGI+PHU+IFF1ZXN0aW9uIE9wcG9ydHVuaXR5IDwvdT48L2I+CgpDcmVhdGUgYSBzaW1pbGFyIHBsb3Qgb24geW91ciBvd24gZm9yIGRpZmZlcmVudCBhZ2UgZ3JvdXBzLiAKCiMjIyMKCjxkZXRhaWxzPiA8c3VtbWFyeT4gQ2xpY2sgaGVyZSB0byByZXZlYWwgdGhlIGNvZGUuIDwvc3VtbWFyeT4KCmBgYHtyfQphZ2Vfb3V0Y29tZXMgPC0KICBwZXJjZW50cyAlPiUKICBmaWx0ZXIoc3ViZ3JvdXAgPT0gIkFnZSIpICU+JQogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBQZXJjZW50LCBjb2xvciA9IERlbW9ncmFwaGljKSkgKwogICAgZ2VvbV9saW5lKGFlcyhsaW5ldHlwZT0gZGF0YV90eXBlKSwgc2l6ZSA9IDEpICsKICAgIHNjYWxlX3hfY29udGludW91cyhicmVha3MgPSBzZXEoMjAwNCwgMjAxOCwgYnk9MSksCiAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxzID0gc2VxKDIwMDQsIDIwMTgsIGJ5PTEpLAogICAgICAgICAgICAgICAgICAgICAgIGxpbWl0cyA9IGMoMjAwNCwgMjAxOCkpICsKICAgIGxhYnModGl0bGUgPSAiTWFqb3IgRGVwcmVzc2l2ZSBFcGlzb2RlXG5hbW9uZyBQZXJzb25zIEFnZWQgMTIgdG8gMTciLAogICAgICAgICBzdWJ0aXRsZSA9ICJCeSBEZW1vZ3JhcGhpYyBDaGFyYWN0ZXJpc3RpY3MsIFBlcmNlbnRhZ2VzLCAyMDA0LTIwMTgiKSArCiAgICBmYWNldF93cmFwKH4gRGVtb2dyYXBoaWMsIHN0cmlwLnBvc2l0aW9uID0gInRvcCIpKwogICAgdGhlbWVfbGluZWRyYXcoKSArCiAgICB0aGVtZShzdHJpcC50ZXh0ID0gZWxlbWVudF90ZXh0KHNpemUgPSA4LCBmYWNlID0gImJvbGQiKSwKICAgICAgICAgIGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gOTApLAogICAgICAgICAgbGVnZW5kLnRpdGxlID0gZWxlbWVudF9ibGFuaygpLAogICAgICAgICAgbGVnZW5kLnBvc2l0aW9uID0gImJvdHRvbSIpKwogICAgZ3VpZGVzKGNvbG9yID0gRkFMU0UpCmBgYAoKPC9kZXRhaWxzPiAKCmBgYHtyLCBlY2hvPUZBTFNFfQphZ2Vfb3V0Y29tZXMKYGBgCgpBbGwgYWdlIGdyb3VwcyBzaG93IGEgc2ltaWxhciByYXRpbyBvZiBzZXZlcmUgbWFqb3IgZGVwcmVzc2l2ZSBlcGlzb2RlcyBmb3IgdGhvc2UgdGhhdCBleHBlcmllbmNlZCBhbiBlcGlzb2RlLiAKCiMjIyMgey5xdWVzdGlvbl9ibG9ja30KPGI+PHU+IFF1ZXN0aW9uIE9wcG9ydHVuaXR5IDwvdT48L2I+CgpDcmVhdGUgYSBzaW1pbGFyIHBsb3Qgb24geW91ciBvd24gZm9yIHRoZSBkaWZmZXJlbnQgcmFjZSAvIGV0aG5pYyBncm91cHMuIAoKIyMjIwoKPGRldGFpbHM+IDxzdW1tYXJ5PiBDbGljayBoZXJlIHRvIHJldmVhbCB0aGUgY29kZS4gPC9zdW1tYXJ5PgoKYGBge3J9CnJhY2Vfb3V0Y29tZXMgPC0KICBwZXJjZW50cyAlPiUKICBmaWx0ZXIoc3ViZ3JvdXAgPT0gIlJhY2UvRXRobmljaXR5IiwgCiAgICAgICAgIERlbW9ncmFwaGljICE9ICJOSE9QSSIpICU+JQogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBQZXJjZW50LCBjb2xvciA9IERlbW9ncmFwaGljKSkgKwogICAgZ2VvbV9saW5lKGFlcyhsaW5ldHlwZSA9IGRhdGFfdHlwZSksIHNpemU9MSkgKwogICAgc2NhbGVfeF9jb250aW51b3VzKGJyZWFrcyA9IHNlcSgyMDA0LCAyMDE4LCBieT0xKSwKICAgICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBzZXEoMjAwNCwgMjAxOCwgYnk9MSksCiAgICAgICAgICAgICAgICAgICAgICAgbGltaXRzID0gYygyMDA0LCAyMDE4KSkgKwogICAgbGFicyh0aXRsZSA9ICJNYWpvciBEZXByZXNzaXZlIEVwaXNvZGVcbmFtb25nIFBlcnNvbnMgQWdlZCAxMiB0byAxNyIsCiAgICAgICAgIHN1YnRpdGxlID0gIkJ5IERlbW9ncmFwaGljIENoYXJhY3RlcmlzdGljcywgUGVyY2VudGFnZXMsIDIwMDQtMjAxOCIpICsKICAgIGZhY2V0X3dyYXAofiBEZW1vZ3JhcGhpYywgc3RyaXAucG9zaXRpb24gPSAidG9wIiwgbnJvdyA9IDQpICsKICAgIHRoZW1lX2xpbmVkcmF3KCkgKwogICAgdGhlbWUoc3RyaXAudGV4dCA9IGVsZW1lbnRfdGV4dChzaXplID0gOCwgZmFjZSA9ICJib2xkIiksCiAgICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDkwKSwKICAgICAgICAgIGxlZ2VuZC50aXRsZSA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICAgIGxlZ2VuZC5wb3NpdGlvbiA9ICJib3R0b20iKSsKICAgIGd1aWRlcyhjb2xvciA9IEZBTFNFKQpgYGAKPC9kZXRhaWxzPgoKYGBge3IsIGVjaG89RkFMU0UsIGZpZy5oZWlnaHQ9MTB9CnJhY2Vfb3V0Y29tZXMKYGBgCgpBbGwgcmFjaWFsIGFuZCBldGhuaWMgZ3JvdXBzIGFsc28gc2hvdyBhIHNpbWlsYXIgcmF0ZSBvZiBzZXZlcmUgZXBpc29kZXMgcmVsYXRpdmUgdG8gZ2VuZXJhbCBlcGlzb2RlIHJhdGUuIApUaGUgcmF0ZSBvZiByZWNlaXZpbmcgdHJlYXRtZW50IGlzIGZhaXJseSBzaW1pbGFyIHJlbGF0aXZlIHRvIHRoZSBwZXJjZW50YWdlIG9mIHlvdXRocyB0aGF0IHJlcG9ydGVkIGhhdmluZyBzeW1wdG9tcyBmb3IgZWFjaCBncm91cC4KCgojIyAqKkRhdGEgQW5hbHlzaXMqKgoqKiogCgpgYGB7ciwgZWNobyA9IEZBTFNFfQpsb2FkKGZpbGUgPSBoZXJlOjpoZXJlKCJkYXRhIiwgIndyYW5nbGVkX2RhdGEucmRhIikpCmBgYApSZWNhbGwgd2hhdCBvdXIgbWFpbiBxdWVzdGlvbnMgd2VyZToKCiMjIyMgey5tYWluX3F1ZXN0aW9uX2Jsb2NrfQo8Yj48dT4gT3VyIG1haW4gcXVlc3Rpb25zOiA8L3U+PC9iPgoKMS4gSG93IGhhdmUgZGVwcmVzc2lvbiByYXRlcyBpbiBBbWVyaWNhbiB5b3V0aCBjaGFuZ2VkIHNpbmNlIDIwMDQsIGFjY29yZGluZyB0byB0aGUgTlNEVUggZGF0YT8gIEhvdyBoYXZlIHJhdGVzIGRpZmZlcmVkIGJldHdlZW4gZGlmZmVyZW50IHlvdXRoIHN1Ymdyb3VwcyAoYWdlLCBnZW5kZXIsIGV0aG5pY2l0eSk/CjIuIERvIG1lbnRhbCBoZWFsdGggc2VydmljZXMgYXBwZWFyIHRvIGJlIHJlYWNoaW5nIG1vcmUgeW91dGhzPyBBZ2FpbiwgaG93IGhhdmUgcmF0ZXMgZGlmZmVyZWQgYmV0d2VlbiBkaWZmZXJlbnQgeW91dGggc3ViZ3JvdXBzIChhZ2UsIGdlbmRlciwgZXRobmljaXR5KT8KCiMjIyMKCldlIGFyZSBzcGVjaWZpY2FsbHkgaW50ZXJlc3RlZCBpbiBob3cgdGhlIGZyZXF1ZW5jeSBvZiByZWNlbnQgbWFqb3IgZGVwcmVzc2l2ZSBlcGlzb2RlcyBhbW9uZyB5b3V0aHMgZGlmZmVyIGNvbXBhcmVkIHRvIHRob3NlIGluIDIwMDQuIApXZSBhcmUgYWxzbyBpbnRlcmVzdGVkIGhvdyBkaWZmZXJlbnQgc3ViZ3JvdXBzIGRpZmZlci4gCldlIHdpbGwgc3RhcnQgd2l0aCBleGFtaW5pbmcgaG93IG1hbGUgYW5kIGZlbWFsZXMgZGlmZmVyIGFjcm9zcyB0aW1lLgoKU2luY2Ugd2UgaGF2ZSBjb3VudHMgZm9yIHRoZSB0d28gc2V4ZXM6IG1hbGVzIGFuZCBmZW1hbGVzLCBhbmQgZm9yIHRoZSB0d28geWVhcnMgb2YgaW50ZXJlc3QsIDIwMDQgYW5kIDIwMTgsIHdlIGNhbiBjb25kdWN0IGEgW1BlYXJzb24ncyBjaGktc3F1YXJlZCB0ZXN0XShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9QZWFyc29uJTI3c19jaGktc3F1YXJlZF90ZXN0Izp+OnRleHQ9UGVhcnNvbidzJTIwY2hpJTJEc3F1YXJlZCUyMHRlc3QlMjBpcyxkaWZmZXJzJTIwZnJvbSUyMGElMjB0aGVvcmV0aWNhbCUyMGRpc3RyaWJ1dGlvbi4pe3RhcmdldD0iX2JsYW5rIn0gZm9yICoqaW5kZXBlbmRlbmNlKiosIHdoaWNoIGlzIGFsc28gd3JpdHRlbiBsaWtlIHRoaXM6ICR7XGNoaX1eMiQuIAoKVGhpcyB3aWxsIGFsbG93IHVzIHRvIGNvbXBhcmUgaWYgdGhlIGZyZXF1ZW5jaWVzIG9mIG1ham9yIGRlcHJlc3NpdmUgZXBpc29kZXMgZGlmZmVycyBmcm9tIHdoYXQgd2Ugd291bGQgZXhwZWN0IGJ5IGNoYW5jZSBpZiB0aGUgdmFyaWFibGVzIHllYXJzIGFuZCBzZXggd2VyZSBpbmRlcGVuZGVudC4KClRoZSBudWxsIGh5cG90aGVzaXMgaXMgdGhhdCB0aGUgdmFyaWFibGVzIGFyZSBpbmRlcGVuZGVudCBvciB0aGF0IHRoZSAgZGlmZmVyZW5jZSBpbiB0aGUgcHJvcG9ydGlvbnMgaXMgZXF1YWwgdG8gemVyby4gClRodXMsIHdlIHdhbnQgdG8gdGVzdCBpZiBzZXggYW5kIHllYXIgYXJlIGluZGVwZW5kZW50LiBJbiBvdGhlciB3b3Jkcywgd2Ugd2FudCB0byBrbm93IGlmIHNleCBpbmZsdWVuY2VzIHRoZSBudW1iZXIgb2YgbWFqb3IgZGVwcmVzc2l2ZSBlcGlzb2RlcyBpbiAyMDA0IGFuZCAyMDE4LiBPciBzdGF0ZWQgeWV0IGFub3RoZXIgd2F5OiBfYXJlIG1ham9yIGRlcHJlc3NpdmUgZXBpc29kZSBjb3VudHMgYWNyb3NzIHRoZSB0d28geWVhcnMgYXNzb2NpYXRlZCB3aXRoIHNleD9fICAKCgoKQWNjb3JkaW5nIHRvIFt3aWtpcGVkaWFdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0NoaS1zcXVhcmVkX3Rlc3Q/b2xkZm9ybWF0PXRydWUpe3RhcmdldD0iX2JsYW5rIn06IAoKPiBQZWFyc29uJ3MgY2hpLXNxdWFyZSB0ZXN0IGlzIHVzZWQgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlcmUgaXMgYSBzdGF0aXN0aWNhbGx5IHNpZ25pZmljYW50IGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUgKipleHBlY3RlZCBmcmVxdWVuY2llcyoqIGFuZCB0aGUgKipvYnNlcnZlZCBmcmVxdWVuY2llcyoqIGluIG9uZSBvciBtb3JlICoqY2F0ZWdvcmllcyoqIG9mIGEgW2NvbnRpbmdlbmN5IHRhYmxlXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Db250aW5nZW5jeV90YWJsZSl7dGFyZ2V0PSJfYmxhbmsifS4KCgpUaHVzLCB0byBjb25kdWN0IHRoaXMgc3RhdGlzdGljYWwgdGVzdCwgd2UgZmlyc3QgbmVlZCB0byBjcmVhdGUgYSBbY29udGluZ2VuY3kgdGFibGVdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0NvbnRpbmdlbmN5X3RhYmxlKXt0YXJnZXQ9Il9ibGFuayJ9LCB3aGljaCBpbiB0aGlzIGNhc2UgY291bGQgYWxzbyBiZSBjYWxsZWQgYSAyeDIgdGFibGUsIHdoaWNoIGlzIHRoZSBzaW1wbGVzdCBraW5kIG9mIGNvbnRpbmdlbmN5IHRhYmxlIChvbmx5IHR3byBsZXZlbHMgZm9yIHR3byB2YXJpYWJsZXMpLgoKQmVmb3JlIHdlIGNyZWF0ZSBhIGNvbnRpbmdlbmN5IHRhYmxlIGZvciBvdXIgZGF0YSBhbmQgdXNlIHRoZSBjaGktc3F1YXJlZCB0ZXN0LCBsZXQncyBwcmFjdGljZSB0aGlzIHdpdGggYSBkaWZmZXJlbnQgZXhhbXBsZS4gCgoKKioqCgpDb25zaWRlciBhIGh5cG90aGV0aWNhbCBzY2VuYXJpbyB3aGVyZSB3ZSBzYW1wbGUgMTAwIGluZGl2aWR1YWxzIGFuZCByZXBvcnQgYSBjb250aW5nZW5jeSB0YWJsZSByZXByZXNlbnRpbmcgdGhlIG51bWJlciBvZiBoeXBvdGhldGljYWwgaW5kaXZpZHVhbHMgdGhhdCB3ZSBvYnNlcnZlZCB3aG8gYXJlIGxlZnQgYW5kIHJpZ2h0IGhhbmRlZCwgc3RyYXRpZmllZCBieSBtYWxlcyBhbmQgZmVtYWxlcyAoYXNzdW1pbmcgYWxsIGluZGl2aWR1YWxzIGhhZCBiaW5hcnkgZ2VuZGVyKS4KCgpgYGB7cn0Kb2JzZXJ2ZWQgPC0gdGliYmxlKFNleCA9IGMoIk1hbGUiLCAiRmVtYWxlIiwgIlRvdGFsIiksIAogICAgICAgICAgICAgICAgICAgUmlnaHRoYW5kZWQgPSBjKDQxLDQ3LDg4KSwgCiAgICAgICAgICAgICAgICAgICBMZWZ0aGFuZGVkID0gYyg5LDMsIDEyKSwgCiAgICAgICAgICAgICAgICAgICBUb3RhbCA9IGMoNTAsNTAsMTAwKSkKb2JzZXJ2ZWQKYGBgCgpXZSBjYW4gc2VlIHRoYXQgdGhlcmUgYXJlIHR3byB2YXJpYWJsZXM6IGBTZXhgIGFuZCBgSGFuZGVkbmVzc2AgYW5kIGVhY2ggaGF2ZSB0d28gbGV2ZWxzIChgTWFsZWAgYW5kIGBGZW1hbGVgIGZvciBgU2V4YCBhbmQgcmlnaHQgYW5kIGxlZnQgZm9yIGhhbmRlZG5lc3MpLiAKVGhlIHRhYmxlIGFsc28gaW5jbHVkZXMgdG90YWxzIG9mIGVhY2ggb2YgdGhlIDQgcG9zc2libGUgZ3JvdXBzIGFzIHdlbGwgYXMgdGhlIG92ZXJhbGwgdG90YWwuCgpOZXh0LCB3ZSBjcmVhdGUgYSB0YWJsZSBvZiB3aGF0IHdlICoqZXhwZWN0KiogYXNzdW1pbmcgYFNleGAgYW5kIGBIYW5kZWRuZXNzYCBhcmUgaW5kZXBlbmRlbnQuIAoKLSBUaGUgdG90YWwgbnVtYmVyIG9mIGluZGl2aWR1YWxzIHdobyBhcmUgcmlnaHQtaGFuZGVkIGlzIDg4IG91dCBvZiAxMDAgd2hpY2ggaXMgZXF1YWwgdG8gODglLgotIFRoZSB0b3RhbCBudW1iZXIgb2YgaW5kaXZpZHVhbHMgd2hvIGFyZSBsZWZ0LWhhbmRlZCBpcyAxMiBvdXQgb2YgMTAwIHdoaWNoIGlzIGVxdWFsIHRvIDEyJS4KClRodXMsIGlmIGVhY2ggYm90aCBgTWFsZWAgYW5kIGBGZW1hbGVzYCBoYWQgdGhlIHNhbWUgYW1vdW50IG9mIHJpZ2h0LWhhbmRlZG5lc3MgYW5kIGxlZnQtaGFuZGVkbmVzcywgd2Ugd291bGQgZXhwZWN0IDg4JSBvZiB0aGUgbWFsZXMgdG8gYmUgcmlnaHQtaGFuZGVkIGFuZCAxMiUgdG8gYmUgbGVmdC1oYW5kZWQ7IGFuZAp3ZSB3b3VsZCBleHBlY3QgdGhlIGV4YWN0IHNhbWUgcHJvcG9ydGlvbnMgb2YgODglIHJpZ2h0LWhhbmRlZCBhbmQgMTIlIGxlZnQtaGFuZGVkIGZvciB0aGUgZmVtYWxlcy4KClNpbmNlIHdlIGhhdmUgNTAgbWFsZXMgYW5kIDUwIGZlbWFsZXMgYW5kIDEyJSBvZiA1MCBpcyA2IGFuZCA4OCUgb2YgNTAgaXMgNDQsIHdlIHdvdWxkIHRodXMgaGF2ZSB0aGUgZm9sbG93aW5nIHRhYmxlIG9mIGV4cGVjdGVkIGZyZXF1ZW5jaWVzOgoKYGBge3J9CmV4cGVjdGVkIDwtIHRpYmJsZShTZXggPSBjKCJNYWxlIiwgIkZlbWFsZSIsICJUb3RhbCIpLCAKICAgICAgICAgICAgICAgICAgIFJpZ2h0aGFuZGVkID0gYyg0NCw0NCw4OCksIAogICAgICAgICAgICAgICAgICAgTGVmdGhhbmRlZCA9IGMoNiw2LCAxMiksIAogICAgICAgICAgICAgICAgICAgVG90YWwgPSBjKDUwLDUwLDEwMCkpCmV4cGVjdGVkCmBgYAoKVGhlICR7XGNoaX1eMiQgdGVzdCBzdGF0aXN0aWNzIGlzIGNhbGN1bGF0ZWQgdXNpbmcgdGhlIGBvYnNlcnZlZGAgKE8pIGFuZCBgZXhwZWN0ZWRgIChFKSBmcmVxdWVuY2llcyB3ZSBqdXN0IGNhbGN1bGF0ZWQgYWJvdmUgdXNpbmcgdGhlIGZvbGxvd2luZyBmb3JtdWxhOgoKJCR7XGNoaX1eMj1cc3VtX3tqPTF9XnttfSBcZnJhY3soT19qIC0gRV9qKV4yfXtFX2p9JCQKCndoZXJlICRPX2ogPSBqXnt0aH0kIG9ic2VydmVkIGNvdW50IGFuZCAkRV9qID0gal57dGh9JCBleHBlY3RlZCBjb3VudCBmb3IKdGhlIGp0aCBjZWxsIG9mIGEgY29udGluZ2VuY3kgdGFibGUgd2l0aCAkbSQgY2VsbHMuCgpUaGUgZGVncmVlcyBvZiBmcmVlZG9tICgkZGYkKSBpcyBjYWxjdWxhdGVkIGxpa2Ugc286ICRkZj0gKHItMSkoYy0xKSQuCgpXaGVyZSAkciQgPSAjIG9mIHJvd3MgYW5kICRjJCA9IHRoZSAjIG9mIGNvbHVtbnMuCgpTbyB0byBjYWxjdWxhdGUgdGhlICR7XGNoaX1eMiQgdGVzdCBzdGF0aXN0aWNzIGZvciBoYW5kZWRuZXNzIGFuZCBzZXggbWFudWFsbHksIHdlIGNhbiBkbyB0aGUgZm9sbG93aW5nIGZvciBlYWNoIG9mIHRoZSBmb3VyIHZhbHVlcyBpbiB0aGUgdGFibGUgKGlnbm9yaW5nIHRoZSBgVG90YWxzYCkgbGlrZSB0aGlzOgoKJCR7XGNoaX1eMiA9ICBcZnJhY3soNDEtNDQpXjJ9ezQ0fSArIFxmcmFjeyg5LTYpXjJ9ezZ9KyBcZnJhY3soNDctNDQpXjJ9ezQ0fSsgXGZyYWN7KDMtNileMn17Nn0kJAoKd2hlcmUgd2UgY2FsY3VsYXRlIHRoZSBmcmFjdGlvbiBvZiB0aGUgc3F1YXJlIGRpZmZlcmVuY2Ugb2YgdGhlIG9ic2VydmVkIG1pbnVzIHRoZSBleHBlY3RlZCwgZGl2aWRlZCBieSBleHBlY3RlZCBmb3IgCgoxLiByaWdodC1oYW5kZWQgbWFsZXMKMi4gbGVmdC1oYW5kZWQgbWFsZXMKMy4gcmlnaHQtaGFuZGVkIGZlbWFsZXMKNC4gbGVmdC1oYW5kZWQgZmVtYWxlcwoKQWZ0ZXIgc3VtbWluZyB0aGVzZSBpbmRpdmlkdWFsIHRlcm1zIHRvZ2V0aGVyLCB0aGlzIGlzIGVxdWFsIHRvCgoke1xjaGl9XjIkID0gYHIgKCg0MS00NCleMikvNDQgKygoOS02KV4yKS82ICsgKCg0Ny00NCleMikvNDQgKyAoMy02KV4yLzZgCgpXaGVyZSB0aGUgZGVncmVlcyBvZiBmcmVlZG9tICA9ICRkZiA9ICg5Mi0xKSgyLTEpID0gMSQKCgpXaGF0IGRvZXMgdGhpcyBtZWFuPyBXZSBuZWVkIHRvIGNvbnN1bHQgYSBjaGktc3F1YXJlIGRpc3RyaWJ1dGlvbiB0byBkZXRlcm1pbmUgd2hhdCB0aGUgJHAkLXZhbHVlIGlzIGFuZCBpZiB0aGlzIGlzIHNpZ25pZmljYW50LgoKYGBge3IsIGVjaG8gPSBGQUxTRX0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoImh0dHBzOi8vdXBsb2FkLndpa2ltZWRpYS5vcmcvd2lraXBlZGlhL2NvbW1vbnMvOC84ZS9DaGktc3F1YXJlX2Rpc3RyaWJ1dGlvbkNERi1FbmdsaXNoLnBuZyIpCmBgYAoKIyMjIyMgW1tzb3VyY2VdXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9DaGktc3F1YXJlZF90ZXN0Iy9tZWRpYS9GaWxlOkNoaS1zcXVhcmVfZGlzdHJpYnV0aW9uQ0RGLUVuZ2xpc2gucG5nKXt0YXJnZXQ9Il9ibGFuayJ9CgpUaGlzIFt3ZWJzaXRlXShodHRwOi8vaG9tZXBhZ2UuZGl2bXMudWlvd2EuZWR1L35tYm9nbmFyL2FwcGxldHMvY2hpc3EuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSBoYXMgYSBzaW1wbGUgd2F5IHRvIGNoZWNrIHRoaXMsIHdpdGhvdXQgcmVxdWlyaW5nIHlvdSB0byBnZXQgb3V0IGEgcnVsZXIgYW5kIGNvbnN1bHQgdGhpcyBwbG90LiBOb3RlIG9uIHRoaXMgd2Vic2l0ZSB0aGUgbm90YXRpb24gZm9yICRkZiQgaXMgJHtcbnV9JC4KClBsdWdnaW5nIGluIDMuNDA5MDkxIGFzICR7XGNoaX1eMiQgYW5kIDEgYXMgJHtcbnV9JCwgd2UgZ2V0IGEgJHAkLXZhbHVlIG9mIDAuMDY0ODQuCgpUaHVzLCB3ZSBkbyBub3QgaGF2ZSBlbm91Z2ggZXZpZGVuY2UgdG8gcmVqZWN0IHRoZSBudWxsIGh5cG90aGVzaXMuClRoZXJlZm9yZSwgdXNpbmcgdGhlIGRhdGEgd2UgaGF2ZSwgd2UgZG8gbm90IGhhdmUgZXZpZGVuY2UgaW4gb3VyIGRhdGEgdG8gc3VnZ2VzdCB0aGF0IHNleCBhbmQgaGFuZGVkbmVzcyBhcmUgbm90IGluZGVwZW5kZW50LgoKU2VlIGhlcmUgZm9yIGEgbW9yZSB0aG9yb3VnaCBleHBsYW5hdGlvbiBvZiB0aGUgW2NoaS1zcXVhcmUgdGVzdF0oaHR0cHM6Ly93d3cubGluZy51cGVubi5lZHUvfmNsaWdodC9jaGlzcXVhcmVkLmh0bSl7dGFyZ2V0PSJfYmxhbmsifS4KCioqKgoKTm93IGxldCdzIGNyZWF0ZSBhIGNvbnRpbmdlbmN5IHRhYmxlIHdpdGggb3VyIG93biBkYXRhIGFuZCBzZWUgaG93IHdlIGNhbiBpbXBsZW1lbnQgdGhpcyB0ZXN0IGluIFIuCgpJdCBpcyBjcml0aWNhbCB0aGF0IHdlIHVzZSB0aGUgY291bnRzIGRhdGEsIGFuZCBub3QgdGhlIHBlcmNlbnRhZ2UgZGF0YSBmb3Igb3VyIGFuYWx5c2lzLCBhcyB0aGUgJHtcY2hpfV4yJCB0ZXN0ICoqcmVxdWlyZXMqKiBjb3VudHMuIAoKV2Ugd2lsbCBmaWx0ZXIgdGhlIGNvdW50IGRhdGEgZm9yIHRoZSBgTWFqb3JfRGVwcmVzc2l2ZV9FcGlzb2RlYCBkYXRhLCBhcyB3ZWxsIGFzIGZvciB0aGUgYE1hbGVgIGFuZCBgRmVtYWxlYCBkYXRhIGZyb20gYDIwMDRgIGFuZCBgMjAxOGAuCgpUaGUgZm9sbG93aW5nIGNvZGUgc3Vic2V0cyB0aGUgZGF0YSB3ZSBuZWVkIGFuZCBtYWtlcyB0aGUgbmVjZXNzYXJ5IG1hbmlwdWxhdGlvbnMgc28gdGhhdCB0aGUgdW5pdHMgb2Ygb2JzZXJ2YXRpb24gYXJlIGFwcHJvcHJpYXRlLiAKSWYgd2UgdGFrZSBhIGxvb2sgYXQgdGhlIHRpdGxlIG9mIHRoZSB0YWJsZSB3ZSBjYW4gc2VlIHRoYXQgdGhlIG51bWJlcnMgaW4gdGhlIHRhYmxlIHJlcHJlc2VudCBpbmRpdmlkdWFscyBieSB0aGUgdGhvdXNhbmRzLgoKYGBge3IsIGVjaG89RkFMU0V9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsICJkZW1fdGFibGUucG5nIikpCmBgYAoKYGBge3J9CmNoaV9zcXVhcmVfMTEuMmEgPC0gCiAgY291bnRzICU+JQogIGZpbHRlcihkYXRhX3R5cGUgPT0gIk1ham9yX0RlcHJlc3NpdmVfRXBpc29kZSIpICU+JQogIGZpbHRlcihZZWFyICVpbiUgYygyMDA0LCAyMDE4KSkgJT4lCiAgZmlsdGVyKERlbW9ncmFwaGljICVpbiUgYygiTWFsZSIsIkZlbWFsZSIpKSAlPiUKICBtdXRhdGUoTnVtYmVyID0gTnVtYmVyICogMTAwMCkKYGBgCgpUaGUgcmVzdWx0aW5nIG9iamVjdCBjb250YWlucyBhbGwgdGhlIHZhbHVlcyB3ZSBuZWVkIGZvciBvdXQgY29udGluZ2VuY3kgdGFibGUuIAoKYGBge3J9CmNoaV9zcXVhcmVfMTEuMmEKYGBgCgpBIGNvbnRpbmdlbmN5IHRhYmxlIGNhbiBub3cgYmUgcHJvZHVjZWQgZnJvbSB0aGlzIGRhdGEgKHdoaWNoIGN1cnJlbnRseSBpcyBpbiBsb25nIGZvcm1hdCkgYnkgdHJhbnNmb3JtaW5nIHRoZSBkYXRhIHRvIHdpZGUgZm9ybWF0IGFuZCByZS1wdXJwb3Npbmcgc29tZSB2YWx1ZXMgYXMgcm93IG5hbWVzLiAKVG8gcmVmb3JtYXQgdGhlIGRhdGEgdG8gd2lkZSBmb3JtYXQsIHdlIGNhbiB1c2UgdGhlIGBwaXZvdF93aWRlcigpYCBmdW5jdGlvbiBvZiB0aGUgYHRpZHlyYCBwYWNrYWdlLgoKRm9yIHRoaXMgZnVuY3Rpb24gdGhlcmUgYXJlIHNldmVyYWwgaW1wb3J0YW50IGFyZ3VtZW50czogIAoKMS4gYG5hbWVzX2Zyb21gIC0gdGhpcyBpcyB0aGUgdmFyaWFibGUgd2hlcmUgdGhlIG5hbWVzIG9mIG5ldyBjb2x1bW5zIHdpbGwgY29tZSBmcm9tCjIuIGB2YWx1ZXNfZnJvbWAgLSB0aGlzIGlzIHRoZSB2YXJpYWJsZSB3aGVyZSB0aGUgdmFsdWVzIGZvciB0aGUgbmV3IGNvbHVtbnMgd2lsbCBjb21lIGZyb20KMy4gYG5hbWVzX3ByZWZpeGAgLSBpZiB3ZSB3YW50IHRvIGFkZCBhIHByZWZpeCB0byB0aGUgbmV3IGNvbHVtbnMgd2UgY2FuIGRvIHNvIHVzaW5nIHRoaXMgYXJndW1lbnQKCkluIG91ciBjYXNlLCB3ZSB3YW50IHRvIHNwcmVhZCBvdXQgdGhlIHllYXIgZGF0YSBpbnRvIHR3byBjb2x1bW5zIHRodXMgdGhlIG5hbWVzIHdpbGwgY29tZSBmcm9tIHRoZSBgWWVhcmAgdmFyaWFibGUgYW5kIHRoZSB2YWx1ZXMgd2lsbCBjb21lIGZyb20gdGhlIGBOdW1iZXJgIHZhcmlhYmxlLiAKV2Ugd2FudCB0byBhZGQgdGhlIHdvcmQgYFllYXJgIHRvIHRoZSBuZXcgY29sdW1ucy4gCldlIGFsc28gd2FudCB0aGUgcmVtb3ZlIHRoZSBgc3ViZ3JvdXBgIGFuZCBgZGF0YV90eXBlYCB2YXJpYWJsZXMgYW5kIG9ubHkga2VlcCB0aGUgYERlbW9ncmFwaGljYCwgYFllYXJgLCBhbmQgYE51bWJlcmAgdmFyaWFibGVzLiAKVG8gZG8gc28gd2UgY2FuIHVzZSB0aGUgYHNlbGVjdCgpYCBmdW5jdGlvbi4KCiMjIyMgey5xdWVzdGlvbl9ibG9ja30KPGI+PHU+IFF1ZXN0aW9uIE9wcG9ydHVuaXR5IDwvdT48L2I+CgpVc2luZyB3aGF0IHlvdSBqdXN0IGxlYXJuZWQgYWJvdXQgYHBpdm90X3dpZGVyKClgIGFuZCBgc2VsZWN0KClgIGFuZCB3aXRob3V0IHNjcm9sbGluZyB1cCwgdHJ5IHRvIGNvbWUgdXAgd2l0aCB0aGUgY29kZSB0byBkbyB0aGUgd3JhbmdsaW5nIGZvciB0aGlzIGRhdGEuCgojIyMjCgo8ZGV0YWlscz4gPHN1bW1hcnk+IENsaWNrIGhlcmUgdG8gcmV2ZWFsIHRoZSBjb2RlLiA8L3N1bW1hcnk+CgpgYGB7cn0KY2hpX3NxdWFyZV8xMS4yYSAlPD4lCiAgc2VsZWN0KERlbW9ncmFwaGljLCBZZWFyLCBOdW1iZXIpICU+JQogIHRpZHlyOjpwaXZvdF93aWRlcihuYW1lc19mcm9tID0gWWVhciwKICAgICAgICAgICAgICAgICAgICAgbmFtZXNfcHJlZml4ID0gIlllYXIiLCAKICAgICAgICAgICAgICAgICAgICAgdmFsdWVzX2Zyb20gPSBOdW1iZXIpCmNoaV9zcXVhcmVfMTEuMmEKYGBgCgo8L2RldGFpbHM+CgpBdCB0aGlzIHBvaW50IHdlIGhhdmUgdGhyZWUgY29sdW1ucywgYnV0IHRoZSBmaXJzdCBjb2x1bW4gd2Ugb25seSBuZWVkIHRoZSBgTWFsZWAgYW5kIGBGZW1hbGVgIGxhYmVscyBhbmQgd2FudCB0byB0cmVhdCBpdCBhcyByb3cgbmFtZXMuIApUbyBjb252ZXJ0IGEgY29sdW1uIHRvIHRoZSBuYW1lcyBvZiByb3dzLCB5b3UgY2FuIHVzZSB0aGUgYGNvbHVtbl90b19yb3duYW1lcygpYCBmdW5jdGlvbiBvZiB0aGUgYHRpYmJsZWAgcGFja2FnZSB0byBtYWtlIHRoZSBgRGVtb2dyYXBoaWNgIHZhcmlhYmxlIGxldmVscyBmb3IgdGhlIHJvdyBuYW1lcy4gCk90aGVyd2lzZSwgd2Ugd291bGQgbmVlZCB0byBzZWxlY3QgdGhlIG51bWVyaWMgY29sdW1ucyB0byBwZXJmb3JtIHRoZSBzdGF0cyB0ZXN0LgoKYGBge3J9CmNoaV9zcXVhcmVfMTEuMmEgJTw+JQogIHRpYmJsZTo6Y29sdW1uX3RvX3Jvd25hbWVzKCJEZW1vZ3JhcGhpYyIpCgpjaGlfc3F1YXJlXzExLjJhCmBgYAoKKipOb3RlKio6IGEgY29udGluZ2VuY3kgdGFibGUgd291bGQgdXN1YWxseSBhbHNvIGhhdmUgdG90YWxzIGZvciBhbGwgZ3JvdXBzIGFzIHdlbGwsIGJ1dCB0aGlzIGlzIG5vdCBuZWNlc3NhcnkgZm9yIHRoZSBgc3RhdHM6OmNoaXNxLnRlc3QoKWAgZnVuY3Rpb24uCgpUaGUgY2hpLXNxdWFyZWQgdGVzdCBmb3IgaW5kZXBlbmRlbmNlIGNhbiBiZSBjb25kdWN0ZWQgdXNpbmcgdGhlIGBzdGF0czo6Y2hpc3EudGVzdCgpYCBmdW5jdGlvbi4gCgpgYGB7cn0Kc3RhdHM6OmNoaXNxLnRlc3QoY2hpX3NxdWFyZV8xMS4yYSkKYGBgCgpXZSBzZWUgdGhhdCB0aGUgJHAkLXZhbHVlIGlzIHZlcnkgc21hbGwsIHdoaWNoIHN1Z2dlc3RzIHRoZXJlIGlzIGFuIGFzc29jaWF0aW9uIGJldHdlZW4gYFNleGAgYW5kIHRoZSBudW1iZXIgb2YgbWFqb3IgZGVwcmVzc2l2ZSBlcGlzb2RlcyBhY3Jvc3MgdGltZSAoMjAwNCBjb21wYXJlZCB0byAyMDE4KS4gCgoKIyMjIyB7LnF1ZXN0aW9uX2Jsb2NrfQo8Yj48dT4gUXVlc3Rpb24gT3Bwb3J0dW5pdHkgPC91PjwvYj4KClVzaW5nIHdoYXQgeW91IGxlYXJuZWQgYWJvdXQgdGhlIENoaS1zcXVhcmVkIHRlc3QsIGRlc2NyaWJlIHRoZSByZXN1bHRzIGluIHJlZmVyZW5jZSB0byB0aGUgbnVsbCBoeXBvdGhlc2lzLgoKIyMjIwoKSG93IGFib3V0IGZvciBzZXZlcmUgbWFqb3IgZGVwcmVzc2l2ZSBlcGlzb2Rlcz8KCmBgYHtyfQpjaGlfc3F1YXJlXzExLjNhIDwtIGNvdW50cyAlPiUKICBmaWx0ZXIoZGF0YV90eXBlID09ICJTZXZlcmVfTWFqb3JfRGVwcmVzc2l2ZV9FcGlzb2RlIiwgCiAgICAgICAgIFllYXIgJWluJSBjKDIwMDksIDIwMTgpLCAKICAgICAgICAgRGVtb2dyYXBoaWMgJWluJSBjKCJNYWxlIiwiRmVtYWxlIikpICU+JQogIG11dGF0ZShOdW1iZXIgPSBOdW1iZXIgKiAxMDAwKSAlPiUKICBzZWxlY3QoLWRhdGFfdHlwZSwgLXN1Ymdyb3VwKSAlPiUKICBwaXZvdF93aWRlcihuYW1lc19mcm9tID0gWWVhciwKICAgICAgICAgICAgICBuYW1lc19wcmVmaXggPSAiWWVhciIsIAogICAgICAgICAgICAgIHZhbHVlc19mcm9tID0gTnVtYmVyKSAlPiUKICBjb2x1bW5fdG9fcm93bmFtZXMoIkRlbW9ncmFwaGljIikKCmNoaV9zcXVhcmVfMTEuM2EKYGBgCgpgYGB7cn0KY2hpc3EudGVzdChjaGlfc3F1YXJlXzExLjNhKQpgYGAKClRoZXJlIGFsc28gYXBwZWFycyB0byBiZSBhbiBpbmZsdWVuY2Ugb2Ygc2V4IG9uIHRoZSByYXRlIG9mIHNldmVyZSBtYWpvciBkZXByZXNzaXZlIGVwaXNvZGVzIGFjcm9zcyB0aGUgeWVhcnMuCgoKSG93IGFib3V0IHRyZWF0bWVudD8KCiMjIyMgey5xdWVzdGlvbl9ibG9ja30KPGI+PHU+IFF1ZXN0aW9uIE9wcG9ydHVuaXR5IDwvdT48L2I+CgpUcnkgcGVyZm9ybWluZyB0aGUgc2FtZSB3cmFuZ2xpbmcgYXMgd2UgZGlkIGZvciB0aGUgcGVyY2VudGFnZSBvZiBlYWNoIGRlbW9ncmFwaGljIHRoYXQgcmVwb3J0ZWQgaGF2aW5nIGEgbWFqb3IgZGVwcmVzc2l2ZSBlcGlzb2RlIGZvciB0aGUgZGF0YSBhYm91dCB0cmVhdG1lbnQuCgojIyMjCgo8ZGV0YWlscz4gPHN1bW1hcnk+IENsaWNrIGhlcmUgdG8gcmV2ZWFsIHRoZSBjb2RlLiA8L3N1bW1hcnk+CgpgYGB7cn0KY2hpX3NxdWFyZV8xMS40YSA8LSBjb3VudHMgJT4lCiAgZmlsdGVyKGRhdGFfdHlwZSA9PSAidHJlYXRtZW50IiwgCiAgICAgICAgIFllYXIgJWluJSBjKDIwMDksIDIwMTgpLCAKICAgICAgICAgRGVtb2dyYXBoaWMgJWluJSBjKCJNYWxlIiwiRmVtYWxlIikpICU+JQogIG11dGF0ZShOdW1iZXIgPSBOdW1iZXIgKiAxMDAwKSAlPiUKICBzZWxlY3QoLWRhdGFfdHlwZSwgLXN1Ymdyb3VwKSAlPiUKICBwaXZvdF93aWRlcihuYW1lc19mcm9tID0gWWVhciwKICAgICAgICAgICAgICBuYW1lc19wcmVmaXggPSAiWWVhciIsIAogICAgICAgICAgICAgIHZhbHVlc19mcm9tID0gTnVtYmVyKSAlPiUKICBjb2x1bW5fdG9fcm93bmFtZXMoIkRlbW9ncmFwaGljIikKCmNoaV9zcXVhcmVfMTEuNGEKYGBgCjwvZGV0YWlscz4KCgpgYGB7cn0KY2hpc3EudGVzdChjaGlfc3F1YXJlXzExLjRhKQpgYGAKClRoZXJlIGFsc28gYXBwZWFycyB0byBiZSBhbiBpbmZsdWVuY2Ugb2Ygc2V4IG9uIHRoZSByYXRlIGF0IHdoaWNoIHlvdXRocyByZWNlaXZlZCB0cmVhdG1lbnQgYWNyb3NzIHRoZSB0d28geWVhcnMuCgoKCgojIyAqKlN1bW1hcnkqKgoqKiogCgojIyMgU3VtbWFyeSBQbG90CgpMZXQncyBtYWtlIGEgcGxvdCB0aGF0IHN1bW1hcml6ZXMgb3VyIG1ham9yIGZpbmRpbmdzLgoKV2Ugd2lsbCB1c2UgdGhlIGBnZ2RyYXcoKWAgZnVuY3Rpb24gaW4gdGhlIGBjb3dwbG90YCBwYWNrYWdlLgpUaGlzIGFsbG93cyB5b3UgdG8gYWRkIGxhYmVscyBhbmQgb3RoZXIgcGxvdCBhc3BlY3RzIG9uIHRvcCBvZiBleGlzdGluZyBwbG90cy4gClRodXMgaWYgd2Ugd2FudCB0byBhZGQgYSB0aXRsZSBlbGVtZW50IHRvIG91ciBvdmVyYWxsIHBsb3QgdGhhdCB3ZSB3aWxsIGFkZCB0byBhIGNvbWJpbmVkIHBsb3Qgb2Ygb3VyIGV4aXN0aW5nIHBsb3RzIHdlIGNhbiB1c2UgYGdnZHJhdygpYCB0byBzdGFydCBhbmQgdGhlbiB0aGUgYGRyYXdfbGFiZWwoKWAgZnVuY3Rpb24gdG8gYWRkIHRleHQuIAoKYGBge3J9CnRpdGxlX3Bsb3RzIDwtIAogIGdnZHJhdygpICsgCiAgZHJhd19sYWJlbCgKICAgICJTZWxmLVJlcG9ydGVkIERlcHJlc3Npb24gQW1vbmcgQW1lcmljYW4gWW91dGhzIiwKICAgIGZvbnRmYWNlID0gJ2JvbGQnLAogICAgc2l6ZT0xOCwKICAgIHggPSAwLAogICAgaGp1c3QgPSAtMC4wMQogICkKYGBgClRoZSBgeCA9IDBgIGFyZ3VtZW50IHBsYWNlcyB0aGUgdGl0bGUgb24gdGhlIGZhciBsZWZ0IGVkZ2Ugb2YgdGhlIHBsb3QgYXJlYS4gClRodXMsIGlmIHdlIHVzZSBhIHZhbHVlIG9mIC0wLjAxIGl0IHdpbGwgbW92ZSB0aGUgdGl0bGUganVzdCBhIGJpdCBhd2F5IGZyb20gdGhlIGxlZnQgZWRnZSBvZiB0aGUgcGxvdCBhcmVhLgoKIyMjIyB7LnF1ZXN0aW9uX2Jsb2NrfQo8Yj48dT4gUXVlc3Rpb24gT3Bwb3J0dW5pdHkgPC91PjwvYj4KCldoYXQgaGFwcGVucyBpZiB3ZSBtb2RpZnkgdGhlIGBoanVzdGAgdmFsdWU/CgoKCjxkZXRhaWxzPiA8c3VtbWFyeT4gQ2xpY2sgaGVyZSB0byByZXZlYWwgdGhlIGFuc3dlci4gPC9zdW1tYXJ5PgoKVGhlIGBoanVzdGAgYXJndW1lbnQgbW92ZXMgdGhlIGxhYmVsIGluIHRoZSBob3Jpem9udGFsIGRpcmVjdGlvbi4gCgo8L2RldGFpbHM+IAoKIyMjIwoKV2UgY2FuIGFsc28gbWFrZSBhIHN1YnRpdGxlIGluIHRoZSBzYW1lIHdheS4gSGVyZSwgd2UgY3JlYXRlIGEgc3VidGl0bGUgY2FsbGVkIGBmb3J3YXJkYCwgd2hpY2ggd2Ugd2lsbCB1c2UgbGF0ZXIgb24uIAoKYGBge3J9CmZvcndhcmQgPC0gZ2dkcmF3KCkgKyAKICBkcmF3X2xhYmVsKAogICAgIlRoZSBwZXJjZW50YWdlIG9mIHlvdXRocyAoYWdlIDEyLTE3KSBleHBlcmllbmNpbmcgbWFqb3IgZGVwcmVzc2l2ZSBlcGlzb2RlcyAoTURFKSBoYXNcbmluY3JlYXNlZCBzaW5jZSAyMDExLiBPZiB0aGVzZSB5b3V0aHMsIHRoZSBwZXJjZW50YWdlIHJlY2VpdmluZyB0cmVhdG1lbnQgZm9yIGRlcHJlc3Npb24gaGFzIGFsc29cbiBpbmNyZWFzZWQgYnV0IHJlbWFpbnMgbGltaXRlZCB0byBsZXNzIHRoYW4gNDIlLiIsCiAgICBzaXplID0gMTYsCiAgICB4ID0gMCwKICAgIGhqdXN0ID0gLTAuMDEKICApCmBgYAoKTmV4dCwgd2Ugd2lsbCBtb2RpZnkgc29tZSBvZiBvdXIgZXhpc3RpbmcgcGxvdHMgdXNpbmcgdGhlIGB0aGVtZSgpYCBmdW5jdGlvbiBhcyB3ZSBkaWQgYmVmb3JlIHRvIHJlbW92ZSB0aGUgeC1heGlzIHRpdGxlLCB0byBjaGFuZ2UgdGhlIGNvbG9yIG9mIHRoZSBheGlzIHRleHQgYW5kIHRoZSB0aXRsZSBzaXplIGFuZCBjb2xvciwgYXMgd2VsbCBhcyBjaGFuZ2UgdGhlIHRpdGxlcyBvZiB0aGUgcGxvdHMuIAoKVXNpbmcgb3VyIGBNREVfdG90YWxgIHBsb3Q6IApgYGB7cn0KCk1ERV90b3RhbF9mb3JfbXAgPC0KICBNREVfdG90YWwgKwogIHRoZW1lKHBsb3QudGl0bGUgPSBlbGVtZW50X2JsYW5rKCksCiAgICAgcGxvdC5zdWJ0aXRsZSA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICAgYXhpcy50ZXh0ID0gZWxlbWVudF90ZXh0KGNvbG9yID0gImJsYWNrIikpCmBgYAoKVXNpbmcgb3VyIGBUcmVhdF90b3RhbGAgcGxvdDoKYGBge3J9Cgp0cmVhdF9mb3JfbXAgPC0gCiAgVHJlYXRfdG90YWwgKwogIHRoZW1lKHBsb3QudGl0bGUgPSBlbGVtZW50X2JsYW5rKCksCiAgICAgcGxvdC5zdWJ0aXRsZSA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICAgYXhpcy50ZXh0ID0gZWxlbWVudF90ZXh0KGNvbG9yID0gImJsYWNrIikpCgpgYGAKCgpVc2luZyBvdXIgYE1ERV9hZ2Vfc2V4YCBwbG90OgpgYGB7cn0KTURFX2FnZV9zZXhfZm9yX21wIDwtIAogIE1ERV9hZ2Vfc2V4ICsKICB0aGVtZShwbG90LnRpdGxlPSBlbGVtZW50X3RleHQoc2l6ZSA9IDE0LCBjb2xvciA9ICJibGFjayIpLAogICAgICAgIHBsb3Quc3VidGl0bGUgPSBlbGVtZW50X2JsYW5rKCksCiAgICAgICAgYXhpcy50ZXh0ID0gZWxlbWVudF90ZXh0KGNvbG9yID0gImJsYWNrIikpICsKICBsYWJzKHRpdGxlID0gIk9sZGVyIHlvdXRocyBhbmQgZmVtYWxlcyByZXBvcnQgTURFIGF0IHRoZSBoaWdoZXN0IHJhdGVzXG5hbmQgc2hvdyB0aGUgc3RlZXBlc3QgaW5jcmVhc2UiKSAKYGBgCgpGb3IgdGhpcyBsYXN0IHBsb3QsIHdlIGFsc28gd2FudCB0byBnZXQgdGhlIGxlZ2VuZCBhbmQgc2F2ZSBpdCBhcyBhIHNlcGFyYXRlIG9iamVjdCBzbyB0aGF0IHdlIGNhbiBhZGQgaXQgdG8gb3VyIHBsb3QgZ3JpZCBpbiBhIHdheSB0aGF0IGRvZXMgbm90IHNocmluayB0aGUgc2l6ZSBvZiBvdXIgcGxvdCB0byBhY2NvbW1vZGF0ZSB0aGUgbGVnZW5kLiAKV2UgY2FuIHVzZSB0aGUgYGdldF9sZWdlbmQoKWAgZnVuY3Rpb24gb2YgdGhlIGBjb3dwbG90YCBwYWNrYWdlIHRvIGRvIHRoaXMuCldlIGNhbiBhbHNvIHNwZWNpZnkgaG93IGl0IHNob3VsZCBiZSBqdXN0aWZpZWQgdXNpbmcgYHRoZW1lKGxlZ2VuZC5qdXN0aWZpY2F0aW9uID0pYCB0aGlzIHRha2VzIGEgbnVtYmVyIG9mIG9wdGlvbnMgaW5jbHVkaW5nICJjZW50ZXIiLCAibGVmdCIsIGFuZCAicmlnaHQuCgpIb3dldmVyLCBiZWZvcmVoYW5kLCB3ZSBhbHNvIHdhbnQgdG8gY2hhbmdlIHRoZSB3YXkgdGhlIGxlZ2VuZCBpcyBkaXNwbGF5ZWQuIApXZSBjYW4gdXNlIHRoZSBgZ3VpZGVzKClgIGZ1bmN0aW9uIG9mIHRoZSBgZ2dwbG90MmAgcGFja2FnZSB0byBtb2RpZnkgdGhlIGxlZ2VuZCB0byBzcGVjaWZ5IHRoYXQgd2Ugd2FudCB0aGUgbGVnZW5kIHRvIGJlIGRpc3BsYXllZCBpbiAyIGNvbHVtbnMgbGlrZSBzbyBgZ3VpZGVzKGNvbG9yID0gZ3VpZGVfbGVnZW5kKG5jb2wgPSAyKSlgLiBXZSBuZWVkIHRvIHNwZWNpZnkgdGhhdCB3ZSBhcmUgbW9kaWZ5aW5nIHRoZSBsZWdlbmQgZm9yIGNvbG9yLgoKYGBge3J9Ck1ERV9yYWNlX2Zvcl9tcF9sZWcgPC0gCiAgTURFX3JhY2UgKwogIHRoZW1lKHBsb3QudGl0bGU9IGVsZW1lbnRfdGV4dChzaXplID0gMTQsIGNvbG9yID0gImJsYWNrIiksCiAgICAgICAgcGxvdC5zdWJ0aXRsZSA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICBheGlzLnRleHQgPSBlbGVtZW50X3RleHQoY29sb3IgPSAiYmxhY2siKSwKICAgICAgICBsZWdlbmQucG9zaXRpb24gPSAicmlnaHQiLCAKICAgICAgICBsZWdlbmQudGl0bGUgPSBlbGVtZW50X2JsYW5rKCksCiAgICAgICAgbGVnZW5kLnRleHQgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDE0KSkgKwogIGxhYnModGl0bGUgPSAiQWxsIHJhY2lhbC9ldGhuaWMgZ3JvdXBzIHNob3cgc2ltaWxhclxuaW5jcmVhc2VzIHNpbmNlIDIwMTEiKSsKIGd1aWRlcyhjb2xvciA9IGd1aWRlX2xlZ2VuZChuY29sID0yKSkKCmxlZ2VuZDwtIGdldF9sZWdlbmQoTURFX3JhY2VfZm9yX21wX2xlZyArCiAgICAgICAgICB0aGVtZShsZWdlbmQuanVzdGlmaWNhdGlvbiA9InJpZ2h0IikpCmBgYAoKTm93LCB3ZSB3aWxsIHJlbW92ZSB0aGUgbGVnZW5kIGZvciB0aGlzIHBsb3QuCgojIyMjIHsucXVlc3Rpb25fYmxvY2t9CjxiPjx1PiBRdWVzdGlvbiBPcHBvcnR1bml0eSA8L3U+PC9iPgoKRG8geW91IHJlY2FsbCBob3cgdG8gZG8gdGhpcz8gV2l0aG91dCBzY3JvbGxpbmcgdXAsIHNlZSBpZiB5b3UgY2FuIGZpZ3VyZSBvdXQgaG93LgoKIyMjIwoKPGRldGFpbHM+IDxzdW1tYXJ5PiBDbGljayBoZXJlIHRvIHJldmVhbCB0aGUgY29kZS4gPC9zdW1tYXJ5PgoKYGBge3J9Ck1ERV9yYWNlX2Zvcl9tcCA8LSAKICBNREVfcmFjZV9mb3JfbXBfbGVnICsKICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIpCmBgYAo8L2RldGFpbHM+CgpPSywgbm93IHdlIGFyZSByZWFkeSB0byBzdGFydCBwdXR0aW5nIG91ciBwbG90cyB0b2dldGhlciB1c2luZyB0aGUgYHBsb3RfZ3JpZCgpYCBmdW5jdGlvbiBvZiB0aGUgYGNvd3Bsb3RgIHBhY2thZ2UuIAoKSXQgaXMgaGVscGZ1bCB0byBmaXJzdCBtYWtlIHJvd3MgYnkgY29tYmluaW5nIHRoZSBwbG90cyB0aGF0IHdlIHdhbnQgdG8gYmUgZGlzcGxheWVkIG5leHQgdG8gZWFjaCBvdGhlciBhbmQgdGhlbiBjb21iaW5pbmcgdGhlc2Ugd2l0aCB0aGUgdGl0bGUgYW5kIHN1YnRpdGxlLCBjYWxsZWQgYGZvcndhcmRgLiAKCldlIGNhbiB1c2UgdGhlIGByZWxfd2lkdGhzYCAocmVsYXRpdmUgY29sdW1uIHdpZHRoKSBhcmd1bWVudCB0byBtb2RpZnkgaG93IHdpZGUgZWFjaCBwbG90IGlzIGRpc3BsYXllZC4KRm9yIGV4YW1wbGUsIGluIGEgdHdvLWNvbHVtbiBncmlkLCBgcmVsX3dpZHRocyA9IGMoMiwgMSlgIHdvdWxkIG1ha2UgdGhlIGZpcnN0IGNvbHVtbiB0d2ljZSBhcyB3aWRlIGFzIHRoZSBzZWNvbmQgY29sdW1uLgoKYGBge3J9CnJvd18xIDwtIHBsb3RfZ3JpZChNREVfdG90YWxfZm9yX21wLAogICAgICAgICAgICAgICAgICAgdHJlYXRfZm9yX21wLAogICAgICAgICAgICAgICAgICAgbnJvdyA9IDEpCgpyb3dfMiA8LSBwbG90X2dyaWQoTURFX2FnZV9zZXhfZm9yX21wLAogICAgICAgICAgICAgICAgICAgTURFX3JhY2VfZm9yX21wLAogICAgICAgICAgICAgICAgICAgbnJvdyA9IDEsIAogICAgICAgICAgICAgICAgICAgcmVsX3dpZHRocyA9IGMoMSwgMC42KSkKYGBgCgoKTm93IHdlIGNhbiBjb21iaW5lIGV2ZXJ5dGhpbmcgdG9nZXRoZXIgdXNpbmcgYHBsb3RfZ3JpZCgpYCB5ZXQgYWdhaW4uIApOb3cgdGhhdCB3ZSBoYXZlIHJvd3MsIHdlIGNhbiBjb21iaW5lIGV2ZXJ5dGhpbmcgYXMgYSBzaW5nbGUgY29sdW1uIGFuZCBlYXNpbHkgbW9kaWZ5IHRoZSByZWxhdGl2ZSBoZWlnaHRzIHVzaW5nIHRoZSBgcmVsX2hlaWdodHMoKWAgZnVuY3Rpb24gc28gdGhhdCBvdXIgdGl0bGUsIHN1YnRpdGxlIGFuZCBsZWdlbmQgYXJlIGFsbCByZWxhdGl2ZSBzaG9ydCByZWxhdGl2ZSB0byB0aGUgcGxvdHMuIApXZSB3aWxsIG1ha2UgdGhlIGZpcnN0IHJvdyBoYWxmIHRoZSBoZWlnaHQgb2YgdGhlIHNlY29uZCByb3cuIAoKRmluYWxseSwgd2Ugd2lsbCB1c2UgdGhlIGBwbmcoKWAgZnVuY3Rpb24gb2YgdGhlIGBnckRldmljZXNgIHBhY2thZ2Ugd2hpY2ggaXMgYXV0b21hdGljYWxseSBsb2FkZWQgaW4gUlN0dWRpbyBzZXNzaW9ucyB0byBzYXZlIHRoZSBwbG90LiAKV2Ugd2lsbCB1c2UgdGhlIGBoZXJlKClgIGZ1bmN0aW9uIG9mIHRoZSBgaGVyZWAgcGFja2FnZSwgdG8gc3BlY2lmeSB0aGF0IHdlIHdhbnQgdG8gc2F2ZSBpdCBpbiB0aGUgYGltZ2AgZGlyZWN0b3J5IGFuZCBjYWxsIGl0IGBtYWlucGxvdC5wbmdgLgpXZSBjYW4gYWxzbyB1c2UgdGhpcyBmdW5jdGlvbiB0byBzcGVjaWZ5IHRoZSByZXNvbHV0aW9uIHdpdGggYHJlc2AgYW5kIGluIGRvaW5nIHNvLCB3ZSBuZWVkIHRvIHNhdmUgdGhlIGltYWdlIHdpdGggc2l6ZSBzcGVjaWZpY2F0aW9ucyB0byBtYWtlIGl0IGxhcmdlci4gCgpgYGB7ciwgZXZhbCA9IFRSVUV9CgoKcG5nKGZpbGVuYW1lID0gaGVyZTo6aGVyZSgiaW1nIiwgIm1haW5wbG90X29yaWcucG5nIiksIAogICAgICAgICByZXMgPSAzMDAsIHdpZHRoID0gMTAsIGhlaWdodCA9IDEwLCB1bml0cyA9ICJpbiIpCnBsb3RfZ3JpZCh0aXRsZV9wbG90cywgCiAgICAgICAgICBmb3J3YXJkLAogICAgICAgICAgcm93XzEsCiAgICAgICAgICByb3dfMiwKICAgICAgICAgIGxlZ2VuZCwKICAgICAgICAgIG5jb2wgPSAxLCAKICAgICAgICAgIHJlbF9oZWlnaHRzID0gYygwLjEsMC4yLC44LCAxLCAwLjMpKQpkZXYub2ZmKCkKYGBgCgpUaGUgYGRldi5vZmYoKWAgZnVuY3Rpb24gaXMgbmVjZXNzYXJ5IHRvIGNsb3NlIHRoZSBncmFwaGljcyBkZXZpY2UuIFRoaXMgaXMgZ29vZCBwcmFjdGljZSB0byBhbGxvdyB5b3UgdG8gY3JlYXRlIGFub3RoZXIgcGxvdCBhZ2FpbiBsYXRlci4KCmBgYHtyLGVjaG8gPSBGQUxTRX0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgIm1haW5wbG90X29yaWcucG5nIikpCmBgYAoKCk9LLCB0aGlzIGxvb2tzIHByZXR0eSBnb29kISBCdXQgaXQgaXMgYSBiaXQgYnVzeSwgc28gd2UgYXJlIG5vdyBnb2luZyB0byByZW1vdmUgdGhlIFJhY2UvZXRobmljaXR5IHBsb3Qgc28gYXMgIHRvIHNpbXBsaWZ5IG91ciBwbG90LgoKVGhpcyB0aW1lIHdlIG5lZWQgdG8gcmVjcmVhdGUgb3VyIGBNREVfYWdlX3NleGAgcGxvdCBhZ2FpbiBiZWNhdXNlIHdlIHdhbnQgdG8gc2VwYXJhdGUgb3VyIHBsb3RzIHNvIHRoZXkgbG9vayBtb3JlIHNpbWlsYXIgdG8gdGhlIHRvdGFsIE1ERSBhbmQgdHJlYXRtZW50IHBsb3RzLiBTbyB3ZSB3aWxsIGFjdHVhbGx5IG1ha2UgdHdvIHNlcGFyYXRlIHBsb3RzLiAKCldlIGFsc28gd2FudCB0byByZWNvZGUgdGhlIHRleHQgZm9yIHRoZSBzdHJpcCBhYm92ZSB0aGUgcGxvdCBhbmQgY2hhbmdlIHRoZSBwbG90IHNvIHRoYXQgdGhlcmUgYXJlIG5vIGdyaWQgbGluZXMgbGlrZSB0aGUgZmlyc3Qgcm93IG9mIHBsb3RzLgoKCiMjIyMgey5xdWVzdGlvbl9ibG9ja30KPGI+PHU+IFF1ZXN0aW9uIE9wcG9ydHVuaXR5IDwvdT48L2I+CgpUcnkgdG8gY29tZSB1cCB3aXRoIHRoZSBjb2RlIGZvciB0aGVzZSBwbG90cyBvbiB5b3VyIG93biBiZWZvcmUgeW91IHJldmVhbCBpdC4gV2UgY2FuIHVzZSBvdXIgYG92ZXJ2aWV3X3RoZW1lKClgIGZvciB0aGVzZSBwbG90cyB0byBtYWtlIGFsbCB0aGUgcGxvdHMgbG9vayBzaW1pbGFyLgoKIyMjIwoKPGRldGFpbHM+IDxzdW1tYXJ5PiBDbGljayBoZXJlIHRvIHJldmVhbCB0aGUgY29kZS4gPC9zdW1tYXJ5PgoKYGBge3J9Ck1ERV9zZXggPC1wZXJjZW50cyAlPiUKICBmaWx0ZXIoZGF0YV90eXBlID09ICJNYWpvcl9EZXByZXNzaXZlX0VwaXNvZGUiLCAKICAgICAgICAgIHN1Ymdyb3VwID09ICJTZXgiKSAlPiUKICBtdXRhdGUoc3ViZ3JvdXAgPSByZWNvZGUoc3ViZ3JvdXAsICJTZXgiID0gCiAgICAgICAgICJQZXJjZW50IG9mIGVhY2ggc2V4IHJlcG9ydGluZyBNREUiKSkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IFBlcmNlbnQsIGdyb3VwID0gRGVtb2dyYXBoaWMpKSArCiAgZ2VvbV9yZWN0KHhtaW4gPSAyMDExLCB4bWF4ID0gSW5mLCAgCiAgICAgICAgICAgIHltaW4gPSAtSW5mLCB5bWF4ID0gSW5mLCAgCiAgICAgICAgICAgIGZpbGwgPSAibGlnaHQgZ3JheSIpICsKICBnZW9tX2xpbmUoYWVzKGNvbG9yID0gRGVtb2dyYXBoaWMpLCBzaXplID0gMS41KSArCiAgZmFjZXRfd3JhcCh+c3ViZ3JvdXApKwogIHNjYWxlX3lfY29udGludW91cyhsaW1pdHMgPSBjKDAsMjMpKSsKICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDIwMDQsIDIwMTgsIGJ5PTEpLAogICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBzZXEoMjAwNCwgMjAxOCwgYnk9MSksCiAgICAgICAgICAgICAgICAgICAgIGxpbWl0cyA9IGMoMjAwNCwgMjAxOCkpICsKIG92ZXJ2aWV3X3RoZW1lKCkgKwogc2NhbGVfY29sb3JfbWFudWFsKHZhbHVlcyA9IGMoIiNGRjYxQzkiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIjMDBBNUZGIikpCgoKTURFX3NleDwtIGRpcmVjdC5sYWJlbCgKICBNREVfc2V4LCAKICBsaXN0KGRsLnRyYW5zKHkgPSB5ICswLjM4LCB4ID0geCAtMC4yKSwgCiAgICAgICAiZmFyLmZyb20ub3RoZXJzLmJvcmRlcnMiLCAKICAgICAgIGNleCA9IDEsCiAgICAgICBmb250ZmFjZT1jKCJib2xkIikpCiAgKQogICAgICAgCgoKTURFX2FnZSA8LXBlcmNlbnRzICU+JQogIGZpbHRlcihkYXRhX3R5cGUgPT0gIk1ham9yX0RlcHJlc3NpdmVfRXBpc29kZSIsIAogICAgICAgICAgc3ViZ3JvdXAgPT0gIkFnZSIpICU+JQogIG11dGF0ZShzdWJncm91cCA9IHJlY29kZShzdWJncm91cCwgIkFnZSIgPSAKICAgICAgICAiUGVyY2VudCBvZiBlYWNoIGFnZSBncm91cCByZXBvcnRpbmcgTURFIikpICU+JQogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBQZXJjZW50LCBncm91cCA9IERlbW9ncmFwaGljKSkgKwogIGdlb21fcmVjdCh4bWluID0gMjAxMSwgeG1heCA9IEluZiwgIAogICAgICAgICAgICB5bWluID0gLUluZiwgeW1heCA9IEluZiwgIAogICAgICAgICAgICBmaWxsID0gImxpZ2h0IGdyYXkiKSArCiAgZ2VvbV9saW5lKGFlcyhjb2xvciA9IERlbW9ncmFwaGljKSwgc2l6ZSA9IDEuNSkgKwogIGZhY2V0X3dyYXAofnN1Ymdyb3VwKSsKICBzY2FsZV95X2NvbnRpbnVvdXMobGltaXRzID0gYygwLDIzKSkrCiAgc2NhbGVfeF9jb250aW51b3VzKGJyZWFrcyA9IHNlcSgyMDA0LCAyMDE4LCBieT0xKSwKICAgICAgICAgICAgICAgICAgICAgbGFiZWxzID0gc2VxKDIwMDQsIDIwMTgsIGJ5PTEpLAogICAgICAgICAgICAgICAgICAgICBsaW1pdHMgPSBjKDIwMDQsIDIwMTgpKSArCiAgb3ZlcnZpZXdfdGhlbWUoKSArCiAgc2NhbGVfY29sb3JfbWFudWFsKHZhbHVlcyA9IGMoIiNFRDgxNDEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIjMzlCNjAwIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZGFya29yY2hpZDIiKSkjIzk1OTBGRiMwMEJGQzQKCk1ERV9hZ2U8LSBkaXJlY3QubGFiZWwoCiAgTURFX2FnZSwgCiAgbGlzdChkbC50cmFucyh5ID0geSArIDAuMzgsIHggPSB4IC0wLjIpLCAKICAgICAgICJmYXIuZnJvbS5vdGhlcnMuYm9yZGVycyIsIAogICAgICAgY2V4ID0gMSwgCiAgICAgICBmb250ZmFjZT1jKCJib2xkIiksCiAgICAgICBkbC5tb3ZlKCJBZ2VfMTItMTMiLCB4ID0gMjAxNSwgeSA9IDkpKQogICkKYGBgCgo8L2RldGFpbHM+CgpXZSB3aWxsIGFsc28gbWFrZSBhbm90aGVyIHN1YnRpdGxlIGZvciB0aGUgc2V4IGFuZCByYWNlIHBsb3RzLiBUaGlzIHRpbWUgd2Ugd2lsbCBhZGQgYm9sZCB0ZXh0IHRvIG91ciB0ZXh0IHVzaW5nIHRoZSBiYXNlIGBleHByZXNzaW9uKClgIGZ1bmN0aW9uIGFuZCB0aGUgYmFzZSBgcGFzdGUoKWAgZnVuY3Rpb24gd2hpY2ggYWxsb3dzIHlvdSB0byBjb21iaW5lIGNoYXJhY3RlciBzdHJpbmdzIHRvZ2V0aGVyLiBXZSBjYW4gc3BlY2lmeSB0aGF0IHdlIGRvbid0IHdhbnQgYW55IHNwYWNlcyBvciBjaGFyYWN0ZXIgZm9yIG91ciBzZXBhcmF0b3IuCgpgYGB7cn0KbGFiZWwgPC1leHByZXNzaW9uKHBhc3RlKAogICAgYm9sZCgiT2xkZXIgIiksCiAgICAieW91dGhzIGFuZCAiLAogICAgYm9sZCgiZmVtYWxlcyAiKSwKICAgICJyZXBvcnQgTURFIGF0IHRoZSBoaWdoZXN0IHJhdGUgYW5kIGFsc28gc2hvdyB0aGUgc3RlZXBlc3QgaW5jcmVhc2UuIiksIHNlcD0iIikKCmZvcndhcmQyIDwtIGdnZHJhdygpICsgCiAgZHJhd19sYWJlbChsYWJlbCwKICAgIHNpemUgPSAxNiwKICAgIHggPSAwLAogICAgaGp1c3QgPSAtMC4wMQogICkKYGBgCgoKYGBge3J9Cgpyb3dfMiA8LSBwbG90X2dyaWQoTURFX2FnZSwgTURFX3NleCwKICAgICAgICAgICAgICAgICAgIG5yb3cgPSAxKQoKcG5nKGZpbGVuYW1lID0gaGVyZTo6aGVyZSgiaW1nIiwgIm1haW5wbG90LnBuZyIpLCAKICAgICAgICAgcmVzID0gMzAwLCB3aWR0aCA9IDEwLCBoZWlnaHQgPSAxMCwgdW5pdHMgPSAiaW4iKQpwbG90X2dyaWQodGl0bGVfcGxvdHMsIAogICAgICAgICAgZm9yd2FyZCwKICAgICAgICAgIHJvd18xLAogICAgICAgICAgZm9yd2FyZDIsCiAgICAgICAgICByb3dfMiwKICAgICAgICAgIG5jb2wgPSAxLCAKICAgICAgICAgIHJlbF9oZWlnaHRzID0gYygwLjEsIDAuMiwgMSwgMC4xLCAxKSkKZGV2Lm9mZigpCmBgYAoKCmBgYHtyLGVjaG8gPSBGQUxTRX0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgIm1haW5wbG90LnBuZyIpKQpgYGAKCiMjIyBTeW5vcHNpcwoKSW4gdGhpcyBjYXNlIHN0dWR5IHdlIGV2YWx1YXRlZCBzZWxmLXJlcG9ydGVkIG1lYXN1cmVzIG9mIGRlcHJlc3Npb24gc3ltcHRvbXMgYW1vbmcgeW91dGhzIGFnZSAxMi0xNyBpbiB0aGUgVW5pdGVkIFN0YXRlcywgYXMgd2VsbCBhcyB0aGUgcmF0ZSBvZiB5b3V0aHMgcmVjZWl2aW5nIHRyZWF0bWVudCBmb3IgZGVwcmVzc2lvbi4gCldlIGxlYXJuZWQgaG93IHRvIHNjcmFwZSBkYXRhIGRpcmVjdGx5IGZyb20gdGhlIHdlYiB1c2luZyB0aGUgYHJ2ZXN0YCBwYWNrYWdlIGFuZCB3ZSBsZWFybmVkIGhvdyB0byBwZXJmb3JtIGFuZCBpbnRlcnByZXQgYSBjaGktc3F1YXJlIHRlc3QgdXNpbmcgdGhlIGBjaGlzcS50ZXN0KClgIGZ1bmN0aW9uIG9mIHRoZSBgc3RhdHNgIHBhY2thZ2UuCgpCeSBhbmFseXppbmcgYW5kIHBsb3R0aW5nIG91ciBkYXRhLCBpdCBpcyBjbGVhciB0aGF0IGRlcHJlc3Npb24gcmF0ZXMgYXBwZWFyIHRvIGJlIGluY3JlYXNpbmcsIHBhcnRpY3VsYXJseSBzaW5jZSAyMDExLiAKSG93ZXZlciwgaXQgaXMgcG9zc2libGUgdGhhdCByZXNwb25kZW50cyBoYWQgc2ltaWxhciByYXRlcyBpbiBwcmV2aW91cyB5ZWFycywgYnV0IG5vdyBmZWVsIGxlc3Mgc3RpZ21hIGFib3V0IHJlc3BvbmRpbmcgYWJvdXQgZGVwcmVzc2lvbiBzeW1wdG9tcyB3aGVuIGZpbGxpbmcgb3V0IHRoZSBzdXJ2ZXkuIApUaGUgc3VydmV5IGhhcyBhbHdheXMgYmVlbiBhbm9ueW1vdXMsIGJ1dCBbcmVwb3J0aW5nIGJpYXNdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1NlbGYtcmVwb3J0X3N0dWR5Izp+OnRleHQ9U2VsZiUyRHJlcG9ydCUyMHN0dWRpZXMlMjBhcmUlMjBpbmhlcmVudGx5LGFuc3dlcnMlMjB3aWxsJTIwYmUlMjBtb3JlJTIwcG9zaXRpdmUuKXt0YXJnZXQ9Il9ibGFuayJ9IGNhbiBzb21ldGltZXMgY2F1c2UgaW5kaXZpZHVhbHMgdG8gZXhhZ2dlcmF0ZSBvciBtaW5pbWl6ZSB0aGVpciBzeW1wdG9tcyBiZWNhdXNlIG9mIHdoYXQgdGhleSB0aGluayByZXNlYXJjaGVycyB3YW50IHRoZWlyIHJlc3BvbnNlIHRvIGJlIG9yIG91dCBvZiBzaGFtZSBvciBlbWJhcnJhc3NtZW50LCBhbW9uZyBvdGhlciByZWFzb25zLiAKSG93ZXZlciwgdGhlIGRhdGEgc3VnZ2VzdHMgdGhhdCB5b3V0aHMgbWF5IGJlIGV4cGVyaWVuY2luZyBtb3JlIHN5bXB0b21zIG9mIGRlcHJlc3Npb24gYW5kIHRoYXQgdGhlIHJhdGUgb2YgaW5jcmVhc2UgaXMgcXVpdGUgaGlnaC4gCgpOZWFybHkgYSBxdWFydGVyIG9mIGFsbCBpbmRpdmlkdWFscyB0aGF0IHdlcmUgZmVtYWxlIGFuZCBvZiBhZ2UgMTItMTcgcmVwb3J0ZWQgZXhwZXJpZW5jaW5nIHN5bXB0b21zIG9mIGRlcHJlc3Npb24uIApUaGlzIHdhcnJhbnRzIGZ1cnRoZXIgaW52ZXN0aWdhdGlvbiB0byBzZWUgaWYgdGhpcyBpcyBhIHByb2R1Y3Qgb2YgbW9yZSByZXBvcnRpbmcgb3IgaWYgaW5kZWVkIEFtZXJpY2FuIGZlbWFsZXMgYXJlIHRydWx5IG1vcmUgZGVwcmVzc2VkLiAKRnVydGhlcm1vcmUsIGlmIHRoZXkgYXJlIGluZGVlZCBtb3JlIGRlcHJlc3NlZCwgaW52ZXN0aWdhdGlvbiBhYm91dCB3aHkgeW91bmcgZmVtYWxlcyBhcmUgbW9yZSBkZXByZXNzZWQgaXMgYWxzbyBvZiBjcml0aWNhbCBpbXBvcnRhbmNlLiAKT25lIGltcG9ydGFudCBsaW1pdGF0aW9uIGlzIHRoYXQgdGhlIGRhdGEgZG9lcyBub3QgaW5jbHVkZSBzdWJncm91cCBpbnRlcnNlY3Rpb25zLCBzdWNoIGFzIHJhdGVzIG9mIG1ham9yIGRlcHJlc3NpdmUgZXBpc29kZXMgYW1vbmcgZmVtYWxlcyBvZiB2YXJpb3VzIGV0aG5pYyBiYWNrZ3JvdW5kcy4gCgpDb25zaWRlcmluZyB0aGUgdmVyeSBzdGVlcCBpbmNyZWFzZSBpbiBmZW1hbGVzLCB0aGlzIHdhcnJhbnRzIGZ1cnRoZXIgaW52ZXN0aWdhdGlvbiBhYm91dCB3aGljaCBmZW1hbGVzIGFyZSBwYXJ0aWN1bGFybHkgdnVsbmVyYWJsZSBhbmQgd2h5LiAKCgojIyAqKkhvbWV3b3JrKioKKioqIAoKQXNrIHN0dWRlbnRzIHRvIHNjcmFwZSBUYWJsZXMgMTEuNUEgYW5kIDExLjVCIGZyb20gdGhlIHdlYnNpdGUsIHdoaWNoIGNvbnRhaW4gZGF0YSBhYm91dCB0aGUgcmVjZWlwdCBvZiB0cmVhdG1lbnQgYW1vbmcgeW91dGhzIHdobyByZXBvcnRlZCBoYXZpbmcgYSBzZXZlcmUgZXBpc29kZS4gQXNrIHN0dWRlbnRzIHRvIGNyZWF0ZSBwbG90cyBhbmQgcGVyZm9ybSBDaGktc3F1YXJlIHRlc3RzIHRvIGV2YWx1YXRlIGhvdyBncm91cHMgY29tcGFyZSBvdmVyIHRpbWUuCgoKIyMgKipBZGRpdGlvbmFsIEluZm9ybWF0aW9uKioKKioqCgojIyMgSGVscGZ1bCBMaW5rcwoKW1JTdHVkaW9dKGh0dHBzOi8vcnN0dWRpby5jb20vcHJvZHVjdHMvcnN0dWRpby9mZWF0dXJlcy8pe3RhcmdldD0iX2JsYW5rIn0gIApbQ2hlYXRzaGVldCBvbiBSU3R1aWRvIElERV0oaHR0cHM6Ly9naXRodWIuY29tL3JzdHVkaW8vY2hlYXRzaGVldHMvcmF3L21hc3Rlci9yc3R1ZGlvLWlkZS5wZGYpe3RhcmdldD0iX2JsYW5rIn0gIApbT3RoZXIgUlN0dWRpbyBjaGVhdHNoZWV0c10oaHR0cHM6Ly9yc3R1ZGlvLmNvbS9yZXNvdXJjZXMvY2hlYXRzaGVldHMvKXt0YXJnZXQ9Il9ibGFuayJ9ICAgCltUaWR5dmVyc2VdKGh0dHBzOi8vd3d3LnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICAgCltTZWxlY3Rpb24gYmlhc10oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU2VsZWN0aW9uX2JpYXM/b2xkZm9ybWF0PXRydWUpe3RhcmdldD0iX2JsYW5rIn0gIApbU2FtcGxpbmcgbWV0aG9kc10oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU2FtcGxpbmdfKHN0YXRpc3RpY3MpP29sZGZvcm1hdD10cnVlKXt0YXJnZXQ9Il9ibGFuayJ9ICAgCltTYW1wbGluZyBmcmFtZV0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU2FtcGxpbmdfZnJhbWU/b2xkZm9ybWF0PXRydWUpe3RhcmdldD0iX2JsYW5rIn0gIApbRFNNIDVdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0RTTS01KXt0YXJnZXQ9Il9ibGFuayJ9PC9zdW1tYXJ5PiAgICAKW05hdGlvbmFsIFN1cnZleSBvbiBEcnVnIFVzZSBhbmQgSGVhbHRoIChOU0RVSCldKGh0dHBzOi8vbnNkdWh3ZWIucnRpLm9yZy9yZXNwd2ViL2hvbWVwYWdlLmNmbSl7dGFyZ2V0PSJfYmxhbmsifSAgIApbU3Vic3RhbmNlIEFidXNlIGFuZCBNZW50YWwgSGVhbHRoIFNlcnZpY2VzIEFkbWluaXN0cmF0aW9uIChTQU1IU0EpXShodHRwczovL3d3dy5zYW1oc2EuZ292Lyl7dGFyZ2V0PSJfYmxhbmsifSAgIApbVS5TLiBEZXBhcnRtZW50IG9mIEhlYWx0aCBhbmQgSHVtYW4gU2VydmljZXMgKERISFMpXShodHRwczovL3d3dy5oaHMuZ292Lyl7dGFyZ2V0PSJfYmxhbmsifSAgIApbTlNEVUggU3VydmV5IFJlc3VsdHMgV2Vic2l0ZV0oaHR0cHM6Ly93d3cuc2FtaHNhLmdvdi9kYXRhL3NpdGVzL2RlZmF1bHQvZmlsZXMvY2Joc3EtcmVwb3J0cy9OU0RVSERldGFpbGVkVGFiczIwMThSMi9OU0RVSERldFRhYnNTZWN0MTFwZTIwMTguaHRtKXt0YXJnZXQ9Il9ibGFuayJ9ICh3aGVyZSB3ZSBnb3QgdGhlIGRhdGEgZm9yIHRoaXMgY2FzZSBzdHVkeSkgICAgCltEZXRhaWxzIGFib3V0IHRoZSBTdXJ2ZXldKGh0dHBzOi8vbnNkdWh3ZWIucnRpLm9yZy9yZXNwd2ViL2Fib3V0X25zZHVoLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gIApbUmVwb3J0IGFib3V0IHRoZSAyMDE4IE5TRFVIIFN1cnZleV0oaHR0cHM6Ly93d3cuc2FtaHNhLmdvdi9kYXRhL3NpdGVzL2RlZmF1bHQvZmlsZXMvY2Joc3EtcmVwb3J0cy9OU0RVSERldGFpbGVkVGFiczIwMThSMi9OU0RVSERldGFpbGVkVGFiczIwMTgucGRmKXt0YXJnZXQ9Il9ibGFuayJ9ICAKW1dlYiBzY3JhcGluZ10oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvV2ViX3NjcmFwaW5nP29sZGZvcm1hdD10cnVlKXt0YXJnZXQ9Il9ibGFuayJ9ICAKW1NlbGVjdG9yZ2FkZ2V0IFRvb2xdKGh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9ydmVzdC92aWduZXR0ZXMvc2VsZWN0b3JnYWRnZXQuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSAgClNlZSB0aGlzIFtibG9nIHBvc3RdKGh0dHA6Ly9yZXNlYXJjaC5saWJkLm9yZy9yc3RhdHNjbHViL3Bvc3QvaW50cm9kdWN0aW9uLXRvLXNjcmFwaW5nLWFuZC13cmFuZ2luZy10YWJsZXMtZnJvbS1yZXNlYXJjaC1hcnRpY2xlcy8jLlh3ODc4Wk5LaFFKKXt0YXJnZXQ9Il9ibGFuayJ9LCB0aGlzIFtibG9nIHBvc3RdKGh0dHA6Ly9ibG9nLmNvcnluaXNzZW4uY29tLzIwMTUvMDEvdXNpbmctcnZlc3QtdG8tc2NyYXBlLWh0bWwtdGFibGUuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSwgYW5kIHRoaXMgW3ZpZ25ldHRlXShodHRwczovL3JzdHVkaW8tcHVicy1zdGF0aWMuczMuYW1hem9uYXdzLmNvbS8yNjY0MzBfZjNmZDQ2NjBiMjc0NDc1MWFiMTQ0YWExMzA3NjhhMDYuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSBmb3IgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCB3ZWIgc2NyYXBpbmcgIApbQ1NTIHNlbGVjdG9ycyB0dXRvcmlhbF0oaHR0cDovL2ZsdWtlb3V0LmdpdGh1Yi5pby8jKXt0YXJnZXQ9Il9ibGFuayJ9IChhbmQgdGhlIFthbnN3ZXJzXShodHRwczovL2dpc3QuZ2l0aHViLmNvbS9jaHJpc21hbi9mY2IwYTg4NDU5Y2Q5ODIzOWRiZTZkMmQyMDBiMDJkMSl7dGFyZ2V0PSJfYmxhbmsifSkgICAgIApbUGlwaW5nIGluIFJdKGh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9tYWdyaXR0ci92aWduZXR0ZXMvbWFncml0dHIuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSAgIApbV3JpdGluZyBmdW5jdGlvbnNdKGh0dHBzOi8vcjRkcy5oYWQuY28ubnovZnVuY3Rpb25zLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0KQWxzbyBzZWUgW3RoaXMgY2FzZSBzdHVkeV0oaHR0cHM6Ly9vcGVuY2FzZXN0dWRpZXMuZ2l0aHViLmlvL29jcy1ibG9vbWJlcmctdmFwaW5nLWNhc2Utc3R1ZHkvKXt0YXJnZXQ9Il9ibGFuayJ9ICBmb3IgbW9yZSBpbmZvcm1hdGlvbiBvbiB3cml0aW5nIGZ1bmN0aW9ucy4gICAKW1N0cmluZyBtYW5pcHVsYXRpb24gY2hlYXRzaGVldF0oaHR0cHM6Ly9yc3R1ZGlvLmNvbS9yZXNvdXJjZXMvY2hlYXRzaGVldHMvKXt0YXJnZXQ9Il9ibGFuayJ9ICAKW1RhYmxlIGZvcm1hdHNdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1dpZGVfYW5kX25hcnJvd19kYXRhKXt0YXJnZXQ9Il9ibGFuayJ9CltQZWFyc29uJ3MgY2hpLXNxdWFyZWQgdGVzdF0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUGVhcnNvbiUyN3NfY2hpLXNxdWFyZWRfdGVzdCM6fjp0ZXh0PVBlYXJzb24ncyUyMGNoaSUyRHNxdWFyZWQlMjB0ZXN0JTIwaXMsZGlmZmVycyUyMGZyb20lMjBhJTIwdGhlb3JldGljYWwlMjBkaXN0cmlidXRpb24uKXt0YXJnZXQ9Il9ibGFuayJ9ICAKW2NvbnRpbmdlbmN5IHRhYmxlXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Db250aW5nZW5jeV90YWJsZSl7dGFyZ2V0PSJfYmxhbmsifSAgCltDaGktc3F1YXJlIGRpc3RyaWJ1dGlvbl0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ2hpLXNxdWFyZWRfdGVzdCMvbWVkaWEvRmlsZTpDaGktc3F1YXJlX2Rpc3RyaWJ1dGlvbkNERi1FbmdsaXNoLnBuZyl7dGFyZ2V0PSJfYmxhbmsifSAgCltjaGktc3F1YXJlIGRpc3RyaWJ1dGlvbiBhcHBsZXRdKGh0dHA6Ly9ob21lcGFnZS5kaXZtcy51aW93YS5lZHUvfm1ib2duYXIvYXBwbGV0cy9jaGlzcS5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9ICAKU2VlIGhlcmUgZm9yIGEgbW9yZSB0aG9yb3VnaCBleHBsYW5hdGlvbiBvZiB0aGUgW2NoaS1zcXVhcmUgdGVzdF0oaHR0cHM6Ly93d3cubGluZy51cGVubi5lZHUvfmNsaWdodC9jaGlzcXVhcmVkLmh0bSl7dGFyZ2V0PSJfYmxhbmsifSAgIApbYGdncGxvdDJgIHBhY2thZ2VdKGh0dHA6Ly9nZ3Bsb3QyLnRpZHl2ZXJzZS5vcmcpe3RhcmdldD0iX2JsYW5rIn0gICAgClBsZWFzZSBzZWUgW3RoaXMgY2FzZSBzdHVkeV0oaHR0cHM6Ly9vcGVuY2FzZXN0dWRpZXMuZ2l0aHViLmlvL29jcy1icC1jbzItZW1pc3Npb25zLyl7dGFyZ2V0PSJfYmxhbmsifSAgZm9yIG1vcmUgZGV0YWlscyBvbiB1c2luZyBgZ2dwbG90MmAuIApbZ3JhbW1hciBvZiBncmFwaGljc10oaHR0cDovL3ZpdGEuaGFkLmNvLm56L3BhcGVycy9sYXllcmVkLWdyYW1tYXIuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSAgCltgZ2dwbG90MmAgdGhlbWVzXShodHRwczovL2dncGxvdDIudGlkeXZlcnNlLm9yZy9yZWZlcmVuY2UvZ2d0aGVtZS5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9ICAgCltgZGlyZWN0bGFiZWxzYCBwYWNrYWdlIG1ldGhvZHNdKGh0dHA6Ly9kaXJlY3RsYWJlbHMuci1mb3JnZS5yLXByb2plY3Qub3JnL2RvY3MvaW5kZXguaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSAgCltWaXJpZGlzIHBhbGV0dGUgZm9yIGNvbG9yYmxpbmQgZnJpZW5kbHkgcGxvdHNdKGh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy92aXJpZGlzL3ZpZ25ldHRlcy9pbnRyby10by12aXJpZGlzLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gIApbTW90aXZhdGluZyBhcnRpY2xlIGZvciB0aGlzIGNhc2Ugc3R1ZHkgYWJvdXQgZGVwcmVzc2lvbiByYXRlc10oaHR0cHM6Ly9wdWJtZWQubmNiaS5ubG0ubmloLmdvdi8zMDg2OTkyNy8pe3RhcmdldD0iX2JsYW5rIn0gKEFjY2VzcyBpcyBwb3NzaWJsZSBmb3IgdGhvc2UgYXQgSG9wa2lucyBieSB1c2luZyB0aGVpciBlbWFpbCBhZGRyZXNzKSAgICAKCltNb3RpdmF0aW5nIGFydGljbGUgYWJvdXQgdGhlIHJhdGUgb2YgeW91dGhzIHNlZWtpbmcgbWVudGFsIGhlYWx0aCBzZXJ2aWNlc10oaHR0cHM6Ly9wdWJtZWQubmNiaS5ubG0ubmloLmdvdi8yNDI4NTM4Mi8pe3RhcmdldD0iX2JsYW5rIn0gICAgCgpbQ3Jvc3MtY3VsdHVyYWwgcmV2aWV3IGFydGljbGUgYWJvdXQgcG9zc2libGUgY2F1c2VzIGZvciBpbmNyZWFzZWQgZGVwcmVzc2lvbl0oaHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9wbWMvYXJ0aWNsZXMvUE1DMzMzMDE2MS8pe3RhcmdldD0iX2JsYW5rIn0KCltSZXZpZXcgYXJ0aWNsZSBhYm91dCBzb2NpYWwgbWVkaWEgYW5kIGRlcHJlc3Npb25dKGh0dHBzOi8vY2hpbGRtaW5kLm9yZy9hcnRpY2xlL2lzLXNvY2lhbC1tZWRpYS11c2UtY2F1c2luZy1kZXByZXNzaW9uLyl7dGFyZ2V0PSJfYmxhbmsifQoKCjx1PioqUGFja2FnZXMgdXNlZCBpbiB0aGlzIGNhc2Ugc3R1ZHk6KiogPC91PgoKUGFja2FnZSAgIHwgVXNlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAotLS0tLS0tLS0tIHwtLS0tLS0tLS0tLS0tCltoZXJlXShodHRwczovL2dpdGh1Yi5jb20vamVubnliYy9oZXJlX2hlcmUpe3RhcmdldD0iX2JsYW5rIn0gICAgICAgfCB0byBlYXNpbHkgbG9hZCBhbmQgc2F2ZSBkYXRhICAKW3J2ZXN0XShodHRwczovL2dpdGh1Yi5jb20vdGlkeXZlcnNlL3J2ZXN0KXt0YXJnZXQ9Il9ibGFuayJ9ICAgICAgfCB0byBzY3JhcGUgd2ViIHBhZ2VzICAKW2RwbHlyXShodHRwczovL2RwbHlyLnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICAgfCB0byBzY3JhcGUgd2ViIHBhZ2VzICAKW21hZ3JpdHRyXShodHRwczovL21hZ3JpdHRyLnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICAgfCB0byBzY3JhcGUgd2ViIHBhZ2VzICAKW3N0cmluZ3JdKGh0dHBzOi8vc3RyaW5nci50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgICAgIHwgdG8gbWFuaXB1bGF0ZSBzdHJpbmdzICAKW3RpZHlyXShodHRwczovL3RpZHlyLnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICAgfCB0byBjaGFuZ2UgdGhlIHNoYXBlIG9yIGZvcm1hdCBvZiB0aWJibGVzIHRvIHdpZGUgYW5kIGxvbmcgIApbdGliYmxlXShodHRwczovL3RpYmJsZS50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgICAgIHwgdG8gY3JlYXRlIHRpYmJsZXMgYW5kIGNvbnZlcnQgYSBjb2x1bW4gdG8gcm93IG5hbWVzICAKW2dncGxvdDJdKGh0dHBzOi8vZ2dwbG90Mi50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgICAgIHwgdG8gY3JlYXRlIHBsb3RzICAKW2RpcmVjdGxhYmVsc10oaHR0cDovL2RpcmVjdGxhYmVscy5yLWZvcmdlLnItcHJvamVjdC5vcmcvZG9jcy9pbmRleC5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICAgfCB0byBhZGQgbGFiZWxzIGRpcmVjdGx5IHRvIGxpbmVzIGluIHBsb3RzICAKW2ZvcmNhdHNdKGh0dHBzOi8vZm9yY2F0cy50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgICAgIHwgdG8gcmVvcmRlciBmYWN0b3IgZm9yIHBsb3QgIApbY293cGxvdF0oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL2Nvd3Bsb3QvdmlnbmV0dGVzL2ludHJvZHVjdGlvbi5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICAgfCB0byBjb21iaW5lIHBsb3RzIHRvZ2V0aGVyICAKCiMjIyMgey5lbXBoYXNpc19ibG9ja30KSWYgeW91IGFyZSBpbiBjcmlzaXMgYW5kIG5lZWQgaGVscCwgY2FsbCB0aGlzIHRvbGwtZnJlZSBudW1iZXIgZm9yIHRoZSAqKk5hdGlvbmFsIFN1aWNpZGUgUHJldmVudGlvbiBMaWZlbGluZSAoTlNQTCkqKiwgYXZhaWxhYmxlIDI0IGhvdXJzIGEgZGF5LCBldmVyeSBkYXk6ICoqMS04MDAtMjczLVRBTEsgKDgyNTUpKiouIFRoZSBzZXJ2aWNlIGlzIGF2YWlsYWJsZSB0byBldmVyeW9uZS4gVGhlIGRlYWYgYW5kIGhhcmQgb2YgaGVhcmluZyBjYW4gY29udGFjdCB0aGUgTGlmZWxpbmUgdmlhIFRUWSBhdCAxLTgwMC03OTktNDg4OS4gQWxsIGNhbGxzIGFyZSBjb25maWRlbnRpYWwuIFlvdSBjYW4gYWxzbyB2aXNpdCB0aGUgTGlmZWxpbmXigJlzIHdlYnNpdGUgYXQgW3d3dy5zdWljaWRlcHJldmVudGlvbmxpZmVsaW5lLm9yZ10od3d3LnN1aWNpZGVwcmV2ZW50aW9ubGlmZWxpbmUub3JnKXt0YXJnZXQ9Il9ibGFuayJ9LgoKVGhlICoqQ3Jpc2lzIFRleHQgTGluZSoqIGlzIGFub3RoZXIgZnJlZSwgY29uZmlkZW50aWFsIHJlc291cmNlIGF2YWlsYWJsZSAyNCBob3VycyBhIGRheSwgc2V2ZW4gZGF5cyBhIHdlZWsuIFRleHQg4oCcSE9NReKAnSB0byAqKjc0MTc0MSoqIGFuZCBhIHRyYWluZWQgY3Jpc2lzIGNvdW5zZWxvciB3aWxsIHJlc3BvbmQgdG8geW91IHdpdGggc3VwcG9ydCBhbmQgaW5mb3JtYXRpb24gb3ZlciB0ZXh0IG1lc3NhZ2UuIFZpc2l0IFt3d3cuY3Jpc2lzdGV4dGxpbmUub3JnXSh3d3cuY3Jpc2lzdGV4dGxpbmUub3JnKXt0YXJnZXQ9Il9ibGFuayJ9LgoKIyMjIwoKQWxzbyBzZWUgW2hlcmVdKGh0dHBzOi8vd3d3Lm1oYW5hdGlvbmFsLm9yZy9kZXByZXNzaW9uLXRlZW5zLTApe3RhcmdldD0iX2JsYW5rIn0gZm9yIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgaG93IHRvIHJlY29nbml6ZSBhbmQgaGVscCB5b3V0aHMgZXhwZXJpZW5jaW5nIHN5bXB0b21zIG9mIGRlcHJlc3Npb24KCgojIyMgQWNrbm93bGVkZ2VtZW50cwoKV2Ugd291bGQgbGlrZSB0byBhY2tub3dsZWRnZSBbVGFtYXIgTWVuZGVsc29uXShodHRwczovL3d3dy5qaHNwaC5lZHUvZmFjdWx0eS9kaXJlY3RvcnkvcHJvZmlsZS8xNzcwL3RhbWFyLW1lbmRlbHNvbil7dGFyZ2V0PSJfYmxhbmsifSBmb3IgYXNzaXN0aW5nIGluIGZyYW1pbmcgdGhlIG1ham9yIGRpcmVjdGlvbiBvZiB0aGUgY2FzZSBzdHVkeS4KCldlIHdvdWxkIGFsc28gbGlrZSB0byBhY2tub3dsZWRnZSB0aGUgW0Jsb29tYmVyZyBBbWVyaWNhbiBIZWFsdGggSW5pdGlhdGl2ZV0oaHR0cHM6Ly9hbWVyaWNhbmhlYWx0aC5qaHUuZWR1Lyl7dGFyZ2V0PSJfYmxhbmsifSBmb3IgZnVuZGluZyB0aGlzIHdvcmsuIAoKCgoK</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("index.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
